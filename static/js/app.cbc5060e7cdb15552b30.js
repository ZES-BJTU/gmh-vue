webpackJsonp([1],{"+pwI":function(e,t){},"/5+l":function(e,t){},"/I2m":function(e,t){},"/b+I":function(e,t){},"1///":function(e,t){},"2tp7":function(e,t){},"486q":function(e,t){},"4qeF":function(e,t){},"4tqP":function(e,t){},"54aj":function(e,t){},"5uRl":function(e,t){},"6HUH":function(e,t){},"6I//":function(e,t){},"7dkV":function(e,t){},"7hZr":function(e,t){},"8iex":function(e,t){},"8u5E":function(e,t){},"9WUa":function(e,t){},"9zyV":function(e,t){},AJkg:function(e,t){},AL5c:function(e,t){},BD32:function(e,t){},CYIG:function(e,t){},CpQk:function(e,t){},D6gq:function(e,t){},DIhC:function(e,t){},DM0O:function(e,t){},DXYT:function(e,t){},Fqnv:function(e,t){},HGPJ:function(e,t){},HhC7:function(e,t){},ITDR:function(e,t){},KDYW:function(e,t){},MLt7:function(e,t){},Mq6A:function(e,t){},NHnr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={};o.d(n,"test1",function(){return Tr}),o.d(n,"test2",function(){return Ir});var r=o("VCXJ"),a=o("9rMa"),i=o("mwE6"),s=o.n(i),l=(o("cU5d"),{render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]});var c=o("X4nt")({name:"App"},l,!1,function(e){o("dy3f")},null,null).exports,u=o("zO6J"),m=o("rVsN"),d=o.n(m),p=o("2sCs"),f=o.n(p),h=f.a.CancelToken.source(),g=f.a.create({baseURL:"http://localhost:8080",timeout:5e3,responseType:"json",cancelToken:h.token,withCredentials:!0,headers:{"Content-Type":"application/json"}});g.interceptors.request.use(function(e){return e.url.match("login")?e:(sessionStorage.getItem("token")?e.headers.common["x-token"]=sessionStorage.getItem("token"):(Object(i.Message)({showClose:!0,message:"未登录,请先登录！",type:"error"}),h.cancel("未登录")),e)},function(e){return Object(i.Message)({showClose:!0,message:e,type:"error"}),d.a.reject(e.message)}),g.interceptors.response.use(function(e){switch(e.status){case 201:case 204:break;default:if(0!=e.data.code)return Object(i.Message)({showClose:!0,message:e.data.message,type:"error"}),20001===e.data.code&&setTimeout(function(){sessionStorage.removeItem("role"),sessionStorage.removeItem("account"),sessionStorage.removeItem("name"),sessionStorage.removeItem("token"),mr.push({path:"/signin"})},1e3),d.a.reject(e.data.message)}return e},function(e){e.message.match("timeout")&&Object(i.Message)({showClose:!0,message:"网络不好，请稍后再试",type:"error"}),"未登录"===e.message&&(mr.push({path:"/signin"}),console.log("未登录"));var t=e.message;return d.a.reject(t)});var v={post:function(e,t){return new d.a(function(o,n){g.post(e,t).then(function(e){o(e.data)}).catch(function(e){n(e)})})},get:function(e,t){return new d.a(function(o,n){g.get(e,{params:t}).then(function(e){o(e.data)}).catch(function(e){n(e)})})},put:function(e,t){return new d.a(function(o,n){g.put(e,t).then(function(e){o(e.data)}).catch(function(e){n(e)})})},patch:function(e,t){return new d.a(function(o,n){g.patch(e,t).then(function(e){o(e.data)}).catch(function(e){n(e)})})},del:function(e,t){return new d.a(function(o,n){g.delete(e,t).then(function(e){o(e.data)}).catch(function(e){n(e)})})}},y={name:"Signin",data:function(){return{signinForm:{account:"",password:""},rules:{account:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],password:[{required:!0,message:"密码不能为空",trigger:"blur"}]},loading:!1}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,v.post("/users/login",{account:t.signinForm.account,password:t.signinForm.password}).then(function(e){if(t.loading=!1,0===e.code){var o=e.data;t.setAccountSession(o.role,o.account,o.name+"-"+o.storeName,o.token),"管理员"===o.role?t.$router.push({path:"/store"}):"店长"===o.role?t.$router.push({path:"/reception"}):"前台"===o.role?t.$router.push({path:"/appointment"}):"操作员"===o.role&&t.$router.push({path:"/Schedule"})}}).catch(function(e){t.loading=!1})})}}},b={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"signin"},[n("el-container",[n("el-main",{staticClass:"main-container"},[n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-col",{attrs:{xs:24,sm:8,md:6,lg:5,xl:3}},[n("div",{staticClass:"signin-logo"},[n("img",{attrs:{src:o("lN1t")}})]),e._v(" "),n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"signinForm",attrs:{"label-width":"0px",model:e.signinForm,rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.onSubmit("signinForm")}}},[n("el-form-item",{attrs:{prop:"account"}},[n("el-input",{staticClass:"signin-input",attrs:{placeholder:"EMAIL",autofocus:!0},model:{value:e.signinForm.account,callback:function(t){e.$set(e.signinForm,"account","string"==typeof t?t.trim():t)},expression:"signinForm.account"}})],1),e._v(" "),n("el-form-item",{attrs:{prop:"password"}},[n("el-input",{staticClass:"signin-input",attrs:{type:"password",placeholder:"PASSWORD"},model:{value:e.signinForm.password,callback:function(t){e.$set(e.signinForm,"password","string"==typeof t?t.trim():t)},expression:"signinForm.password"}})],1),e._v(" "),n("el-row",{attrs:{type:"flex",justify:"center"}},[n("el-button",{staticClass:"signin-btn",on:{click:function(t){e.onSubmit("signinForm")}}},[e._v("GO")])],1)],1),e._v(" "),n("el-row",{attrs:{type:"flex",justify:"center"}},[n("div",{staticClass:"signin-link"},[e._v("\n              忘记密码了？点此\n              "),n("router-link",{staticClass:"forget-pwd ",attrs:{to:"/resetpwd"}},[e._v("重置密码")])],1)])],1)],1)],1),e._v(" "),n("el-footer",{staticClass:"footer"},[n("div",[e._v("管理系统版权归北京光美焕科技有限责任公司所有")]),e._v(" "),n("div",[n("a",{attrs:{target:"_blank",href:"http://www.brandnew-gmh.com"}},[e._v("www.brandnew-gmh.com")])])])],1)],1)},staticRenderFns:[]};var C=o("X4nt")(y,b,!1,function(e){o("hz6S")},"data-v-43ec4021",null).exports,_=o("HzJ8"),k=o.n(_),w={name:"HomeHeader",data:function(){return{}},computed:{name:function(){return this.getNameSession()}},methods:{signout:function(){var e=this;v.del("/users/logout").then(function(t){e.clearAccountSession(),e.$message.success("退出成功"),e.$router.push({path:"/signin"})}).catch(function(e){console.log(e)})}}},P={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"HomeHeader"},[n("el-menu",{staticClass:"el-menu-demo",attrs:{mode:"horizontal"}},[n("el-menu-item",{attrs:{index:"1"}},[n("img",{staticClass:"header-logo",attrs:{src:o("lN1t"),alt:""}}),e._v(" "),n("router-link",{attrs:{to:"/"}},[e._v("光美焕")])],1),e._v(" "),n("el-submenu",{staticClass:"account-item",attrs:{index:"2"}},[n("template",{slot:"title"},[e._v(e._s(e.name))]),e._v(" "),n("router-link",{attrs:{to:"/modpwd"}},[n("el-menu-item",{attrs:{index:"2-1"}},[e._v("\n                  修改密码\n                ")])],1),e._v(" "),n("el-menu-item",{attrs:{index:"2-3"},on:{click:e.signout}},[e._v("退出登录")])],2)],1)],1)},staticRenderFns:[]};var F=o("X4nt")(w,P,!1,function(e){o("XVYw")},"data-v-e8147260",null).exports,S={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"SideMenu"},[o("el-aside",{staticClass:"home-aside",attrs:{width:"200px"}},[o("el-row",[o("el-col",{attrs:{span:24}},[o("el-menu",{attrs:{"default-active":e.activeMenu,"unique-opened":!0}},["管理员"===e.role?o("router-link",{attrs:{to:"/store"}},[o("el-menu-item",{attrs:{index:"1"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("店铺")])])],1):e._e(),e._v(" "),"管理员"===e.role?o("router-link",{attrs:{to:"/principal"}},[o("el-menu-item",{attrs:{index:"2"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("店铺负责人")])])],1):e._e(),e._v(" "),"店长"===e.role?o("router-link",{attrs:{to:"/reception"}},[o("el-menu-item",{attrs:{index:"4"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("前台")])])],1):e._e(),e._v(" "),"店长"===e.role?o("router-link",{attrs:{to:"/operator"}},[o("el-menu-item",{attrs:{index:"5"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("操作员")])])],1):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("router-link",{attrs:{to:"/appointment"}},[o("el-menu-item",{attrs:{index:"6"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("预约")])])],1):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("el-submenu",{attrs:{index:"7"}},[o("template",{slot:"title"},[o("span",[e._v("消费记录")])]),e._v(" "),o("router-link",{attrs:{to:"/consume-record-card"}},[o("el-menu-item",{attrs:{index:"7-1"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("办卡消费记录")])])],1),e._v(" "),o("router-link",{attrs:{to:"/consume-record-product"}},[o("el-menu-item",{attrs:{index:"7-2"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("买产品消费记录")])])],1),e._v(" "),o("router-link",{attrs:{to:"/consume-record-project"}},[o("el-menu-item",{attrs:{index:"7-3"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("做项目消费记录")])])],1),e._v(" "),o("router-link",{attrs:{to:"/consume-record-activity"}},[o("el-menu-item",{attrs:{index:"7-4"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("参加活动消费记录")])])],1)],2):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("el-submenu",{attrs:{index:"8"}},[o("template",{slot:"title"},[o("span",[e._v("客户")])]),e._v(" "),o("router-link",{attrs:{to:"/customer"}},[o("el-menu-item",{attrs:{index:"8-1"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("客户")])])],1),e._v(" "),o("router-link",{attrs:{to:"/customer-card"}},[o("el-menu-item",{attrs:{index:"8-2"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("客户会员卡")])])],1),e._v(" "),o("router-link",{attrs:{to:"/customer-activity"}},[o("el-menu-item",{attrs:{index:"8-3"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("客户活动")])])],1),e._v(" "),o("router-link",{attrs:{to:"/customer-card-change-record"}},[o("el-menu-item",{attrs:{index:"8-4"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("客户会员卡信息变动")])])],1)],2):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("el-submenu",{attrs:{index:"9"}},[o("template",{slot:"title"},[o("span",[e._v("库存")])]),e._v(" "),o("router-link",{attrs:{to:"/stock-type"}},[o("el-menu-item",{attrs:{index:"9-1"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("库存分类管理")])])],1),e._v(" "),o("router-link",{attrs:{to:"/stock"}},[o("el-menu-item",{attrs:{index:"9-2"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("库存管理")])])],1),e._v(" "),o("router-link",{attrs:{to:"/stock-amount"}},[o("el-menu-item",{attrs:{index:"9-3"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("本店库存")])])],1)],2):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("el-submenu",{attrs:{index:"10"}},[o("template",{slot:"title"},[o("span",[e._v("美容项目")])]),e._v(" "),o("router-link",{attrs:{to:"/project-type"}},[o("el-menu-item",{attrs:{index:"10-1"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("美容项目分类管理")])])],1),e._v(" "),o("router-link",{attrs:{to:"/project"}},[o("el-menu-item",{attrs:{index:"10-2"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("美容项目管理")])])],1)],2):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("router-link",{attrs:{to:"/member-card"}},[o("el-menu-item",{attrs:{index:"11"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("会员卡")])])],1):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("el-submenu",{attrs:{index:"12"}},[o("template",{slot:"title"},[o("span",[e._v("产品")])]),e._v(" "),o("router-link",{attrs:{to:"/product-type"}},[o("el-menu-item",{attrs:{index:"12-1"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("产品分类管理")])])],1),e._v(" "),o("router-link",{attrs:{to:"/product"}},[o("el-menu-item",{attrs:{index:"12-2"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("产品管理")])])],1),e._v(" "),o("router-link",{attrs:{to:"/product-amount"}},[o("el-menu-item",{attrs:{index:"12-3"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("本店产品")])])],1)],2):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("router-link",{attrs:{to:"/activity"}},[o("el-menu-item",{attrs:{index:"13"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("活动")])])],1):e._e(),e._v(" "),"店长"===e.role||"前台"===e.role?o("router-link",{attrs:{to:"/employee"}},[o("el-menu-item",{attrs:{index:"14"}},[o("span",{attrs:{slot:"title"},slot:"title"},[e._v("员工")])])],1):e._e()],1)],1)],1)],1)],1)},staticRenderFns:[]};var $={name:"Home",data:function(){return{activeIndex:"1",dialogVisible:!1,dialogData:[]}},computed:{role:function(){return this.getRoleSession()}},methods:{handleBeginTime:function(e,t){var o="",n=!0,r=!1,a=void 0;try{for(var i,s=k()(e.appointmentProjects);!(n=(i=s.next()).done);n=!0){var l=i.value;o+=this.toDatetimeMin(l.beginTime)}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o},handleEndTime:function(e,t){var o="",n=!0,r=!1,a=void 0;try{for(var i,s=k()(e.appointmentProjects);!(n=(i=s.next()).done);n=!0){var l=i.value;o+=this.toDatetimeMin(l.endTime)}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o},onClose:function(){this.dialogVisible=!1,this.dialogData=[]}},beforeMount:function(){var e=this;if("前台"===this.getRoleSession()){var t=null;"WebSocket"in window?(console.log("客户端支持websocket"),t=new WebSocket("ws://localhost:8080/appointment/remind/"+this.getTokenSession())):this.$message.error("当前浏览器不支持websocket"),t.onopen=function(){console.log("建立连接成功")},t.onclose=function(){console.log("释放连接成功")},t.onerror=function(){console.log("释放连接失败")},t.onmessage=function(t){e.dialogData=[],e.dialogVisible=!0;var o=JSON.parse(t.data).data,n=!0,r=!1,a=void 0;try{for(var i,s=k()(o);!(n=(i=s.next()).done);n=!0){var l=i.value;e.dialogData.push({customerName:l.appointmentPo.customerName,customerMobile:l.appointmentPo.customerMobile,customerGender:1===l.appointmentPo.customerGender?"男":"女",isLine:1===l.appointmentPo.isLine?"是":"否",remark:l.appointmentPo.remarks?l.appointmentPo.remarks:"暂无备注",appointmentProjects:l.appointmentProjects})}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}}}},components:{HomeHeader:F,SideMenu:o("X4nt")({name:"SideMenu",data:function(){return{}},computed:{role:function(){return this.getRoleSession()},activeMenu:function(){var e=this.$route.fullPath;return e.match("store")?"1":e.match("principal")?"2":e.match("chart")?"3":e.match("reception")?"4":e.match("operator")?"5":e.match("appointment")?"6":e.match("consume-record-change")?"7-5":e.match("consume-record-card")?"7-1":e.match("consume-record-product")?"7-2":e.match("consume-record-project")?"7-3":e.match("consume-record-activity")?"7-4":e.match("customer-card-change")?"8-4":e.match("customer-activity")?"8-3":e.match("customer-card")?"8-2":e.match("customer")?"8-1":e.match("stock-type")?"9-1":e.match("stock-amount")?"9-3":e.match("stock")?"9-2":e.match("project-type")?"10-1":e.match("project")?"10-2":e.match("member-card")?"11":e.match("product-type")?"12-1":e.match("product-amount")?"12-3":e.match("product")?"12-2":e.match("activity")?"13":e.match("employee")?"14":e.match("employee-grade")?"15":void 0}}},S,!1,function(e){o("vsEv")},"data-v-07272e90",null).exports}},x={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"home"},[o("el-container",[o("el-header",[o("home-header")],1),e._v(" "),o("el-container",{staticClass:"home-container"},[o("side-menu"),e._v(" "),o("el-container",[o("el-main",[o("router-view"),e._v(" "),o("el-dialog",{attrs:{title:"预约提醒",visible:e.dialogVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"70%"},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dialogData,size:"medium"}},[o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerMobile",label:"手机",width:"120px;"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerGender",label:"性别",width:"50px;"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isLine",label:"点排",width:"50px;"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),o("el-table-column",{attrs:{prop:"projects",label:"项目"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.appointmentProjects,function(t){return o("div",[e._v("\n                      "+e._s(t.projectName)+"\n                    ")])})}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"employees",label:"员工"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.appointmentProjects,function(t){return o("div",[e._v("\n                      "+e._s(t.employeeName)+"\n                    ")])})}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"beginTime",label:"开始时间",width:"145px;",formatter:e.handleBeginTime}}),e._v(" "),o("el-table-column",{attrs:{prop:"endTime",label:"结束时间",width:"145px;",formatter:e.handleEndTime}})],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onClose("")}}},[e._v("确 定")])],1)],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var j=o("X4nt")($,x,!1,function(e){o("sFlp")},"data-v-2f92bc28",null).exports,A={name:"ResetPWD",data:function(){return{resetPWDForm:{originalPassword:"",newPassword:""},rules:{originalPassword:[{required:!0,message:"旧密码不能为空",trigger:"blur"}],newPassword:[{required:!0,message:"新密码不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addCustomer",{name:t.newCustomerForm.name,gender:t.newCustomerForm.gender,mobile:t.newCustomerForm.mobile,birthday:t.toTimeStamp(t.newCustomerForm.birthday),source:t.newCustomerForm.source,remark:t.newCustomerForm.remark}).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/customer"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},T={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ResetPWD"},[o("el-row",{staticClass:"page-title-row"},[o("span",{staticClass:"page-title"},[e._v("修改密码")])]),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"resetPWDForm",staticClass:"new-form",attrs:{model:e.resetPWDForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("resetPWDForm")}}},[o("el-form-item",{attrs:{label:"旧密码",prop:"originalPassword"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.resetPWDForm.originalPassword,callback:function(t){e.$set(e.resetPWDForm,"originalPassword","string"==typeof t?t.trim():t)},expression:"resetPWDForm.originalPassword"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[o("el-input",{model:{value:e.resetPWDForm.newPassword,callback:function(t){e.$set(e.resetPWDForm,"newPassword","string"==typeof t?t.trim():t)},expression:"resetPWDForm.newPassword"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("resetPWDForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var I=o("X4nt")(A,T,!1,function(e){o("4qeF")},"data-v-65e2adc3",null).exports,M={name:"Store",data:function(){return{storeSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.store.pageNum},pageSize:function(){return this.$store.state.store.pageSize},totalCount:function(){return this.$store.state.store.totalCount},totalPages:function(){return this.$store.state.store.totalPages},tableData:function(){return this.$store.state.store.stores}},methods:{searchStore:function(e){var t=this;this.loading=!0,"search"===e&&(this.storeSearch.oldContent=this.storeSearch.content),this.storeSearch.type=e,this.$store.dispatch("loadStore",this.storeSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.storeSearch.pageNum=e,this.searchStore("page")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){this.$router.push({path:"/store/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delStore",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchStore("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchStore("search")}},N={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Store"},[o("el-form",{ref:"storeSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.storeSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchStore("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.storeSearch.content,callback:function(t){e.$set(e.storeSearch,"content","string"==typeof t?t.trim():t)},expression:"storeSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchStore("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/store/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"address",label:"地址"}}),e._v(" "),o("el-table-column",{attrs:{prop:"phone",label:"电话"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var R=o("X4nt")(M,N,!1,function(e){o("SRnk")},"data-v-24fb892c",null).exports,D={name:"StoreNew",data:function(){return{newStoreForm:{name:"",address:"",phone:"",remark:""},rules:{name:[{required:!0,message:"店铺名称不能为空",trigger:"blur"}],address:[{required:!0,message:"店铺地址不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addStore",t.newStoreForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/store"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},z={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StoreNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/store"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建店铺")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newStoreForm",staticClass:"new-form",attrs:{model:e.newStoreForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newStoreForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newStoreForm.name,callback:function(t){e.$set(e.newStoreForm,"name","string"==typeof t?t.trim():t)},expression:"newStoreForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"地址",prop:"address"}},[o("el-input",{model:{value:e.newStoreForm.address,callback:function(t){e.$set(e.newStoreForm,"address","string"==typeof t?t.trim():t)},expression:"newStoreForm.address"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"电话"}},[o("el-input",{model:{value:e.newStoreForm.phone,callback:function(t){e.$set(e.newStoreForm,"phone","string"==typeof t?t.trim():t)},expression:"newStoreForm.phone"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newStoreForm.remark,callback:function(t){e.$set(e.newStoreForm,"remark","string"==typeof t?t.trim():t)},expression:"newStoreForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newStoreForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var E=o("X4nt")(D,z,!1,function(e){o("U+2q")},"data-v-4977ae5d",null).exports,B={name:"StoreDetail",data:function(){return{modStoreForm:{id:0,name:"",addreee:"",phone:"",remark:""},rules:{name:[{required:!0,message:"店铺名称不能为空",trigger:"blur"}],address:[{required:!0,message:"店铺地址不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modStore",t.modStoreForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/store"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){0===this.$store.state.store.stores.length?this.$router.push({path:"/store"}):this.modStoreForm=this.$store.getters.getStoreById(this.$route.params.id)}},W={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StoreDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/store"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑店铺")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modStoreForm",staticClass:"new-form",attrs:{model:e.modStoreForm,rules:e.rules,"label-width":"80px"},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modStoreForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modStoreForm.name,callback:function(t){e.$set(e.modStoreForm,"name","string"==typeof t?t.trim():t)},expression:"modStoreForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"地址",prop:"address"}},[o("el-input",{model:{value:e.modStoreForm.address,callback:function(t){e.$set(e.modStoreForm,"address","string"==typeof t?t.trim():t)},expression:"modStoreForm.address"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"电话"}},[o("el-input",{model:{value:e.modStoreForm.phone,callback:function(t){e.$set(e.modStoreForm,"phone","string"==typeof t?t.trim():t)},expression:"modStoreForm.phone"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modStoreForm.remark,callback:function(t){e.$set(e.modStoreForm,"remark","string"==typeof t?t.trim():t)},expression:"modStoreForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modStoreForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var q=o("X4nt")(B,W,!1,function(e){o("i/TY")},"data-v-5249ffe2",null).exports,O={name:"Principal",data:function(){return{principalSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",role:"2",type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.user.pageNum},pageSize:function(){return this.$store.state.user.pageSize},totalCount:function(){return this.$store.state.user.totalCount},totalPages:function(){return this.$store.state.user.totalPages},tableData:function(){return this.$store.state.user.users}},methods:{searchPrincipal:function(e){var t=this;this.loading=!0,"search"===e&&(this.principalSearch.oldContent=this.principalSearch.content),this.principalSearch.type=e,this.$store.dispatch("loadUser",this.principalSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.principalSearch.pageNum=e,this.searchPrincipal("page")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){this.$router.push({path:"/principal/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delUser",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchPrincipal("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchPrincipal("search")}},V={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Principal"},[o("el-form",{ref:"principalSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.principalSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchPrincipal("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.principalSearch.content,callback:function(t){e.$set(e.principalSearch,"content","string"==typeof t?t.trim():t)},expression:"principalSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchPrincipal("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/principal/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e._v(" "),o("el-table-column",{attrs:{prop:"mobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"gender",label:"性别"}}),e._v(" "),o("el-table-column",{attrs:{prop:"storeName",label:"店铺名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var L=o("X4nt")(O,V,!1,function(e){o("1///")},"data-v-f1e2d0f4",null).exports,X={name:"PrincipalNew",data:function(){return{newPrincipalForm:{role:2,name:"",email:"",mobile:"",gender:"",storeId:"",remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的数字",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"change"}],storeId:[{required:!0,message:"所属店铺不能为空",trigger:"change"}]},loading:!1,enterFlag:!0}},computed:{stores:function(){return this.$store.state.store.storesAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addUser",t.newPrincipalForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/principal"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},loadStoreAll:function(){var e=this;this.$store.dispatch("loadStoreAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadStoreAll()}},G={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"PrincipalNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/principal"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建店铺负责人")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newPrincipalForm",staticClass:"new-form",attrs:{model:e.newPrincipalForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newPrincipalForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newPrincipalForm.name,callback:function(t){e.$set(e.newPrincipalForm,"name","string"==typeof t?t.trim():t)},expression:"newPrincipalForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o("el-input",{model:{value:e.newPrincipalForm.email,callback:function(t){e.$set(e.newPrincipalForm,"email","string"==typeof t?t.trim():t)},expression:"newPrincipalForm.email"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{model:{value:e.newPrincipalForm.mobile,callback:function(t){e.$set(e.newPrincipalForm,"mobile",e._n(t))},expression:"newPrincipalForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.newPrincipalForm.gender,callback:function(t){e.$set(e.newPrincipalForm,"gender",e._n(t))},expression:"newPrincipalForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"所属店铺",prop:"storeId"}},[o("el-select",{attrs:{placeholder:"请选择店铺"},model:{value:e.newPrincipalForm.storeId,callback:function(t){e.$set(e.newPrincipalForm,"storeId",e._n(t))},expression:"newPrincipalForm.storeId"}},e._l(e.stores,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newPrincipalForm.remark,callback:function(t){e.$set(e.newPrincipalForm,"remark","string"==typeof t?t.trim():t)},expression:"newPrincipalForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newPrincipalForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var U=o("X4nt")(X,G,!1,function(e){o("+pwI")},"data-v-bf75f4cc",null).exports,H=o("gUGA"),Y=o.n(H),J={name:"PrincipalDetail",data:function(){return{modPrincipalForm:{id:"",role:"2",name:"",email:"",mobile:"",gender:"",storeId:"",remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的数字",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"change"}],storeId:[{required:!0,message:"所属店铺不能为空",trigger:"change"}]},loading:!1,enterFlag:!0}},computed:{stores:function(){return this.$store.state.store.storesAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modUser",t.modPrincipalForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/principal"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},loadStoreAll:function(){var e=this;this.$store.dispatch("loadStoreAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.user.users.length)this.$router.push({path:"/principal"});else{this.loadStoreAll();var e=this.$store.getters.getUserById(this.$route.params.id);this.modPrincipalForm.id=e.id,this.modPrincipalForm.name=e.name,this.modPrincipalForm.email=e.email,this.modPrincipalForm.mobile=Y()(e.mobile),this.modPrincipalForm.gender="男"===e.gender?1:0,this.modPrincipalForm.storeId=e.storeId,this.modPrincipalForm.remark=e.remark}}},Q={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"PrincipalDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/principal"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑店铺负责人")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modPrincipalForm",staticClass:"new-form",attrs:{model:e.modPrincipalForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modPrincipalForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modPrincipalForm.name,callback:function(t){e.$set(e.modPrincipalForm,"name","string"==typeof t?t.trim():t)},expression:"modPrincipalForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o("el-input",{model:{value:e.modPrincipalForm.email,callback:function(t){e.$set(e.modPrincipalForm,"email","string"==typeof t?t.trim():t)},expression:"modPrincipalForm.email"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{model:{value:e.modPrincipalForm.mobile,callback:function(t){e.$set(e.modPrincipalForm,"mobile",e._n(t))},expression:"modPrincipalForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.modPrincipalForm.gender,callback:function(t){e.$set(e.modPrincipalForm,"gender",e._n(t))},expression:"modPrincipalForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"所属店铺",prop:"storeId"}},[o("el-select",{attrs:{placeholder:"请选择店铺"},model:{value:e.modPrincipalForm.storeId,callback:function(t){e.$set(e.modPrincipalForm,"storeId",e._n(t))},expression:"modPrincipalForm.storeId"}},e._l(e.stores,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modPrincipalForm.remark,callback:function(t){e.$set(e.modPrincipalForm,"remark","string"==typeof t?t.trim():t)},expression:"modPrincipalForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modPrincipalForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Z=o("X4nt")(J,Q,!1,function(e){o("Q8hY")},"data-v-4d0a3f58",null).exports,K={name:"Reception",data:function(){return{receptionSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",role:"3",type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.user.pageNum},pageSize:function(){return this.$store.state.user.pageSize},totalCount:function(){return this.$store.state.user.totalCount},totalPages:function(){return this.$store.state.user.totalPages},tableData:function(){return this.$store.state.user.users}},methods:{searchReception:function(e){var t=this;this.loading=!0,"search"===e&&(this.receptionSearch.oldContent=this.receptionSearch.content),this.receptionSearch.type=e,this.$store.dispatch("loadUser",this.receptionSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.receptionSearch.pageNum=e,this.searchReception("page")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){this.$router.push({path:"/reception/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delUser",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchReception("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchReception("search")}},ee={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Reception"},[o("el-form",{ref:"receptionSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.receptionSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchReception("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.receptionSearch.content,callback:function(t){e.$set(e.receptionSearch,"content","string"==typeof t?t.trim():t)},expression:"receptionSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchReception("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/reception/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e._v(" "),o("el-table-column",{attrs:{prop:"mobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"gender",label:"性别"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var te=o("X4nt")(K,ee,!1,function(e){o("ydHB")},"data-v-0d39e3b5",null).exports,oe={name:"ReceptionNew",data:function(){return{newReceptionForm:{role:3,name:"",email:"",mobile:"",gender:"",remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的数字",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"change"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addUser",t.newReceptionForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/reception"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},ne={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ReceptionNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/reception"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建前台")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newReceptionForm",staticClass:"new-form",attrs:{model:e.newReceptionForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newReceptionForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newReceptionForm.name,callback:function(t){e.$set(e.newReceptionForm,"name","string"==typeof t?t.trim():t)},expression:"newReceptionForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o("el-input",{model:{value:e.newReceptionForm.email,callback:function(t){e.$set(e.newReceptionForm,"email","string"==typeof t?t.trim():t)},expression:"newReceptionForm.email"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{model:{value:e.newReceptionForm.mobile,callback:function(t){e.$set(e.newReceptionForm,"mobile",e._n(t))},expression:"newReceptionForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.newReceptionForm.gender,callback:function(t){e.$set(e.newReceptionForm,"gender",e._n(t))},expression:"newReceptionForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newReceptionForm.remark,callback:function(t){e.$set(e.newReceptionForm,"remark","string"==typeof t?t.trim():t)},expression:"newReceptionForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newReceptionForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var re=o("X4nt")(oe,ne,!1,function(e){o("VpBA")},"data-v-4ffe9040",null).exports,ae={name:"ReceptionDetail",data:function(){return{modReceptionForm:{id:"",role:"3",name:"",email:"",mobile:"",gender:"",remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的数字",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"change"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modUser",t.modReceptionForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/reception"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.user.users.length)this.$router.push({path:"/reception"});else{var e=this.$store.getters.getUserById(this.$route.params.id);this.modReceptionForm.id=e.id,this.modReceptionForm.name=e.name,this.modReceptionForm.email=e.email,this.modReceptionForm.mobile=Y()(e.mobile),this.modReceptionForm.gender="男"===e.gender?1:0,this.modReceptionForm.storeId=e.storeId,this.modReceptionForm.remark=e.remark}}},ie={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ReceptionDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/reception"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑前台")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modReceptionForm",staticClass:"new-form",attrs:{model:e.modReceptionForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modReceptionForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modReceptionForm.name,callback:function(t){e.$set(e.modReceptionForm,"name","string"==typeof t?t.trim():t)},expression:"modReceptionForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o("el-input",{model:{value:e.modReceptionForm.email,callback:function(t){e.$set(e.modReceptionForm,"email","string"==typeof t?t.trim():t)},expression:"modReceptionForm.email"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{model:{value:e.modReceptionForm.mobile,callback:function(t){e.$set(e.modReceptionForm,"mobile",e._n(t))},expression:"modReceptionForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.modReceptionForm.gender,callback:function(t){e.$set(e.modReceptionForm,"gender",e._n(t))},expression:"modReceptionForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modReceptionForm.remark,callback:function(t){e.$set(e.modReceptionForm,"remark","string"==typeof t?t.trim():t)},expression:"modReceptionForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modReceptionForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var se=o("X4nt")(ae,ie,!1,function(e){o("iCq4")},"data-v-8b2519fa",null).exports,le={name:"Operator",data:function(){return{operatorSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",role:"4",type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.user.pageNum},pageSize:function(){return this.$store.state.user.pageSize},totalCount:function(){return this.$store.state.user.totalCount},totalPages:function(){return this.$store.state.user.totalPages},tableData:function(){return this.$store.state.user.users}},methods:{searchOperator:function(e){var t=this;this.loading=!0,"search"===e&&(this.operatorSearch.oldContent=this.operatorSearch.content),this.operatorSearch.type=e,this.$store.dispatch("loadUser",this.operatorSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.operatorSearch.pageNum=e,this.searchOperator("page")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){this.$router.push({path:"/operator/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delUser",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchOperator("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchOperator("search")}},ce={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Operator"},[o("el-form",{ref:"operatorSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.operatorSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchOperator("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.operatorSearch.content,callback:function(t){e.$set(e.operatorSearch,"content","string"==typeof t?t.trim():t)},expression:"operatorSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchOperator("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/operator/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e._v(" "),o("el-table-column",{attrs:{prop:"mobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"gender",label:"性别"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var ue=o("X4nt")(le,ce,!1,function(e){o("ITDR")},"data-v-b9eaacc6",null).exports,me={name:"OperatorNew",data:function(){return{newOperatorForm:{role:4,name:"",email:"",mobile:"",gender:"",remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的数字",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"change"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addUser",t.newOperatorForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/operator"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},de={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"OperatorNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/operator"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建操作员")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newOperatorForm",staticClass:"new-form",attrs:{model:e.newOperatorForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newOperatorForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newOperatorForm.name,callback:function(t){e.$set(e.newOperatorForm,"name","string"==typeof t?t.trim():t)},expression:"newOperatorForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o("el-input",{model:{value:e.newOperatorForm.email,callback:function(t){e.$set(e.newOperatorForm,"email","string"==typeof t?t.trim():t)},expression:"newOperatorForm.email"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{model:{value:e.newOperatorForm.mobile,callback:function(t){e.$set(e.newOperatorForm,"mobile",e._n(t))},expression:"newOperatorForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.newOperatorForm.gender,callback:function(t){e.$set(e.newOperatorForm,"gender",e._n(t))},expression:"newOperatorForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newOperatorForm.remark,callback:function(t){e.$set(e.newOperatorForm,"remark","string"==typeof t?t.trim():t)},expression:"newOperatorForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newOperatorForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var pe=o("X4nt")(me,de,!1,function(e){o("wfoI")},"data-v-a464c7c4",null).exports,fe={name:"OperatorDetail",data:function(){return{modOperatorForm:{id:"",role:"4",name:"",email:"",mobile:"",gender:"",remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{required:!0,message:"邮箱不能为空",trigger:"blur"},{type:"email",message:"请输入正确的邮箱",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的数字",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"change"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modUser",t.modOperatorForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/operator"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.user.users.length)this.$router.push({path:"/operator"});else{var e=this.$store.getters.getUserById(this.$route.params.id);this.modOperatorForm.id=e.id,this.modOperatorForm.name=e.name,this.modOperatorForm.email=e.email,this.modOperatorForm.mobile=Y()(e.mobile),this.modOperatorForm.gender="男"===e.gender?1:0,this.modOperatorForm.storeId=e.storeId,this.modOperatorForm.remark=e.remark}}},he={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"OperatorDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/operator"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑操作员")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modOperatorForm",staticClass:"new-form",attrs:{model:e.modOperatorForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modOperatorForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modOperatorForm.name,callback:function(t){e.$set(e.modOperatorForm,"name","string"==typeof t?t.trim():t)},expression:"modOperatorForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[o("el-input",{model:{value:e.modOperatorForm.email,callback:function(t){e.$set(e.modOperatorForm,"email","string"==typeof t?t.trim():t)},expression:"modOperatorForm.email"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{model:{value:e.modOperatorForm.mobile,callback:function(t){e.$set(e.modOperatorForm,"mobile",e._n(t))},expression:"modOperatorForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.modOperatorForm.gender,callback:function(t){e.$set(e.modOperatorForm,"gender",e._n(t))},expression:"modOperatorForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modOperatorForm.remark,callback:function(t){e.$set(e.modOperatorForm,"remark","string"==typeof t?t.trim():t)},expression:"modOperatorForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modOperatorForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ge=o("X4nt")(fe,he,!1,function(e){o("kZIt")},"data-v-61e37b7e",null).exports,ve={name:"StockType",data:function(){return{stockTypeSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.stockType.pageNum},pageSize:function(){return this.$store.state.stockType.pageSize},totalCount:function(){return this.$store.state.stockType.totalCount},totalPages:function(){return this.$store.state.stockType.totalPages},tableData:function(){return this.$store.state.stockType.stockTypes}},methods:{searchStockType:function(e){var t=this;this.loading=!0,"search"===e&&(this.stockTypeSearch.oldContent=this.stockTypeSearch.content),this.stockTypeSearch.type=e,this.$store.dispatch("loadStockType",this.stockTypeSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.stockTypeSearch.pageNum=e,this.searchStockType("page")},handleEdit:function(e,t){this.$router.push({path:"/stock-type/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delStockType",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchStockType("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchStockType("search")}},ye={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockType"},[o("el-form",{ref:"stockTypeSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.stockTypeSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchStockType("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.stockTypeSearch.content,callback:function(t){e.$set(e.stockTypeSearch,"content","string"==typeof t?t.trim():t)},expression:"stockTypeSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchStockType("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/stock-type/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var be=o("X4nt")(ve,ye,!1,function(e){o("Nl4F")},"data-v-70a032bd",null).exports,Ce={name:"StockTypeNew",data:function(){return{newStockTypeForm:{name:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addStockType",t.newStockTypeForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/stock-type"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},_e={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockTypeNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/stock-type"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建库存分类")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newStockTypeForm",staticClass:"new-form",attrs:{model:e.newStockTypeForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newStockTypeForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.newStockTypeForm.name,callback:function(t){e.$set(e.newStockTypeForm,"name","string"==typeof t?t.trim():t)},expression:"newStockTypeForm.name"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newStockTypeForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ke=o("X4nt")(Ce,_e,!1,function(e){o("D6gq")},"data-v-7ccd876a",null).exports,we={name:"StockTypeDetail",data:function(){return{modStockTypeForm:{id:"",name:""},rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modStockType",t.modStockTypeForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/stock-type"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.stockType.stockTypes.length)this.$router.push({path:"/stock-type"});else{var e=this.$store.getters.getStockTypeById(this.$route.params.id);this.modStockTypeForm.id=e.id,this.modStockTypeForm.name=e.name}}},Pe={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockTypeDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/stock-type"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑库存分类")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modStockTypeForm",staticClass:"new-form",attrs:{model:e.modStockTypeForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modStockTypeForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.modStockTypeForm.name,callback:function(t){e.$set(e.modStockTypeForm,"name","string"==typeof t?t.trim():t)},expression:"modStockTypeForm.name"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modStockTypeForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Fe=o("X4nt")(we,Pe,!1,function(e){o("ZPcQ")},"data-v-5a24e280",null).exports,Se={name:"Stock",data:function(){return{stockSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.stock.pageNum},pageSize:function(){return this.$store.state.stock.pageSize},totalCount:function(){return this.$store.state.stock.totalCount},totalPages:function(){return this.$store.state.stock.totalPages},tableData:function(){return this.$store.state.stock.stocks}},methods:{searchStock:function(e){var t=this;this.loading=!0,"search"===e&&(this.stockSearch.oldContent=this.stockSearch.content),this.stockSearch.type=e,this.$store.dispatch("loadStock",this.stockSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.stockSearch.pageNum=e,this.searchStock("page")},handleNew:function(e,t){this.$router.push({path:"/stock/new-amount/"+t.id})},handleEdit:function(e,t){this.$router.push({path:"/stock/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delStock",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchStock("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchStock("search")}},$e={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Stock"},[o("el-form",{ref:"stockSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.stockSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchStock("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.stockSearch.content,callback:function(t){e.$set(e.stockSearch,"content","string"==typeof t?t.trim():t)},expression:"stockSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchStock("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/stock/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"code",label:"代码"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"stockTypeName",label:"库存分类"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitName",label:"计量单位"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"250",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleNew(t.$index,t.row)}}},[e._v("首次进货")]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var xe=o("X4nt")(Se,$e,!1,function(e){o("x3HZ")},"data-v-293d8865",null).exports,je={name:"StockNew",data:function(){return{newStockForm:{name:"",code:"",stockTypeId:"",unitName:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],stockTypeId:[{required:!0,message:"库存分类不能为空",trigger:"blur"},{type:"number",message:"库存分类必须是数字",trigger:"blur"}],unitName:[{required:!0,message:"计量单位名称不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},computed:{stockTypes:function(){return this.$store.state.stockType.stockTypesAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addStock",t.newStockForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/stock"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},loadStockTypeAll:function(){var e=this;this.$store.dispatch("loadStockTypeAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadStockTypeAll()}},Ae={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/stock"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建库存")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newStockForm",staticClass:"new-form",attrs:{model:e.newStockForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newStockForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newStockForm.name,callback:function(t){e.$set(e.newStockForm,"name","string"==typeof t?t.trim():t)},expression:"newStockForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newStockForm.code,callback:function(t){e.$set(e.newStockForm,"code",t)},expression:"newStockForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属库存分类",prop:"stockTypeId"}},[o("el-select",{attrs:{placeholder:"请选择库存分类"},model:{value:e.newStockForm.stockTypeId,callback:function(t){e.$set(e.newStockForm,"stockTypeId",e._n(t))},expression:"newStockForm.stockTypeId"}},e._l(e.stockTypes,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"计量单位名称",prop:"unitName"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newStockForm.unitName,callback:function(t){e.$set(e.newStockForm,"unitName","string"==typeof t?t.trim():t)},expression:"newStockForm.unitName"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newStockForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Te=o("X4nt")(je,Ae,!1,function(e){o("P7hf")},"data-v-439ef37c",null).exports,Ie={name:"StockDetail",data:function(){return{modStockForm:{id:"",name:"",code:"",stockTypeId:"",unitName:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],stockTypeId:[{required:!0,message:"库存分类不能为空",trigger:"blur"},{type:"number",message:"库存分类必须是数字",trigger:"blur"}],unitName:[{required:!0,message:"计量单位名称不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},computed:{stockTypes:function(){return this.$store.state.stockType.stockTypesAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modStock",t.modStockForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/stock"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},loadStockTypeAll:function(){var e=this;this.$store.dispatch("loadStockTypeAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.stock.stocks.length)this.$router.push({path:"/stock"});else{this.loadStockTypeAll();var e=this.$store.getters.getStockById(this.$route.params.id);this.modStockForm.id=e.id,this.modStockForm.name=e.name,this.modStockForm.code=e.code,this.modStockForm.stockTypeId=e.stockTypeId,this.modStockForm.unitName=e.unitName}}},Me={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/stock"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑库存")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modStockForm",staticClass:"new-form",attrs:{model:e.modStockForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modStockForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modStockForm.name,callback:function(t){e.$set(e.modStockForm,"name","string"==typeof t?t.trim():t)},expression:"modStockForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{model:{value:e.modStockForm.code,callback:function(t){e.$set(e.modStockForm,"code",t)},expression:"modStockForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属库存分类",prop:"stockTypeId"}},[o("el-select",{attrs:{placeholder:"请选择库存分类"},model:{value:e.modStockForm.stockTypeId,callback:function(t){e.$set(e.modStockForm,"stockTypeId",e._n(t))},expression:"modStockForm.stockTypeId"}},e._l(e.stockTypes,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"计量单位名称",prop:"unitName"}},[o("el-input",{model:{value:e.modStockForm.unitName,callback:function(t){e.$set(e.modStockForm,"unitName","string"==typeof t?t.trim():t)},expression:"modStockForm.unitName"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modStockForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Ne=o("X4nt")(Ie,Me,!1,function(e){o("6HUH")},"data-v-1a465afa",null).exports,Re={name:"StockNewAmount",data:function(){return{newStockAmountForm:{stockId:"",amount:""},rules:{amount:[{required:!0,message:"进货数量不能为空",trigger:"blur"},{type:"number",message:"进货数量必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addStockAmount",t.newStockAmountForm).then(function(e){0===e.code&&(t.$message.success("首次进货成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/stock"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.stock.stocks.length)this.$router.push({path:"/stock"});else{var e=this.$store.getters.getStockById(this.$route.params.id);this.newStockAmountForm.stockId=e.id}}},De={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockNewAmount"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/stock"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("首次进货")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newStockAmountForm",staticClass:"new-form",attrs:{model:e.newStockAmountForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newStockAmountForm")}}},[o("el-form-item",{attrs:{label:"进货数量",prop:"amount"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.newStockAmountForm.amount,callback:function(t){e.$set(e.newStockAmountForm,"amount",e._n(t))},expression:"newStockAmountForm.amount"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newStockAmountForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ze=o("X4nt")(Re,De,!1,function(e){o("tNjB")},"data-v-7e5ba73f",null).exports,Ee={name:"StockAmount",data:function(){return{stockAmountSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},exportStocksForm:{exportTime:""},loading:!1,exportStocksVisible:!1,exportLoading:!1}},computed:{pageNum:function(){return this.$store.state.stockAmount.pageNum},pageSize:function(){return this.$store.state.stockAmount.pageSize},totalCount:function(){return this.$store.state.stockAmount.totalCount},totalPages:function(){return this.$store.state.stockAmount.totalPages},tableData:function(){return this.$store.state.stockAmount.stockAmounts}},methods:{searchStockAmount:function(e){var t=this;this.loading=!0,"search"===e&&(this.stockAmountSearch.oldContent=this.stockAmountSearch.content),this.stockAmountSearch.type=e,this.$store.dispatch("loadStockAmount",this.stockAmountSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.stockAmountSearch.pageNum=e,this.searchStockAmount("page")},handleSupply:function(e,t){console.log(t.stockAmountId),this.$router.push({path:"/stock-amount-supply/"+t.stockAmountId})},handleEdit:function(e,t){this.$router.push({path:"/stock-amount-detail/"+t.stockAmountId})},onClose:function(e){this.exportStocksVisible=!1,this.$refs[e].resetFields()},onExport:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.exportLoading=!0;var n=void 0,r=void 0;if(""!=t.exportStocksForm.exportTime?(n=t.toTimeStamp(t.exportStocksForm.exportTime[0]),r=t.toTimeStamp(t.exportStocksForm.exportTime[1])):(n="",r=""),""!=n&&""!=r&&n===r)t.$message.error("请选择不同的日期！"),t.exportLoading=!1,t.$refs[e].resetFields();else{var a="http://localhost:8080/export/stocks";a=a+"?beginTime="+n+"&endTime="+r+"&token="+sessionStorage.getItem("token"),window.location.href=a,setTimeout(function(){t.exportLoading=!1,t.exportStocksVisible=!1,t.$refs[e].resetFields()},2e3)}})}},beforeMount:function(){this.searchStockAmount("search")}},Be={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockAmount"},[o("el-form",{ref:"stockAmountSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.stockAmountSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchStockAmount("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.stockAmountSearch.content,callback:function(t){e.$set(e.stockAmountSearch,"content","string"==typeof t?t.trim():t)},expression:"stockAmountSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchStockAmount("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("el-button",{attrs:{icon:"el-icon-download"},on:{click:function(t){e.exportStocksVisible=!0}}},[e._v("导出库存流水")])],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"code",label:"代码"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"stockTypeName",label:"库存分类"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitName",label:"计量单位"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){e.handleSupply(t.$index,t.row)}}},[e._v("补货")]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"导出库存流水",visible:e.exportStocksVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.exportStocksVisible=t}}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.exportLoading,expression:"exportLoading"}],ref:"exportStocksForm",attrs:{model:e.exportStocksForm}},[o("el-form-item",{attrs:{prop:"exportTime"}},[o("el-date-picker",{attrs:{type:"daterange",align:"center","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.exportStocksForm.exportTime,callback:function(t){e.$set(e.exportStocksForm,"exportTime",t)},expression:"exportStocksForm.exportTime"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("exportStocksForm")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onExport("exportStocksForm")}}},[e._v("导 出")])],1)],1)],1)},staticRenderFns:[]};var We=o("X4nt")(Ee,Be,!1,function(e){o("MLt7")},"data-v-e4cdb06e",null).exports,qe={name:"StockAmountSupply",data:function(){return{supplyStockAmountForm:{id:"",amount:""},rules:{amount:[{required:!0,message:"进货数量不能为空",trigger:"blur"},{type:"number",message:"进货数量必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("supplyStockAmount",t.supplyStockAmountForm).then(function(e){0===e.code&&(t.$message.success("补货成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/stock-amount"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.stockAmount.stockAmounts.length)this.$router.push({path:"/stock-amount"});else{var e=this.$store.getters.getStockAmountBySAId(this.$route.params.id);this.supplyStockAmountForm.id=e.stockAmountId}}},Oe={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockAmountSupply"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/stock-amount"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("补货")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"supplyStockAmountForm",staticClass:"new-form",attrs:{model:e.supplyStockAmountForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("supplyStockAmountForm")}}},[o("el-form-item",{attrs:{label:"补货数量",prop:"amount"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.supplyStockAmountForm.amount,callback:function(t){e.$set(e.supplyStockAmountForm,"amount",e._n(t))},expression:"supplyStockAmountForm.amount"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("supplyStockAmountForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Ve=o("X4nt")(qe,Oe,!1,function(e){o("/I2m")},"data-v-f8f0cc3e",null).exports,Le={name:"StockAmountSupply",data:function(){return{modStockAmountForm:{id:"",amount:""},rules:{amount:[{required:!0,message:"数量不能为空",trigger:"blur"},{type:"number",message:"数量必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modStockAmount",t.modStockAmountForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/stock-amount"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.stockAmount.stockAmounts.length)this.$router.push({path:"/stock-amount"});else{var e=this.$store.getters.getStockAmountBySAId(this.$route.params.id);this.modStockAmountForm.id=e.stockAmountId,this.modStockAmountForm.amount=e.amount}}},Xe={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"StockAmountSupply"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/stock-amount"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modStockAmountForm",staticClass:"new-form",attrs:{model:e.modStockAmountForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modStockAmountForm")}}},[o("el-form-item",{attrs:{label:"数量",prop:"amount"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.modStockAmountForm.amount,callback:function(t){e.$set(e.modStockAmountForm,"amount",e._n(t))},expression:"modStockAmountForm.amount"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modStockAmountForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Ge=o("X4nt")(Le,Xe,!1,function(e){o("7dkV")},"data-v-4ce31c18",null).exports,Ue={name:"ProductType",data:function(){return{productTypeSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.productType.pageNum},pageSize:function(){return this.$store.state.productType.pageSize},totalCount:function(){return this.$store.state.productType.totalCount},totalPages:function(){return this.$store.state.productType.totalPages},tableData:function(){return this.$store.state.productType.productTypes}},methods:{searchProductType:function(e){var t=this;this.loading=!0,"search"===e&&(this.productTypeSearch.oldContent=this.productTypeSearch.content),this.productTypeSearch.type=e,this.$store.dispatch("loadProductType",this.productTypeSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.productTypeSearch.pageNum=e,this.searchProductType("page")},handleEdit:function(e,t){this.$router.push({path:"/product-type/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delProductType",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchProductType("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchProductType("search")}},He={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductType"},[o("el-form",{ref:"productTypeSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.productTypeSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchProductType("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.productTypeSearch.content,callback:function(t){e.$set(e.productTypeSearch,"content","string"==typeof t?t.trim():t)},expression:"productTypeSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchProductType("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/product-type/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var Ye=o("X4nt")(Ue,He,!1,function(e){o("KDYW")},"data-v-255f67f0",null).exports,Je={name:"ProductTypeNew",data:function(){return{newProductTypeForm:{name:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addProductType",t.newProductTypeForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/product-type"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},Qe={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductTypeNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/product-type"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建产品分类")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newProductTypeForm",staticClass:"new-form",attrs:{model:e.newProductTypeForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newProductTypeForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.newProductTypeForm.name,callback:function(t){e.$set(e.newProductTypeForm,"name","string"==typeof t?t.trim():t)},expression:"newProductTypeForm.name"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newProductTypeForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Ze=o("X4nt")(Je,Qe,!1,function(e){o("BD32")},"data-v-11b17e56",null).exports,Ke={name:"ProductTypeDetail",data:function(){return{modProductTypeForm:{id:"",name:""},rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modProductType",t.modProductTypeForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/product-type"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.productType.productTypes.length)this.$router.push({path:"/product-type"});else{var e=this.$store.getters.getProductTypeById(this.$route.params.id);this.modProductTypeForm.id=e.id,this.modProductTypeForm.name=e.name}}},et={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductTypeDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/product-type"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑产品分类")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modProductTypeForm",staticClass:"new-form",attrs:{model:e.modProductTypeForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modProductTypeForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.modProductTypeForm.name,callback:function(t){e.$set(e.modProductTypeForm,"name","string"==typeof t?t.trim():t)},expression:"modProductTypeForm.name"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modProductTypeForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var tt=o("X4nt")(Ke,et,!1,function(e){o("aPjV")},"data-v-1bcba234",null).exports,ot={name:"Product",data:function(){return{productSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.product.pageNum},pageSize:function(){return this.$store.state.product.pageSize},totalCount:function(){return this.$store.state.product.totalCount},totalPages:function(){return this.$store.state.product.totalPages},tableData:function(){return this.$store.state.product.products}},methods:{searchProduct:function(e){var t=this;this.loading=!0,"search"===e&&(this.productSearch.oldContent=this.productSearch.content),this.productSearch.type=e,this.$store.dispatch("loadProduct",this.productSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.productSearch.pageNum=e,this.searchProduct("page")},handleNew:function(e,t){this.$router.push({path:"/product/new-amount/"+t.id})},handleEdit:function(e,t){this.$router.push({path:"/product/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delProduct",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchProduct("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchProduct("search")}},nt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Product"},[o("el-form",{ref:"productSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.productSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchProduct("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.productSearch.content,callback:function(t){e.$set(e.productSearch,"content","string"==typeof t?t.trim():t)},expression:"productSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchProduct("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/product/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"code",label:"代码"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"productTypeName",label:"产品分类"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitName",label:"计量单位"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitPrice",label:"单价"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"250",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleNew(t.$index,t.row)}}},[e._v("首次进货")]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var rt=o("X4nt")(ot,nt,!1,function(e){o("lH8B")},"data-v-d9c007a6",null).exports,at={name:"ProductNew",data:function(){return{newProductForm:{name:"",code:"",productTypeId:"",unitName:"",unitPrice:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],productTypeId:[{required:!0,message:"产品分类不能为空",trigger:"blur"},{type:"number",message:"产品分类必须是数字",trigger:"blur"}],unitName:[{required:!0,message:"计量单位名称不能为空",trigger:"blur"}],unitPrice:[{required:!0,message:"单价不能为空",trigger:"blur"},{type:"number",message:"单价必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},computed:{productTypes:function(){return this.$store.state.productType.productTypesAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addProduct",t.newProductForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/product"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},loadProductTypeAll:function(){var e=this;this.$store.dispatch("loadProductTypeAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadProductTypeAll()}},it={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/stock"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建产品")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newProductForm",staticClass:"new-form",attrs:{model:e.newProductForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newProductForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newProductForm.name,callback:function(t){e.$set(e.newProductForm,"name","string"==typeof t?t.trim():t)},expression:"newProductForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newProductForm.code,callback:function(t){e.$set(e.newProductForm,"code",t)},expression:"newProductForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属产品分类",prop:"productTypeId"}},[o("el-select",{attrs:{placeholder:"请选择产品分类"},model:{value:e.newProductForm.productTypeId,callback:function(t){e.$set(e.newProductForm,"productTypeId",e._n(t))},expression:"newProductForm.productTypeId"}},e._l(e.productTypes,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"计量单位名称",prop:"unitName"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newProductForm.unitName,callback:function(t){e.$set(e.newProductForm,"unitName","string"==typeof t?t.trim():t)},expression:"newProductForm.unitName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"单价(元)",prop:"unitPrice"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newProductForm.unitPrice,callback:function(t){e.$set(e.newProductForm,"unitPrice",e._n(t))},expression:"newProductForm.unitPrice"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newProductForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var st=o("X4nt")(at,it,!1,function(e){o("yfFj")},"data-v-7a7db1ad",null).exports,lt={name:"ProductDetail",data:function(){return{modProductForm:{id:"",name:"",code:"",productTypeId:"",unitName:"",unitPrice:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],stockTypeId:[{required:!0,message:"产品分类不能为空",trigger:"blur"},{type:"number",message:"产品分类必须是数字",trigger:"blur"}],unitName:[{required:!0,message:"计量单位名称不能为空",trigger:"blur"}],unitPrice:[{required:!0,message:"单价不能为空",trigger:"blur"},{type:"number",message:"单价必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},computed:{productTypes:function(){return this.$store.state.productType.productTypesAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modProduct",t.modProductForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/product"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},loadProductTypeAll:function(){var e=this;this.$store.dispatch("loadProductTypeAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.product.products.length)this.$router.push({path:"/product"});else{this.loadProductTypeAll();var e=this.$store.getters.getProductById(this.$route.params.id);this.modProductForm.id=e.id,this.modProductForm.name=e.name,this.modProductForm.code=e.code,this.modProductForm.productTypeId=e.productTypeId,this.modProductForm.unitName=e.unitName,this.modProductForm.unitPrice=e.unitPrice}}},ct={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/product"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑产品")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modProductForm",staticClass:"new-form",attrs:{model:e.modProductForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modProductForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modProductForm.name,callback:function(t){e.$set(e.modProductForm,"name","string"==typeof t?t.trim():t)},expression:"modProductForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modProductForm.code,callback:function(t){e.$set(e.modProductForm,"code",t)},expression:"modProductForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属产品分类",prop:"productTypeId"}},[o("el-select",{attrs:{placeholder:"请选择产品分类"},model:{value:e.modProductForm.productTypeId,callback:function(t){e.$set(e.modProductForm,"productTypeId",e._n(t))},expression:"modProductForm.productTypeId"}},e._l(e.productTypes,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"计量单位名称",prop:"unitName"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modProductForm.unitName,callback:function(t){e.$set(e.modProductForm,"unitName","string"==typeof t?t.trim():t)},expression:"modProductForm.unitName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"单价(元)",prop:"unitName"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modProductForm.unitPrice,callback:function(t){e.$set(e.modProductForm,"unitPrice","string"==typeof t?t.trim():t)},expression:"modProductForm.unitPrice"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modProductForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ut=o("X4nt")(lt,ct,!1,function(e){o("9zyV")},"data-v-3538d998",null).exports,mt={name:"ProductNewAmount",data:function(){return{newProductAmountForm:{productId:"",amount:""},rules:{amount:[{required:!0,message:"进货数量不能为空",trigger:"blur"},{type:"number",message:"进货数量必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addProductAmount",t.newProductAmountForm).then(function(e){0===e.code&&(t.$message.success("首次进货成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/product"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.product.products.length)this.$router.push({path:"/product"});else{var e=this.$store.getters.getProductById(this.$route.params.id);this.newProductAmountForm.productId=e.id}}},dt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductNewAmount"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/product"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("首次进货")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newProductAmountForm",staticClass:"new-form",attrs:{model:e.newProductAmountForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newProductAmountForm")}}},[o("el-form-item",{attrs:{label:"进货数量",prop:"amount"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.newProductAmountForm.amount,callback:function(t){e.$set(e.newProductAmountForm,"amount",e._n(t))},expression:"newProductAmountForm.amount"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newProductAmountForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var pt=o("X4nt")(mt,dt,!1,function(e){o("4tqP")},"data-v-0dc03700",null).exports,ft={name:"ProductAmount",data:function(){return{productAmountSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},exportProductsForm:{exportTime:""},loading:!1,exportProductsVisible:!1,exportLoading:!1}},computed:{pageNum:function(){return this.$store.state.productAmount.pageNum},pageSize:function(){return this.$store.state.productAmount.pageSize},totalCount:function(){return this.$store.state.productAmount.totalCount},totalPages:function(){return this.$store.state.productAmount.totalPages},tableData:function(){return this.$store.state.productAmount.productAmounts}},methods:{searchProductAmount:function(e){var t=this;this.loading=!0,"search"===e&&(this.productAmountSearch.oldContent=this.productAmountSearch.content),this.productAmountSearch.type=e,this.$store.dispatch("loadProductAmount",this.productAmountSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.productAmountSearch.pageNum=e,this.searchProductAmount("page")},handleSupply:function(e,t){this.$router.push({path:"/product-amount-supply/"+t.productAmountId})},handleEdit:function(e,t){this.$router.push({path:"/product-amount-detail/"+t.productAmountId})},onClose:function(e){this.exportProductsVisible=!1,this.$refs[e].resetFields()},onExport:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.exportLoading=!0;var n=void 0,r=void 0;if(""!=t.exportProductsForm.exportTime?(n=t.toTimeStamp(t.exportProductsForm.exportTime[0]),r=t.toTimeStamp(t.exportProductsForm.exportTime[1])):(n="",r=""),""!=n&&""!=r&&n===r)t.$message.error("请选择不同的日期！"),t.exportLoading=!1,t.$refs[e].resetFields();else{var a="http://localhost:8080/export/products";a=a+"?beginTime="+n+"&endTime="+r+"&token="+sessionStorage.getItem("token"),window.location.href=a,setTimeout(function(){t.exportLoading=!1,t.exportProductsVisible=!1,t.$refs[e].resetFields()},2e3)}})}},beforeMount:function(){this.searchProductAmount("search")}},ht={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductAmount"},[o("el-form",{ref:"productAmountSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.productAmountSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchProductAmount("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.productAmountSearch.content,callback:function(t){e.$set(e.productAmountSearch,"content","string"==typeof t?t.trim():t)},expression:"productAmountSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchProductAmount("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("el-button",{attrs:{icon:"el-icon-download"},on:{click:function(t){e.exportProductsVisible=!0}}},[e._v("导出产品流水")])],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"code",label:"编码"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"productTypeName",label:"产品分类"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitName",label:"计量单位"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitPrice",label:"单价"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(o){e.handleSupply(t.$index,t.row)}}},[e._v("补货")]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"导出产品流水",visible:e.exportProductsVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.exportProductsVisible=t}}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.exportLoading,expression:"exportLoading"}],ref:"exportProductsForm",attrs:{model:e.exportProductsForm}},[o("el-form-item",{attrs:{prop:"exportTime"}},[o("el-date-picker",{attrs:{type:"daterange",align:"center","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.exportProductsForm.exportTime,callback:function(t){e.$set(e.exportProductsForm,"exportTime",t)},expression:"exportProductsForm.exportTime"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("exportProductsForm")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onExport("exportProductsForm")}}},[e._v("导 出")])],1)],1)],1)},staticRenderFns:[]};var gt=o("X4nt")(ft,ht,!1,function(e){o("54aj")},"data-v-4f5873d6",null).exports,vt={name:"ProductAmountSupply",data:function(){return{supplyProductAmountForm:{id:"",amount:""},rules:{amount:[{required:!0,message:"进货数量不能为空",trigger:"blur"},{type:"number",message:"进货数量必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("supplyProductAmount",t.supplyProductAmountForm).then(function(e){0===e.code&&(t.$message.success("补货成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/product-amount"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.productAmount.productAmounts.length)this.$router.push({path:"/product-amount"});else{var e=this.$store.getters.getProductAmountByPAId(this.$route.params.id);this.supplyProductAmountForm.id=e.productAmountId}}},yt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductAmountSupply"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/product-amount"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("补货")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"supplyProductAmountForm",staticClass:"new-form",attrs:{model:e.supplyProductAmountForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("supplyProductAmountForm")}}},[o("el-form-item",{attrs:{label:"补货数量",prop:"amount"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.supplyProductAmountForm.amount,callback:function(t){e.$set(e.supplyProductAmountForm,"amount",e._n(t))},expression:"supplyProductAmountForm.amount"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("supplyProductAmountForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var bt=o("X4nt")(vt,yt,!1,function(e){o("5uRl")},"data-v-1b917aec",null).exports,Ct={name:"ProductAmountSupply",data:function(){return{modProductAmountForm:{id:"",amount:""},rules:{amount:[{required:!0,message:"数量不能为空",trigger:"blur"},{type:"number",message:"数量必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modProductAmount",t.modProductAmountForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/product-amount"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.productAmount.productAmounts.length)this.$router.push({path:"/product-amount"});else{var e=this.$store.getters.getProductAmountByPAId(this.$route.params.id);this.modProductAmountForm.id=e.productAmountId,this.modProductAmountForm.amount=e.amount}}},_t={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProductAmountSupply"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/product-amount"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modProductAmountForm",staticClass:"new-form",attrs:{model:e.modProductAmountForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modProductAmountForm")}}},[o("el-form-item",{attrs:{label:"数量",prop:"amount"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{autofocus:!0},model:{value:e.modProductAmountForm.amount,callback:function(t){e.$set(e.modProductAmountForm,"amount",e._n(t))},expression:"modProductAmountForm.amount"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modProductAmountForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var kt=o("X4nt")(Ct,_t,!1,function(e){o("guIJ")},"data-v-924ac722",null).exports,wt={name:"Customer",data:function(){return{customerSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},exportCustomerForm:{exportTime:""},loading:!1,exportCustomerVisible:!1,exportLoading:!1}},computed:{pageNum:function(){return this.$store.state.customer.pageNum},pageSize:function(){return this.$store.state.customer.pageSize},totalCount:function(){return this.$store.state.customer.totalCount},totalPages:function(){return this.$store.state.customer.totalPages},tableData:function(){return this.$store.state.customer.customers}},methods:{searchCustomer:function(e){var t=this;this.loading=!0,"search"===e&&(this.customerSearch.oldContent=this.customerSearch.content),this.customerSearch.type=e,this.$store.dispatch("loadCustomer",this.customerSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.customerSearch.pageNum=e,this.searchStock("page")},toDate:function(e,t){return e.birthday&&""!==e.birthday?this.toDatetimeDay(e.birthday):"暂无生日"},handleSource:function(e,t){return e.source&&""!==e.source?e.source:"暂无来源"},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){this.$router.push({path:"/customer/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delCustomer",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchCustomer("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})},onClose:function(e){this.exportCustomerVisible=!1,this.$refs[e].resetFields()},onExport:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.exportLoading=!0;var n=void 0,r=void 0;if(""!=t.exportCustomerForm.exportTime?(n=t.toTimeStamp(t.exportCustomerForm.exportTime[0]),r=t.toTimeStamp(t.exportCustomerForm.exportTime[1])):(n="",r=""),""!=n&&""!=r&&n===r)t.$message.error("请选择不同的日期！"),t.exportLoading=!1,t.$refs[e].resetFields();else{var a="http://localhost:8080/export/customer";a=a+"?beginTime="+n+"&endTime="+r+"&token="+sessionStorage.getItem("token"),window.location.href=a,setTimeout(function(){t.exportLoading=!1,t.exportCustomerVisible=!1,t.$refs[e].resetFields()},2e3)}})}},beforeMount:function(){this.searchCustomer("search")}},Pt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Customer"},[o("el-form",{ref:"customerSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.customerSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchCustomer("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.customerSearch.content,callback:function(t){e.$set(e.customerSearch,"content","string"==typeof t?t.trim():t)},expression:"customerSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchCustomer("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/customer/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1),e._v(" "),o("el-button",{attrs:{icon:"el-icon-download"},on:{click:function(t){e.exportCustomerVisible=!0}}},[e._v("导出顾客信息")])],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"gender",label:"性别"}}),e._v(" "),o("el-table-column",{attrs:{prop:"mobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"birthday",label:"生日",formatter:e.toDate}}),e._v(" "),o("el-table-column",{attrs:{prop:"source",label:"来源",formatter:e.handleSource}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"导出顾客信息",visible:e.exportCustomerVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.exportCustomerVisible=t}}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.exportLoading,expression:"exportLoading"}],ref:"exportCustomerForm",attrs:{model:e.exportCustomerForm}},[o("el-form-item",{attrs:{prop:"exportTime"}},[o("el-date-picker",{attrs:{type:"daterange",align:"center","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.exportCustomerForm.exportTime,callback:function(t){e.$set(e.exportCustomerForm,"exportTime",t)},expression:"exportCustomerForm.exportTime"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("exportCustomerForm")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onExport("exportCustomerForm")}}},[e._v("导 出")])],1)],1)],1)},staticRenderFns:[]};var Ft=o("X4nt")(wt,Pt,!1,function(e){o("9WUa")},"data-v-01537f10",null).exports,St={name:"CustomerNew",data:function(){return{newCustomerForm:{name:"",gender:"",mobile:"",birthday:"",source:"",remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"blur"},{type:"number",message:"性别必须是数字",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的手机",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addCustomer",{name:t.newCustomerForm.name,gender:t.newCustomerForm.gender,mobile:t.newCustomerForm.mobile,birthday:""===t.newCustomerForm.birthday?"":t.toTimeStamp(t.newCustomerForm.birthday),source:t.newCustomerForm.source,remark:t.newCustomerForm.remark}).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/customer"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},$t={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/customer"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建客户")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newCustomerForm",staticClass:"new-form",attrs:{model:e.newCustomerForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newCustomerForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newCustomerForm.name,callback:function(t){e.$set(e.newCustomerForm,"name","string"==typeof t?t.trim():t)},expression:"newCustomerForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.newCustomerForm.gender,callback:function(t){e.$set(e.newCustomerForm,"gender",e._n(t))},expression:"newCustomerForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{attrs:{placeholder:"请输入手机"},model:{value:e.newCustomerForm.mobile,callback:function(t){e.$set(e.newCustomerForm,"mobile",e._n(t))},expression:"newCustomerForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"生日",prop:"birthday"}},[o("el-date-picker",{attrs:{align:"center",type:"date",editable:!1,placeholder:"选择日期"},model:{value:e.newCustomerForm.birthday,callback:function(t){e.$set(e.newCustomerForm,"birthday",t)},expression:"newCustomerForm.birthday"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"来源"}},[o("el-input",{attrs:{placeholder:"请输入来源"},model:{value:e.newCustomerForm.source,callback:function(t){e.$set(e.newCustomerForm,"source","string"==typeof t?t.trim():t)},expression:"newCustomerForm.source"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newCustomerForm.remark,callback:function(t){e.$set(e.newCustomerForm,"remark","string"==typeof t?t.trim():t)},expression:"newCustomerForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newCustomerForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var xt=o("X4nt")(St,$t,!1,function(e){o("XvSI")},"data-v-2b159dfc",null).exports,jt={name:"CustomerDetail",data:function(){return{modCustomerForm:{id:"",name:"",gender:"",mobile:"",birthday:"",source:"",remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"change"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的手机",trigger:"blur"}],birthday:[{required:!0,message:"生日不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modCustomer",{id:t.modCustomerForm.id,name:t.modCustomerForm.name,gender:t.modCustomerForm.gender,mobile:t.modCustomerForm.mobile,birthday:t.toTimeStamp(t.modCustomerForm.birthday),source:t.modCustomerForm.source,remark:t.modCustomerForm.remark}).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/customer"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.customer.customers.length)this.$router.push({path:"/customer"});else{var e=this.$store.getters.getCustomerById(this.$route.params.id);this.modCustomerForm.id=e.id,this.modCustomerForm.name=e.name,this.modCustomerForm.gender="男"===e.gender?1:0,this.modCustomerForm.mobile=Y()(e.mobile),this.modCustomerForm.birthday=this.toDateObject(e.birthday),this.modCustomerForm.source=e.source,this.modCustomerForm.remark=e.remark}}},At={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/customer"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑店铺负责人")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modCustomerForm",staticClass:"new-form",attrs:{model:e.modCustomerForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modCustomerForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modCustomerForm.name,callback:function(t){e.$set(e.modCustomerForm,"name","string"==typeof t?t.trim():t)},expression:"modCustomerForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.modCustomerForm.gender,callback:function(t){e.$set(e.modCustomerForm,"gender",e._n(t))},expression:"modCustomerForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{attrs:{placeholder:"请输入手机"},model:{value:e.modCustomerForm.mobile,callback:function(t){e.$set(e.modCustomerForm,"mobile",e._n(t))},expression:"modCustomerForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"生日",prop:"birthday"}},[o("el-date-picker",{attrs:{align:"center",type:"date",editable:!1,placeholder:"选择日期"},model:{value:e.modCustomerForm.birthday,callback:function(t){e.$set(e.modCustomerForm,"birthday",t)},expression:"modCustomerForm.birthday"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"来源"}},[o("el-input",{attrs:{placeholder:"请输入来源"},model:{value:e.modCustomerForm.source,callback:function(t){e.$set(e.modCustomerForm,"source","string"==typeof t?t.trim():t)},expression:"modCustomerForm.source"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modCustomerForm.remark,callback:function(t){e.$set(e.modCustomerForm,"remark","string"==typeof t?t.trim():t)},expression:"modCustomerForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modCustomerForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Tt=o("X4nt")(jt,At,!1,function(e){o("SShA")},"data-v-7e7d2d0c",null).exports,It={name:"Employee",data:function(){return{employeeSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},exportPerformanceForm:{exportTime:""},loading:!1,exportPerformanceVisible:!1,exportLoading:!1}},computed:{pageNum:function(){return this.$store.state.employee.pageNum},pageSize:function(){return this.$store.state.employee.pageSize},totalCount:function(){return this.$store.state.employee.totalCount},totalPages:function(){return this.$store.state.employee.totalPages},tableData:function(){return this.$store.state.employee.employees}},methods:{searchEmployee:function(e){var t=this;this.loading=!0,"search"===e&&(this.employeeSearch.oldContent=this.employeeSearch.content),this.employeeSearch.type=e,this.$store.dispatch("loadEmployee",this.employeeSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.employeeSearch.pageNum=e,this.searchEmployee("page")},toDate:function(e,t){return this.toDatetimeDay(e.entryTime)},toWorkType:function(e,t){var o=[],n=!0,r=!1,a=void 0;try{for(var i,s=k()(e.employeeWorkVos);!(n=(i=s.next()).done);n=!0){var l=i.value;o.push(l.workTypeDesc)}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o.join(",")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){this.$router.push({path:"/employee/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delEmployee",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchEmployee("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})},onClose:function(e){this.exportPerformanceVisible=!1,this.$refs[e].resetFields()},onExport:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.exportLoading=!0;var n=void 0,r=void 0;if(""!=t.exportPerformanceForm.exportTime?(n=t.toTimeStamp(t.exportPerformanceForm.exportTime[0]),r=t.toTimeStamp(t.exportPerformanceForm.exportTime[1])):(n="",r=""),""!=n&&""!=r&&n===r)t.$message.error("请选择不同的日期！"),t.exportLoading=!1,t.$refs[e].resetFields();else{var a="http://localhost:8080/export/employeePerformance";a=a+"?beginTime="+n+"&endTime="+r+"&token="+sessionStorage.getItem("token"),window.location.href=a,setTimeout(function(){t.exportLoading=!1,t.exportPerformanceVisible=!1,t.$refs[e].resetFields()},2e3)}})}},beforeMount:function(){this.searchEmployee("search")}},Mt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Employee"},[o("el-form",{ref:"employeeSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.employeeSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchEmployee("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.employeeSearch.content,callback:function(t){e.$set(e.employeeSearch,"content","string"==typeof t?t.trim():t)},expression:"employeeSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchEmployee("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/employee/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1),e._v(" "),o("el-button",{attrs:{icon:"el-icon-download"},on:{click:function(t){e.exportPerformanceVisible=!0}}},[e._v("导出员工积分")])],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"gender",label:"性别"}}),e._v(" "),o("el-table-column",{attrs:{prop:"mobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"entryTime",label:"入职日期",formatter:e.toDate}}),e._v(" "),o("el-table-column",{attrs:{prop:"employeeWorkVos",label:"工种",formatter:e.toWorkType}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"导出员工积分",visible:e.exportPerformanceVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.exportPerformanceVisible=t}}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.exportLoading,expression:"exportLoading"}],ref:"exportPerformanceForm",attrs:{model:e.exportPerformanceForm}},[o("el-form-item",{attrs:{prop:"exportTime"}},[o("el-date-picker",{attrs:{type:"daterange",align:"center","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.exportPerformanceForm.exportTime,callback:function(t){e.$set(e.exportPerformanceForm,"exportTime",t)},expression:"exportPerformanceForm.exportTime"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("exportPerformanceForm")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onExport("exportPerformanceForm")}}},[e._v("导 出")])],1)],1)],1)},staticRenderFns:[]};var Nt=o("X4nt")(It,Mt,!1,function(e){o("Mq6A")},"data-v-67df6763",null).exports,Rt={name:"EmployeeNew",data:function(){return{newEmployeeForm:{name:"",gender:"",mobile:"",entryTime:"",workTypes:[],remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],workTypes:[{name:"美容师",value:1},{name:"美甲师",value:2},{name:"美睫师",value:3},{name:"美容咨询师",value:4},{name:"总监",value:5},{name:"实习美容师",value:6},{name:"实习咨询师",value:7}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"blur"},{type:"number",message:"性别必须是数字",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的手机",trigger:"blur"}],entryTime:[{required:!0,message:"入职日期不能为空",trigger:"blur"}],workTypes:[{required:!0,message:"工种不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addEmployee",{name:t.newEmployeeForm.name,gender:t.newEmployeeForm.gender,mobile:t.newEmployeeForm.mobile,entryTime:t.toTimeStamp(t.newEmployeeForm.entryTime),workTypes:t.newEmployeeForm.workTypes,remark:t.newEmployeeForm.remark}).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/employee"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},Dt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"EmployeeNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/employee"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建员工")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newEmployeeForm",staticClass:"new-form",attrs:{model:e.newEmployeeForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newEmployeeForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newEmployeeForm.name,callback:function(t){e.$set(e.newEmployeeForm,"name","string"==typeof t?t.trim():t)},expression:"newEmployeeForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.newEmployeeForm.gender,callback:function(t){e.$set(e.newEmployeeForm,"gender",e._n(t))},expression:"newEmployeeForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{attrs:{placeholder:"请输入手机"},model:{value:e.newEmployeeForm.mobile,callback:function(t){e.$set(e.newEmployeeForm,"mobile",e._n(t))},expression:"newEmployeeForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"入职日期",prop:"entryTime"}},[o("el-date-picker",{attrs:{align:"center",type:"date",editable:!1,placeholder:"选择日期"},model:{value:e.newEmployeeForm.entryTime,callback:function(t){e.$set(e.newEmployeeForm,"entryTime",t)},expression:"newEmployeeForm.entryTime"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"工种",prop:"workTypes"}},[o("el-checkbox-group",{model:{value:e.newEmployeeForm.workTypes,callback:function(t){e.$set(e.newEmployeeForm,"workTypes",t)},expression:"newEmployeeForm.workTypes"}},e._l(e.workTypes,function(t){return o("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.name))])}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newEmployeeForm.remark,callback:function(t){e.$set(e.newEmployeeForm,"remark","string"==typeof t?t.trim():t)},expression:"newEmployeeForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newEmployeeForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var zt=o("X4nt")(Rt,Dt,!1,function(e){o("WtgE")},"data-v-6eafbe34",null).exports,Et={name:"EmployeeDetail",data:function(){return{modEmployeeForm:{id:"",name:"",gender:"",mobile:"",entryTime:"",workTypes:[],remark:""},genders:[{label:"男",value:1},{label:"女",value:0}],workTypes:[{name:"美容师",value:1},{name:"美甲师",value:2},{name:"美睫师",value:3},{name:"美容咨询师",value:4},{name:"总监",value:5},{name:"实习美容师",value:6},{name:"实习咨询师",value:7}],rules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],gender:[{required:!0,message:"性别不能为空",trigger:"blur"},{type:"number",message:"性别必须是数字",trigger:"blur"}],mobile:[{required:!0,message:"手机不能为空",trigger:"blur"},{type:"number",message:"请输入正确的手机",trigger:"blur"}],entryTime:[{required:!0,message:"入职日期不能为空",trigger:"blur"}],workTypes:[{required:!0,message:"工种不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modEmployee",{id:t.modEmployeeForm.id,name:t.modEmployeeForm.name,gender:t.modEmployeeForm.gender,mobile:t.modEmployeeForm.mobile,entryTime:t.toTimeStamp(t.modEmployeeForm.entryTime),workTypes:t.modEmployeeForm.workTypes,remark:t.modEmployeeForm.remark}).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/employee"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.employee.employees.length)this.$router.push({path:"/employee"});else{var e=this.$store.getters.getEmployeeById(this.$route.params.id);this.modEmployeeForm.id=e.id,this.modEmployeeForm.name=e.name,this.modEmployeeForm.gender="男"===e.gender?1:0,this.modEmployeeForm.mobile=Y()(e.mobile),this.modEmployeeForm.entryTime=this.toDateObject(e.entryTime);var t=!0,o=!1,n=void 0;try{for(var r,a=k()(e.employeeWorkVos);!(t=(r=a.next()).done);t=!0){var i=r.value;this.modEmployeeForm.workTypes.push(Y()(i.workType))}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}this.modEmployeeForm.remark=e.remark}}},Bt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"EmployeeDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/employee"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑员工")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modEmployeeForm",staticClass:"new-form",attrs:{model:e.modEmployeeForm,"label-width":"80px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modEmployeeForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modEmployeeForm.name,callback:function(t){e.$set(e.modEmployeeForm,"name","string"==typeof t?t.trim():t)},expression:"modEmployeeForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"gender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.modEmployeeForm.gender,callback:function(t){e.$set(e.modEmployeeForm,"gender",e._n(t))},expression:"modEmployeeForm.gender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[o("el-input",{attrs:{placeholder:"请输入手机"},model:{value:e.modEmployeeForm.mobile,callback:function(t){e.$set(e.modEmployeeForm,"mobile",e._n(t))},expression:"modEmployeeForm.mobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"入职日期",prop:"entryTime"}},[o("el-date-picker",{attrs:{align:"center",type:"date",editable:!1,placeholder:"选择日期"},model:{value:e.modEmployeeForm.entryTime,callback:function(t){e.$set(e.modEmployeeForm,"entryTime",t)},expression:"modEmployeeForm.entryTime"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"工种",prop:"workTypes"}},[o("el-checkbox-group",{model:{value:e.modEmployeeForm.workTypes,callback:function(t){e.$set(e.modEmployeeForm,"workTypes",t)},expression:"modEmployeeForm.workTypes"}},e._l(e.workTypes,function(t){return o("el-checkbox",{key:t.value,attrs:{label:t.value}},[e._v(e._s(t.name))])}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modEmployeeForm.remark,callback:function(t){e.$set(e.modEmployeeForm,"remark","string"==typeof t?t.trim():t)},expression:"modEmployeeForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modEmployeeForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Wt=o("X4nt")(Et,Bt,!1,function(e){o("HhC7")},"data-v-154d9cdc",null).exports,qt={name:"ProjectType",data:function(){return{projectTypeSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.projectType.pageNum},pageSize:function(){return this.$store.state.projectType.pageSize},totalCount:function(){return this.$store.state.projectType.totalCount},totalPages:function(){return this.$store.state.projectType.totalPages},tableData:function(){return this.$store.state.projectType.projectTypes}},methods:{searchProjectType:function(e){var t=this;this.loading=!0,"search"===e&&(this.projectTypeSearch.oldContent=this.projectTypeSearch.content),this.projectTypeSearch.type=e,this.$store.dispatch("loadProjectType",this.projectTypeSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.projectTypeSearch.pageNum=e,this.searchProjectType("page")},handleEdit:function(e,t){this.$router.push({path:"/project-type/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delProjectType",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchProjectType("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchProjectType("search")}},Ot={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProjectType"},[o("el-form",{ref:"projectTypeSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.projectTypeSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchProjectType("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.projectTypeSearch.content,callback:function(t){e.$set(e.projectTypeSearch,"content","string"==typeof t?t.trim():t)},expression:"projectTypeSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchProjectType("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/project-type/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"topTypeDesc",label:"顶层分类"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var Vt=o("X4nt")(qt,Ot,!1,function(e){o("2tp7")},"data-v-71a4dcc0",null).exports,Lt={name:"ProjectTypeNew",data:function(){return{newProjectTypeForm:{name:"",topType:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],topType:[{required:!0,message:"顶层分类不能为空",trigger:"blur"},{type:"number",message:"顶层分类必须是数字",trigger:"blur"}]},topTypes:[{name:"美容",value:1},{name:"美甲",value:2},{name:"美睫",value:3}],loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addProjectType",t.newProjectTypeForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/project-type"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},Xt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProjectTypeNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/project-type"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建美容项目分类")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newProjectTypeForm",staticClass:"new-form",attrs:{model:e.newProjectTypeForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newProjectTypeForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newProjectTypeForm.name,callback:function(t){e.$set(e.newProjectTypeForm,"name","string"==typeof t?t.trim():t)},expression:"newProjectTypeForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属顶层分类",prop:"topType"}},[o("el-select",{attrs:{placeholder:"请选择顶层分类"},model:{value:e.newProjectTypeForm.topType,callback:function(t){e.$set(e.newProjectTypeForm,"topType",e._n(t))},expression:"newProjectTypeForm.topType"}},e._l(e.topTypes,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newProjectTypeForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Gt=o("X4nt")(Lt,Xt,!1,function(e){o("u778")},"data-v-14eb40bf",null).exports,Ut={name:"ProjectTypeDetail",data:function(){return{modProjectTypeForm:{id:"",name:"",topType:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],topType:[{required:!0,message:"顶层分类不能为空",trigger:"blur"},{type:"number",message:"顶层分类必须是数字",trigger:"blur"}]},topTypes:[{name:"美容",value:1},{name:"美甲",value:2},{name:"美睫",value:3}],loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modProjectType",t.modProjectTypeForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/project-type"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.projectType.projectTypes.length)this.$router.push({path:"/project-type"});else{var e=this.$store.getters.getProjectTypeById(this.$route.params.id);this.modProjectTypeForm.id=e.id,this.modProjectTypeForm.name=e.name,this.modProjectTypeForm.topType=e.topType}}},Ht={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProjectTypeDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/project-type"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("编辑库存")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modProjectTypeForm",staticClass:"new-form",attrs:{model:e.modProjectTypeForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modProjectTypeForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modProjectTypeForm.name,callback:function(t){e.$set(e.modProjectTypeForm,"name","string"==typeof t?t.trim():t)},expression:"modProjectTypeForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"所属顶层分类",prop:"topType"}},[o("el-select",{attrs:{placeholder:"请选择顶层分类"},model:{value:e.modProjectTypeForm.topType,callback:function(t){e.$set(e.modProjectTypeForm,"topType",e._n(t))},expression:"modProjectTypeForm.topType"}},e._l(e.topTypes,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modProjectTypeForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Yt=o("X4nt")(Ut,Ht,!1,function(e){o("Sj/F")},"data-v-9be4ad52",null).exports,Jt={name:"Project",data:function(){return{projectSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.project.pageNum},pageSize:function(){return this.$store.state.project.pageSize},totalCount:function(){return this.$store.state.project.totalCount},totalPages:function(){return this.$store.state.project.totalPages},tableData:function(){return this.$store.state.project.projects}},methods:{searchProject:function(e){var t=this;this.loading=!0,"search"===e&&(this.projectSearch.oldContent=this.projectSearch.content),this.projectSearch.type=e,this.$store.dispatch("loadProject",this.projectSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.projectSearch.pageNum=e,this.searchProject("page")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleProjectStocks:function(e,t){if(e.projectStockVos&&""!==e.projectStockVos){var o="",n=!0,r=!1,a=void 0;try{for(var i,s=k()(e.projectStockVos);!(n=(i=s.next()).done);n=!0){var l=i.value;o+=l.stockName+":"+l.stockConsumptionAmount+l.unitName+"<br />"}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o}return"暂无消耗品"},handleEdit:function(e,t){this.$router.push({path:"/project/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delProject",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchProject("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchProject("search")}},Qt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Project"},[o("el-form",{ref:"projectSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.projectSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchProject("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.projectSearch.content,callback:function(t){e.$set(e.projectSearch,"content","string"==typeof t?t.trim():t)},expression:"projectSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchProject("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/project/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"code",label:"代码"}}),e._v(" "),o("el-table-column",{attrs:{prop:"projectTypeName",label:"美容项目分类"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitPrice",label:"单价"}}),e._v(" "),o("el-table-column",{attrs:{prop:"integral",label:"积分"}}),e._v(" "),o("el-table-column",{attrs:{prop:"internIntegral",label:"实习生积分"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{prop:"projectStockVos",label:"项目消耗品"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.projectStockVos,function(t){return o("div",{key:t.stockId},[e._v("\n            "+e._s(t.stockName+" : "+t.stockConsumptionAmount+t.unitName)+"\n          ")])})}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var Zt=o("X4nt")(Jt,Qt,!1,function(e){o("DXYT")},"data-v-78a9389d",null).exports,Kt={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProjectStock"},[o("el-dialog",{attrs:{title:"项目消耗品",visible:e.isVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[o("el-form",{ref:"projectStockParams",attrs:{model:e.projectStockParams,rules:e.rules}},[o("el-form-item",{attrs:{prop:"stockId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入关键词"},model:{value:e.projectStockParams.stockId,callback:function(t){e.$set(e.projectStockParams,"stockId",e._n(t))},expression:"projectStockParams.stockId"}},e._l(e.stocks,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name+"("+e.unitName+")",value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{prop:"stockConsumptionAmount"}},[o("el-input",{attrs:{placeholder:"请输入数量"},model:{value:e.projectStockParams.stockConsumptionAmount,callback:function(t){e.$set(e.projectStockParams,"stockConsumptionAmount",e._n(t))},expression:"projectStockParams.stockConsumptionAmount"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("projectStockParams")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("projectStockParams")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var eo=o("X4nt")({name:"ProjectStock",props:["visible"],data:function(){return{projectStockParams:{stockId:"",stockConsumptionAmount:""},rules:{stockId:[{required:!0,message:"库存不能为空",trigger:"blur"},{type:"number",message:"库存必须是数字",trigger:"blur"}],stockConsumptionAmount:[{required:!0,message:"数量不能为空",trigger:"blur"},{type:"number",message:"数量必须是数字",trigger:"blur"}]}}},computed:{isVisible:function(){return this.visible},stocks:function(){return this.$store.state.stock.stocksAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.$emit("addProjectStock",t.projectStockParams),t.$emit("closeDialog",!1),t.$refs[e].resetFields()})},onClose:function(e){this.$emit("closeDialog",!1),this.$refs[e].resetFields()}}},Kt,!1,function(e){o("DM0O")},"data-v-83b03e9c",null).exports,to={name:"ProjectNew",data:function(){return{newProjectForm:{name:"",code:"",projectTypeId:"",unitPrice:"",integral:"",internIntegral:"",remark:"",projectStockParams:[]},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],projectTypeId:[{required:!0,message:"美容项目分类不能为空",trigger:"blur"},{type:"number",message:"美容项目分类必须是数字",trigger:"blur"}],unitPrice:[{required:!0,message:"单价不能为空",trigger:"blur"},{type:"number",message:"单价必须是数字",trigger:"blur"}],integral:[{required:!0,message:"积分不能为空",trigger:"blur"},{type:"number",message:"积分必须是数字",trigger:"blur"}],internIntegral:[{required:!0,message:"实习生积分不能为空",trigger:"blur"},{type:"number",message:"实习生积分必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0,projectStockParamsDialog:!1,projectStocks:[]}},computed:{projectTypes:function(){return this.$store.state.projectType.projectTypesAll},stocks:function(){return this.$store.state.stock.stocksAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addProject",t.newProjectForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/project"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleAddProjectStock:function(e){var t=this.$store.getters.getStockAllById(e.stockId);this.projectStocks.push({id:t.id,name:t.name,amount:e.stockConsumptionAmount,unitName:t.unitName}),this.newProjectForm.projectStockParams.push({stockId:e.stockId,stockConsumptionAmount:e.stockConsumptionAmount})},handleDelete:function(e,t){console.log(t.id);var o=this.projectStocks.findIndex(function(e,o,n){return e.id===t.id});this.projectStocks.splice(o,1),this.newProjectForm.projectStockParams.splice(o,1)},loadProjectTypeAll:function(){var e=this;this.$store.dispatch("loadProjectTypeAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})},loadStockAll:function(){var e=this;this.$store.dispatch("loadStockAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadStockAll(),this.loadProjectTypeAll()},components:{ProjectStock:eo}},oo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProjectNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/project"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建美容项目")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newProjectForm",staticClass:"new-form",attrs:{model:e.newProjectForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newProjectForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.newProjectForm.name,callback:function(t){e.$set(e.newProjectForm,"name","string"==typeof t?t.trim():t)},expression:"newProjectForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入代码"},model:{value:e.newProjectForm.code,callback:function(t){e.$set(e.newProjectForm,"code","string"==typeof t?t.trim():t)},expression:"newProjectForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"美容项目分类",prop:"projectTypeId"}},[o("el-select",{attrs:{placeholder:"请选择美容项目分类"},model:{value:e.newProjectForm.projectTypeId,callback:function(t){e.$set(e.newProjectForm,"projectTypeId",e._n(t))},expression:"newProjectForm.projectTypeId"}},e._l(e.projectTypes,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"单价",prop:"unitPrice"}},[o("el-input",{attrs:{placeholder:"请输入单价"},model:{value:e.newProjectForm.unitPrice,callback:function(t){e.$set(e.newProjectForm,"unitPrice",e._n(t))},expression:"newProjectForm.unitPrice"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"积分",prop:"integral"}},[o("el-input",{attrs:{placeholder:"请输入积分"},model:{value:e.newProjectForm.integral,callback:function(t){e.$set(e.newProjectForm,"integral",e._n(t))},expression:"newProjectForm.integral"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"实习生积分",prop:"internIntegral"}},[o("el-input",{attrs:{placeholder:"请输入实习生积分"},model:{value:e.newProjectForm.internIntegral,callback:function(t){e.$set(e.newProjectForm,"internIntegral",e._n(t))},expression:"newProjectForm.internIntegral"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newProjectForm.remark,callback:function(t){e.$set(e.newProjectForm,"remark","string"==typeof t?t.trim():t)},expression:"newProjectForm.remark"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"项目消耗品"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.projectStocks,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"库存"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitName",label:"单位"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.projectStockParamsDialog=!0}}},[e._v("添加项目消耗品")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newProjectForm")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("ProjectStock",{attrs:{visible:e.projectStockParamsDialog},on:{closeDialog:function(t){e.projectStockParamsDialog=!1},addProjectStock:e.handleAddProjectStock}})],1)},staticRenderFns:[]};var no=o("X4nt")(to,oo,!1,function(e){o("AJkg")},"data-v-76bd35f4",null).exports,ro={name:"ProjectDetail",data:function(){return{modProjectForm:{id:"",name:"",code:"",projectTypeId:"",unitPrice:"",integral:"",internIntegral:"",remark:"",projectStockParams:[]},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],projectTypeId:[{required:!0,message:"美容项目分类不能为空",trigger:"blur"},{type:"number",message:"美容项目分类必须是数字",trigger:"blur"}],unitPrice:[{required:!0,message:"单价不能为空",trigger:"blur"},{type:"number",message:"单价必须是数字",trigger:"blur"}],integral:[{required:!0,message:"积分不能为空",trigger:"blur"},{type:"number",message:"积分必须是数字",trigger:"blur"}],internIntegral:[{required:!0,message:"实习生积分不能为空",trigger:"blur"},{type:"number",message:"实习生积分必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0,projectStockParamsDialog:!1,projectStocks:[]}},computed:{projectTypes:function(){return this.$store.state.projectType.projectTypesAll},stocks:function(){return this.$store.state.stock.stocksAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modProject",t.modProjectForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/project"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleAddProjectStock:function(e){var t=this.$store.getters.getStockAllById(e.stockId);this.projectStocks.push({id:t.id,name:t.name,amount:e.stockConsumptionAmount,unitName:t.unitName}),this.modProjectForm.projectStockParams.push({stockId:e.stockId,stockConsumptionAmount:e.stockConsumptionAmount})},handleDelete:function(e,t){console.log(t.id);var o=this.projectStocks.findIndex(function(e,o,n){return e.id===t.id});this.projectStocks.splice(o,1),this.modProjectForm.projectStockParams.splice(o,1)},loadProjectTypeAll:function(){var e=this;this.$store.dispatch("loadProjectTypeAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})},loadStockAll:function(){var e=this;this.$store.dispatch("loadStockAll").then(function(t){e.loading=!1;var o=!0,n=!1,r=void 0;try{for(var a,i=k()(e.modProjectForm.projectStockParams);!(o=(a=i.next()).done);o=!0){var s=a.value,l=e.$store.getters.getStockAllById(s.stockId);console.log(e.projectStocks),e.projectStocks.push({id:l.id,name:l.name,amount:s.stockConsumptionAmount,unitName:l.unitName})}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.project.projects.length)this.$router.push({path:"/project"});else{this.loadStockAll(),this.loadProjectTypeAll();var e=this.$store.getters.getProjectById(this.$route.params.id);this.modProjectForm.id=e.id,this.modProjectForm.name=e.name,this.modProjectForm.code=e.code,this.modProjectForm.projectTypeId=e.projectTypeId,this.modProjectForm.unitPrice=e.unitPrice,this.modProjectForm.integral=e.integral,this.modProjectForm.internIntegral=e.internIntegral,this.modProjectForm.remark=e.remark;var t=!0,o=!1,n=void 0;try{for(var r,a=k()(e.projectStockVos);!(t=(r=a.next()).done);t=!0){var i=r.value;this.modProjectForm.projectStockParams.push({stockId:i.stockId,stockConsumptionAmount:i.stockConsumptionAmount})}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}},components:{ProjectStock:eo}},ao={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ProjectDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/project"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("修改美容项目")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modProjectForm",staticClass:"new-form",attrs:{model:e.modProjectForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modProjectForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.modProjectForm.name,callback:function(t){e.$set(e.modProjectForm,"name","string"==typeof t?t.trim():t)},expression:"modProjectForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入代码"},model:{value:e.modProjectForm.code,callback:function(t){e.$set(e.modProjectForm,"code","string"==typeof t?t.trim():t)},expression:"modProjectForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"美容项目分类",prop:"projectTypeId"}},[o("el-select",{attrs:{placeholder:"请选择美容项目分类"},model:{value:e.modProjectForm.projectTypeId,callback:function(t){e.$set(e.modProjectForm,"projectTypeId",e._n(t))},expression:"modProjectForm.projectTypeId"}},e._l(e.projectTypes,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"单价",prop:"unitPrice"}},[o("el-input",{attrs:{placeholder:"请输入单价"},model:{value:e.modProjectForm.unitPrice,callback:function(t){e.$set(e.modProjectForm,"unitPrice",e._n(t))},expression:"modProjectForm.unitPrice"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"积分",prop:"integral"}},[o("el-input",{attrs:{placeholder:"请输入积分"},model:{value:e.modProjectForm.integral,callback:function(t){e.$set(e.modProjectForm,"integral",e._n(t))},expression:"modProjectForm.integral"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"实习生积分",prop:"internIntegral"}},[o("el-input",{attrs:{placeholder:"请输入实习生积分"},model:{value:e.modProjectForm.internIntegral,callback:function(t){e.$set(e.modProjectForm,"internIntegral",e._n(t))},expression:"modProjectForm.internIntegral"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modProjectForm.remark,callback:function(t){e.$set(e.modProjectForm,"remark","string"==typeof t?t.trim():t)},expression:"modProjectForm.remark"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"项目消耗品"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.projectStocks,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"库存"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitName",label:"单位"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.projectStockParamsDialog=!0}}},[e._v("添加项目消耗品")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modProjectForm")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("ProjectStock",{attrs:{visible:e.projectStockParamsDialog},on:{closeDialog:function(t){e.projectStockParamsDialog=!1},addProjectStock:e.handleAddProjectStock}})],1)},staticRenderFns:[]};var io=o("X4nt")(ro,ao,!1,function(e){o("X1Pg")},"data-v-07a3c563",null).exports,so={name:"MemberCard",data:function(){return{memberCardSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.memberCard.pageNum},pageSize:function(){return this.$store.state.memberCard.pageSize},totalCount:function(){return this.$store.state.memberCard.totalCount},totalPages:function(){return this.$store.state.memberCard.totalPages},tableData:function(){return this.$store.state.memberCard.memberCards}},methods:{searchMemberCard:function(e){var t=this;this.loading=!0,"search"===e&&(this.memberCardSearch.oldContent=this.memberCardSearch.content),this.memberCardSearch.type=e,this.$store.dispatch("loadMemberCard",this.memberCardSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.memberCardSearch.pageNum=e,this.searchMemberCard("page")},handleProject:function(e,t){return e.project&&""!==e.project?e.project:"暂无项目"},handleTimes:function(e,t){return e.times&&""!==e.times?e.times:"暂无次数"},handleAmount:function(e,t){return e.amount&&""!==e.amount?"￥"+e.amount:"暂无储值"},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){this.$router.push({path:"/member-card/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久删除该记录！ ")]),showCancelButton:!0,confirmButtonText:"删除",cancelButtonText:"取消",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="删除中...",o.$store.dispatch("delMemberCard",t.id).then(function(e){r(),n.confirmButtonLoading=!1,o.searchMemberCard("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消删除"})})}},beforeMount:function(){this.searchMemberCard("search")}},lo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"MemberCard"},[o("el-form",{ref:"memberCardSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.memberCardSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchMemberCard("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.memberCardSearch.content,callback:function(t){e.$set(e.memberCardSearch,"content","string"==typeof t?t.trim():t)},expression:"memberCardSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchMemberCard("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/member-card/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"code",label:"代码"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"price",label:"价格"}}),e._v(" "),o("el-table-column",{attrs:{prop:"typeDesc",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"projectName",label:"美容项目名称",formatter:e.handleProject}}),e._v(" "),o("el-table-column",{attrs:{prop:"times",label:"次数",formatter:e.handleTimes}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"储值",formatter:e.handleAmount}}),e._v(" "),o("el-table-column",{attrs:{prop:"projectDiscount",label:"项目折扣"}}),e._v(" "),o("el-table-column",{attrs:{prop:"productDiscount",label:"产品折扣"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{prop:"status",label:"状态"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"250",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var co=o("X4nt")(so,lo,!1,function(e){o("6I//")},"data-v-1d5b1b88",null).exports,uo={name:"MemberCardNew",data:function(){return{newMemberCardForm:{name:"",code:"",price:"",type:"",projectId:"",times:"",amount:"",projectDiscount:"",productDiscount:"",remark:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],price:[{required:!0,message:"价格不能为空",trigger:"blur"},{type:"number",message:"价格必须是数字",trigger:"blur"}],type:[{required:!0,message:"类别不能为空",trigger:"blur"},{type:"number",message:"类别必须是数字",trigger:"blur"}]},cardTypes:[{name:"次卡",value:1},{name:"储值卡",value:2},{name:"混合卡",value:3}],loading:!1,enterFlag:!0}},computed:{projects:function(){return this.$store.state.project.projectsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addMemberCard",t.newMemberCardForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/member-card"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleChangeType:function(e){1===e?this.newMemberCardForm.amount="":2===e&&(this.newMemberCardForm.times="",this.newMemberCardForm.projectId="")},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadProjectAll()}},mo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"MemberCardNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/member-card"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建会员卡")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newMemberCardForm",staticClass:"new-form",attrs:{model:e.newMemberCardForm,"label-width":"120px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newMemberCardForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,placeholder:"请输入名称"},model:{value:e.newMemberCardForm.name,callback:function(t){e.$set(e.newMemberCardForm,"name","string"==typeof t?t.trim():t)},expression:"newMemberCardForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入代码"},model:{value:e.newMemberCardForm.code,callback:function(t){e.$set(e.newMemberCardForm,"code","string"==typeof t?t.trim():t)},expression:"newMemberCardForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"价格",prop:"price"}},[o("el-input",{attrs:{placeholder:"请输入价格"},model:{value:e.newMemberCardForm.price,callback:function(t){e.$set(e.newMemberCardForm,"price",e._n(t))},expression:"newMemberCardForm.price"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"类型",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择类型"},on:{change:e.handleChangeType},model:{value:e.newMemberCardForm.type,callback:function(t){e.$set(e.newMemberCardForm,"type",e._n(t))},expression:"newMemberCardForm.type"}},e._l(e.cardTypes,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),1===e.newMemberCardForm.type||3===e.newMemberCardForm.type?o("el-form-item",{attrs:{label:"美容项目",prop:"projectId"}},[o("el-select",{attrs:{placeholder:"请选择美容项目"},model:{value:e.newMemberCardForm.projectId,callback:function(t){e.$set(e.newMemberCardForm,"projectId",e._n(t))},expression:"newMemberCardForm.projectId"}},e._l(e.projects,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1):e._e(),e._v(" "),1===e.newMemberCardForm.type||3===e.newMemberCardForm.type?o("el-form-item",{attrs:{label:"次数",prop:"times"}},[o("el-input",{attrs:{placeholder:"请输入次数"},model:{value:e.newMemberCardForm.times,callback:function(t){e.$set(e.newMemberCardForm,"times",e._n(t))},expression:"newMemberCardForm.times"}})],1):e._e(),e._v(" "),2===e.newMemberCardForm.type||3===e.newMemberCardForm.type?o("el-form-item",{attrs:{label:"储值卡总额",prop:"amount"}},[o("el-input",{attrs:{placeholder:"请输入总额"},model:{value:e.newMemberCardForm.amount,callback:function(t){e.$set(e.newMemberCardForm,"amount",e._n(t))},expression:"newMemberCardForm.amount"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"项目折扣(0-100)",prop:"projectDiscount"}},[o("el-input",{attrs:{placeholder:"请输入项目折扣"},model:{value:e.newMemberCardForm.projectDiscount,callback:function(t){e.$set(e.newMemberCardForm,"projectDiscount",e._n(t))},expression:"newMemberCardForm.projectDiscount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"产品折扣(0-100)",prop:"productDiscount"}},[o("el-input",{attrs:{placeholder:"请输入产品折扣"},model:{value:e.newMemberCardForm.productDiscount,callback:function(t){e.$set(e.newMemberCardForm,"productDiscount",e._n(t))},expression:"newMemberCardForm.productDiscount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newMemberCardForm.remark,callback:function(t){e.$set(e.newMemberCardForm,"remark","string"==typeof t?t.trim():t)},expression:"newMemberCardForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newMemberCardForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var po=o("X4nt")(uo,mo,!1,function(e){o("CpQk")},"data-v-2a0af965",null).exports,fo={name:"MemberCardDetail",data:function(){return{modMemberCardForm:{id:"",name:"",code:"",price:"",type:"",projectId:"",times:"",amount:"",projectDiscount:"",productDiscount:"",remark:""},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],price:[{required:!0,message:"价格不能为空",trigger:"blur"},{type:"number",message:"价格必须是数字",trigger:"blur"}],type:[{required:!0,message:"类别不能为空",trigger:"blur"},{type:"number",message:"类别必须是数字",trigger:"blur"}]},cardTypes:[{name:"次卡",value:1},{name:"储值卡",value:2},{name:"混合卡",value:3}],loading:!1,enterFlag:!0}},computed:{projects:function(){return this.$store.state.project.projectsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modMemberCard",t.modMemberCardForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/member-card"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleChangeType:function(e){1===e?this.modMemberCardForm.amount="":2===e&&(this.modMemberCardForm.times="",this.modMemberCardForm.projectId="")},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1,e.$message.success("查询成功")}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.memberCard.memberCards.length)this.$router.push({path:"/member-card"});else{this.loadProjectAll();var e=this.$store.getters.getMemberCardById(this.$route.params.id);this.modMemberCardForm.id=e.id,this.modMemberCardForm.name=e.name,this.modMemberCardForm.code=e.code,this.modMemberCardForm.price=e.price,this.modMemberCardForm.type=e.type,this.modMemberCardForm.projectId=e.projectId,this.modMemberCardForm.times=e.times,this.modMemberCardForm.amount=e.amount,this.modMemberCardForm.projectDiscount=e.projectDiscount,this.modMemberCardForm.productDiscount=e.productDiscount,this.modMemberCardForm.remark=project.remark}}},ho={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"MemberCardDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/member-card"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("修改会员卡")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modMemberCardForm",staticClass:"new-form",attrs:{model:e.modMemberCardForm,"label-width":"120px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modMemberCardForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{autofocus:!0,placeholder:"请输入名称"},model:{value:e.modMemberCardForm.name,callback:function(t){e.$set(e.modMemberCardForm,"name","string"==typeof t?t.trim():t)},expression:"modMemberCardForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入代码"},model:{value:e.modMemberCardForm.code,callback:function(t){e.$set(e.modMemberCardForm,"code","string"==typeof t?t.trim():t)},expression:"modMemberCardForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"价格",prop:"price"}},[o("el-input",{attrs:{placeholder:"请输入价格"},model:{value:e.modMemberCardForm.price,callback:function(t){e.$set(e.modMemberCardForm,"price",e._n(t))},expression:"modMemberCardForm.price"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"类型",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择类型"},on:{change:e.handleChangeType},model:{value:e.modMemberCardForm.type,callback:function(t){e.$set(e.modMemberCardForm,"type",e._n(t))},expression:"modMemberCardForm.type"}},e._l(e.cardTypes,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),1===e.modMemberCardForm.type||3===e.modMemberCardForm.type?o("el-form-item",{attrs:{label:"美容项目",prop:"projectId"}},[o("el-select",{attrs:{placeholder:"请选择美容项目"},model:{value:e.modMemberCardForm.projectId,callback:function(t){e.$set(e.modMemberCardForm,"projectId",e._n(t))},expression:"modMemberCardForm.projectId"}},e._l(e.projects,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1):e._e(),e._v(" "),1===e.modMemberCardForm.type||3===e.modMemberCardForm.type?o("el-form-item",{attrs:{label:"次数",prop:"times"}},[o("el-input",{attrs:{placeholder:"请输入次数"},model:{value:e.modMemberCardForm.times,callback:function(t){e.$set(e.modMemberCardForm,"times",e._n(t))},expression:"modMemberCardForm.times"}})],1):e._e(),e._v(" "),2===e.modMemberCardForm.type||3===e.modMemberCardForm.type?o("el-form-item",{attrs:{label:"储值卡总额",prop:"amount"}},[o("el-input",{attrs:{placeholder:"请输入总额"},model:{value:e.modMemberCardForm.amount,callback:function(t){e.$set(e.modMemberCardForm,"amount",e._n(t))},expression:"modMemberCardForm.amount"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"项目折扣(0-100)",prop:"projectDiscount"}},[o("el-input",{attrs:{placeholder:"请输入项目折扣"},model:{value:e.modMemberCardForm.projectDiscount,callback:function(t){e.$set(e.modMemberCardForm,"projectDiscount",e._n(t))},expression:"modMemberCardForm.projectDiscount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"产品折扣(0-100)",prop:"productDiscount"}},[o("el-input",{attrs:{placeholder:"请输入产品折扣"},model:{value:e.modMemberCardForm.productDiscount,callback:function(t){e.$set(e.modMemberCardForm,"productDiscount",e._n(t))},expression:"modMemberCardForm.productDiscount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modMemberCardForm.remark,callback:function(t){e.$set(e.modMemberCardForm,"remark","string"==typeof t?t.trim():t)},expression:"modMemberCardForm.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modMemberCardForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var go=o("X4nt")(fo,ho,!1,function(e){o("bkxU")},"data-v-32587e18",null).exports,vo={name:"CustomerCard",data:function(){return{customerCardSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},loading:!1,cardContentDetail:[],cardContentVisible:!1}},computed:{pageNum:function(){return this.$store.state.customerCard.pageNum},pageSize:function(){return this.$store.state.customerCard.pageSize},totalCount:function(){return this.$store.state.customerCard.totalCount},totalPages:function(){return this.$store.state.customerCard.totalPages},tableData:function(){return this.$store.state.customerCard.customerCards}},methods:{searchCustomerCard:function(e){var t=this;this.loading=!0,"search"===e&&(this.customerCardSearch.oldContent=this.customerCardSearch.content),this.customerCardSearch.type=e,this.$store.dispatch("loadCustomerCard",this.customerCardSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.customerCardSearch.pageNum=e,this.searchCustomerCard("page")},handleRemainMoney:function(e,t){return e.remainingMoney&&""!==e.remainingMoney?"￥"+e.remainingMoney:"暂无"},handleRemainTimes:function(e,t){return e.remainingTimes&&""!==e.remainingTimes?e.remainingTimes+"次":"暂无"},handleIsReturned:function(e,t){return e.isReturned&&""!==e.isReturned?e.isReturned:"否"},handleReturnedReason:function(e,t){return e.returnedReason&&""!==e.returnedReason?e.returnedReason:"暂无"},handlReturnedMoney:function(e,t){return e.returnedMoney&&""!==e.returnedMoney?"￥"+e.returnedMoney:"暂无"},handlProjectDiscount:function(e,t){return e.projectDiscount&&""!==e.projectDiscount?e.projectDiscount:"暂无"},handlProductDiscount:function(e,t){return e.productDiscount&&""!==e.productDiscount?e.productDiscount:"暂无"},handlIsTurned:function(e,t){return e.isTurned&&""!==e.isTurned?e.isTurned:"暂无"},handlTurnedReason:function(e,t){return e.turnedReason&&""!==e.turnedReason?e.turnedReason:"暂无"},handlTurnedMoney:function(e,t){return e.turnedMoney&&""!==e.turnedMoney?"￥"+e.turnedMoney:"暂无"},handleCharge:function(e,t){this.$router.push({path:"/customer-card-charge/"+t.id})},handleBuy:function(e,t){this.$router.push({path:"/customer-card-buy/"+t.id})},handleTurn:function(e,t){this.$router.push({path:"/customer-card-turn/"+t.id})},handleCardContentDetail:function(e,t){var o=this.$store.getters.getCustomerCardById(t.id),n=!0,r=!1,a=void 0;try{for(var i,s=k()(o.customerMemberCardContent);!(n=(i=s.next()).done);n=!0){var l=i.value;l.relatedName?this.cardContentDetail.push({type:"项目",name:l.relatedName,amount:l.amount}):this.cardContentDetail.push({type:"代金券",name:l.content,amount:l.amount})}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}this.cardContentVisible=!0},handleChangeStore:function(e,t){this.$router.push({path:"/customer-card-change-store/"+t.id})},handleReturn:function(e,t){this.$router.push({path:"/customer-card-return/"+t.id})},onClose:function(e){this.cardContentVisible=!1,this.cardContentDetail=[]}},beforeMount:function(){this.searchCustomerCard("search")}},yo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerCard"},[o("el-form",{ref:"customerCardSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.customerCardSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchCustomerCard("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.customerCardSearch.content,callback:function(t){e.$set(e.customerCardSearch,"content","string"==typeof t?t.trim():t)},expression:"customerCardSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchCustomerCard("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"memberCardName",label:"卡名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remainingMoney",label:"余额",formatter:e.handleRemainMoney}}),e._v(" "),o("el-table-column",{attrs:{prop:"isValid",label:"是否有效"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isReturned",label:"是否退卡",formatter:e.handleIsReturned}}),e._v(" "),o("el-table-column",{attrs:{prop:"returnedReason",label:"退卡原因",formatter:e.handleReturnedReason}}),e._v(" "),o("el-table-column",{attrs:{prop:"returnedMoney",label:"退卡金额",formatter:e.handlReturnedMoney}}),e._v(" "),o("el-table-column",{attrs:{prop:"projectDiscount",label:"项目折扣",formatter:e.handlProjectDiscount}}),e._v(" "),o("el-table-column",{attrs:{prop:"productDiscount",label:"产品折扣",formatter:e.handlProductDiscount}}),e._v(" "),o("el-table-column",{attrs:{prop:"isTurned",label:"是否换卡",formatter:e.handlIsTurned}}),e._v(" "),o("el-table-column",{attrs:{prop:"turnedReason",label:"换卡原因",formatter:e.handlTurnedReason}}),e._v(" "),o("el-table-column",{attrs:{prop:"turnedMoney",label:"补/退金额",formatter:e.handlTurnedMoney}}),e._v(" "),o("el-table-column",{attrs:{prop:"uniqueIdentifier",width:"150",label:"流水号"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"450",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleCardContentDetail(t.$index,t.row)}}},[e._v("详情")]),e._v(" "),"是"===t.row.isValid?o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleCharge(t.$index,t.row)}}},[e._v("充值")]):e._e(),e._v(" "),"是"===t.row.isValid?o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleBuy(t.$index,t.row)}}},[e._v("换疗程")]):e._e(),e._v(" "),"是"===t.row.isValid?o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleTurn(t.$index,t.row)}}},[e._v("转卡")]):e._e(),e._v(" "),"是"===t.row.isValid?o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleChangeStore(t.$index,t.row)}}},[e._v("转店")]):e._e(),e._v(" "),"是"===t.row.isValid?o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleReturn(t.$index,t.row)}}},[e._v("退卡")]):e._e()]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"会员卡内容详情",visible:e.cardContentVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.cardContentVisible=t}}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.cardContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"个数"}})],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onClose("")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var bo=o("X4nt")(vo,yo,!1,function(e){o("wGCe")},"data-v-174a1c85",null).exports,Co={name:"CustomerCardCharge",data:function(){return{chargeCustomerCardForm:{cardId:"",rechargeMoney:""},rules:{rechargeMoney:[{required:!0,message:"充值金额不能为空",trigger:"blur"},{type:"number",message:"充值金额必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("chargeCustomerCard",t.chargeCustomerCardForm).then(function(e){0===e.code&&(t.$message.success("充值成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/customer-card"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.customerCard.customerCards.length)this.$router.push({path:"/customer-card"});else{var e=this.$store.getters.getCustomerCardById(this.$route.params.id);this.chargeCustomerCardForm.cardId=e.id}}},_o={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerCardCharge"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/customer-card"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("充值")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"chargeCustomerCardForm",staticClass:"new-form",attrs:{model:e.chargeCustomerCardForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("chargeCustomerCardForm")}}},[o("el-form-item",{attrs:{label:"充值金额(元)",prop:"rechargeMoney"}},[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{model:{value:e.chargeCustomerCardForm.rechargeMoney,callback:function(t){e.$set(e.chargeCustomerCardForm,"rechargeMoney",e._n(t))},expression:"chargeCustomerCardForm.rechargeMoney"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("chargeCustomerCardForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ko=o("X4nt")(Co,_o,!1,function(e){o("RPQI")},"data-v-24169069",null).exports,wo={name:"CustomerCardBuy",data:function(){return{buyCustomerCardForm:{cardId:"",projectId:"",projectTimes:1,useRemainMoney:""},rules:{projectId:[{required:!0,message:"项目不能为空",trigger:"blur"},{type:"number",message:"项目必须是数字",trigger:"blur"}],projectTimes:[{required:!0,message:"次数不能为空",trigger:"blur"},{type:"number",message:"次数必须是数字",trigger:"blur"}],useRemainMoney:[{required:!0,message:"使用储值不能为空",trigger:"blur"},{type:"number",message:"使用储值必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0,project:"",projectTimes:1}},computed:{projects:function(){return this.$store.state.project.projectsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("buyCustomerCard",t.buyCustomerCardForm).then(function(e){0===e.code&&(t.$message.success("购买成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/customer-card"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleTimesChange:function(e){this.buyCustomerCardForm.projectTimes=e,this.buyCustomerCardForm.useRemainMoney=this.project.unitPrice*this.buyCustomerCardForm.projectTimes},handleProjectChange:function(e){this.project=this.$store.getters.getProjectFromAllById(e),this.buyCustomerCardForm.useRemainMoney=this.project.unitPrice*this.buyCustomerCardForm.projectTimes},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.customerCard.customerCards.length)this.$router.push({path:"/customer-card"});else{this.loadProjectAll();var e=this.$store.getters.getCustomerCardById(this.$route.params.id);this.buyCustomerCardForm.cardId=e.id}}},Po={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerCardBuy"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/customer-card"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("储值换疗程")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"buyCustomerCardForm",staticClass:"new-form",attrs:{model:e.buyCustomerCardForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("buyCustomerCardForm")}}},[o("el-form-item",{attrs:{label:"项目",prop:"projectId"}},[o("el-select",{attrs:{placeholder:"请选择项目",filterable:""},on:{change:e.handleProjectChange},model:{value:e.buyCustomerCardForm.projectId,callback:function(t){e.$set(e.buyCustomerCardForm,"projectId",e._n(t))},expression:"buyCustomerCardForm.projectId"}},e._l(e.projects,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"次数",prop:"projectTimes"}},[o("el-input-number",{attrs:{"controls-position":"right",min:1,disabled:""===e.buyCustomerCardForm.projectId},on:{change:e.handleTimesChange},model:{value:e.projectTimes,callback:function(t){e.projectTimes=e._n(t)},expression:"projectTimes"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"使用储值",prop:"useRemainMoney"}},[o("el-input",{model:{value:e.buyCustomerCardForm.useRemainMoney,callback:function(t){e.$set(e.buyCustomerCardForm,"useRemainMoney",e._n(t))},expression:"buyCustomerCardForm.useRemainMoney"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("buyCustomerCardForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Fo=o("X4nt")(wo,Po,!1,function(e){o("tc4L")},"data-v-23645074",null).exports,So={name:"CustomerCardReturn",data:function(){return{returnCustomerCardForm:{id:"",returnedReason:"",returnedMoney:""},rules:{returnedMoney:[{required:!0,message:"退卡金额不能为空",trigger:"blur"},{type:"number",message:"退卡金额必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("returnCustomerCard",t.returnCustomerCardForm).then(function(e){0===e.code&&(t.$message.success("退卡成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/customer-card"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}},beforeMount:function(){if(0===this.$store.state.customerCard.customerCards.length)this.$router.push({path:"/customer-card"});else{var e=this.$store.getters.getCustomerCardById(this.$route.params.id);this.returnCustomerCardForm.id=e.id}}},$o={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerCardReturn"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/customer-card"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("退卡")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"returnCustomerCardForm",staticClass:"new-form",attrs:{model:e.returnCustomerCardForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("returnCustomerCardForm")}}},[o("el-form-item",{attrs:{label:"退卡原因",prop:"returnedReason"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.returnCustomerCardForm.returnedReason,callback:function(t){e.$set(e.returnCustomerCardForm,"returnedReason","string"==typeof t?t.trim():t)},expression:"returnCustomerCardForm.returnedReason"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"退卡金额(元)",prop:"returnedMoney"}},[o("el-input",{model:{value:e.returnCustomerCardForm.returnedMoney,callback:function(t){e.$set(e.returnCustomerCardForm,"returnedMoney",e._n(t))},expression:"returnCustomerCardForm.returnedMoney"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("returnCustomerCardForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var xo=o("X4nt")(So,$o,!1,function(e){o("fAog")},"data-v-db7fd630",null).exports,jo={name:"CustomerCardTurn",data:function(){return{turnCustomerCardForm:{id:"",turnedReason:"",turnedMoney:"",newCardId:""},rules:{turnedMoney:[{required:!0,message:"退卡金额不能为空",trigger:"blur"},{type:"number",message:"退卡金额必须是数字",trigger:"blur"}],newCardId:[{required:!0,message:"会员卡不能为空",trigger:"blur"},{type:"number",message:"会员卡必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},computed:{memberCards:function(){return this.$store.state.memberCard.memberCardsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("turnCustomerCard",t.turnCustomerCardForm).then(function(e){0===e.code&&(t.$message.success("转卡成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/customer-card"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},loadMemberCardAll:function(){var e=this;this.$store.dispatch("loadMemberCardAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.customerCard.customerCards.length)this.$router.push({path:"/customer-card"});else{this.loadMemberCardAll();var e=this.$store.getters.getCustomerCardById(this.$route.params.id);this.turnCustomerCardForm.id=e.id}}},Ao={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerCardTurn"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/customer-card"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("转卡")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"turnCustomerCardForm",staticClass:"new-form",attrs:{model:e.turnCustomerCardForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("turnCustomerCardForm")}}},[o("el-form-item",{attrs:{label:"转卡原因",prop:"turnedReason"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.turnCustomerCardForm.turnedReason,callback:function(t){e.$set(e.turnCustomerCardForm,"turnedReason","string"==typeof t?t.trim():t)},expression:"turnCustomerCardForm.turnedReason"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"转卡金额(元)",prop:"turnedMoney"}},[o("el-input",{model:{value:e.turnCustomerCardForm.turnedMoney,callback:function(t){e.$set(e.turnCustomerCardForm,"turnedMoney",e._n(t))},expression:"turnCustomerCardForm.turnedMoney"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"新会员卡卡",prop:"newCardId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入卡名"},model:{value:e.turnCustomerCardForm.newCardId,callback:function(t){e.$set(e.turnCustomerCardForm,"newCardId",e._n(t))},expression:"turnCustomerCardForm.newCardId"}},e._l(e.memberCards,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("turnCustomerCardForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var To=o("X4nt")(jo,Ao,!1,function(e){o("yTgw")},"data-v-2d952f1e",null).exports,Io={name:"CustomerCardChangeStore",data:function(){return{changeStoreCustomerCardForm:{id:"",turnedReason:"",turnedMoney:"",newStoreId:""},rules:{turnedMoney:[{required:!0,message:"退卡金额不能为空",trigger:"blur"},{type:"number",message:"退卡金额必须是数字",trigger:"blur"}],newStoreId:[{required:!0,message:"店铺不能为空",trigger:"blur"},{type:"number",message:"库店铺必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0}},computed:{stores:function(){return this.$store.state.store.storesAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("changeStoreCustomerCard",t.changeStoreCustomerCardForm).then(function(e){0===e.code&&(t.$message.success("转店成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/customer-card"})},2e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},loadStoreAll:function(){var e=this;this.$store.dispatch("loadStoreAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.customerCard.customerCards.length)this.$router.push({path:"/customer-card"});else{this.loadStoreAll();var e=this.$store.getters.getCustomerCardById(this.$route.params.id);this.changeStoreCustomerCardForm.id=e.id}}},Mo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerCardChangeStore"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/customer-card"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("转店")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"changeStoreCustomerCardForm",staticClass:"new-form",attrs:{model:e.changeStoreCustomerCardForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("changeStoreCustomerCardForm")}}},[o("el-form-item",{attrs:{label:"转店原因",prop:"turnedReason"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.changeStoreCustomerCardForm.turnedReason,callback:function(t){e.$set(e.changeStoreCustomerCardForm,"turnedReason","string"==typeof t?t.trim():t)},expression:"changeStoreCustomerCardForm.turnedReason"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"转店金额(元)",prop:"turnedMoney"}},[o("el-input",{model:{value:e.changeStoreCustomerCardForm.turnedMoney,callback:function(t){e.$set(e.changeStoreCustomerCardForm,"turnedMoney",e._n(t))},expression:"changeStoreCustomerCardForm.turnedMoney"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"转到店铺",prop:"newStoreId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入店铺名"},model:{value:e.changeStoreCustomerCardForm.newStoreId,callback:function(t){e.$set(e.changeStoreCustomerCardForm,"newStoreId",e._n(t))},expression:"changeStoreCustomerCardForm.newStoreId"}},e._l(e.stores,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("changeStoreCustomerCardForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var No=o("X4nt")(Io,Mo,!1,function(e){o("AL5c")},"data-v-068ca334",null).exports,Ro={name:"CustomerCardChangeRecord",data:function(){return{customerCardChangeRecordSearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.customerCard.pageNum},pageSize:function(){return this.$store.state.customerCard.pageSize},totalCount:function(){return this.$store.state.customerCard.totalCount},totalPages:function(){return this.$store.state.customerCard.totalPages},tableData:function(){return this.$store.state.customerCard.customerCardChanges}},methods:{searchCustomerCardChangeRecord:function(e){var t=this;this.loading=!0,"search"===e&&(this.customerCardChangeRecordSearch.oldContent=this.customerCardChangeRecordSearch.content),this.customerCardChangeRecordSearch.type=e,this.$store.dispatch("loadCustomerCardChangeList",this.customerCardChangeRecordSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.customerCardSearch.pageNum=e,this.searchCustomerCardChangeRecord("page")},handleRemainMoney:function(e,t){return e.remainingMoney&&""!==e.remainingMoney?"￥"+e.remainingMoney:"暂无"},handleRemainTimes:function(e,t){return e.remainingTimes&&""!==e.remainingTimes?e.remainingTimes+"次":"暂无"},handleIsReturned:function(e,t){return e.isReturned&&""!==e.isReturned?e.isReturned:"否"},handleReturnedReason:function(e,t){return e.returnedReason&&""!==e.returnedReason?e.returnedReason:"暂无"},handlReturnedMoney:function(e,t){return e.returnedMoney&&""!==e.returnedMoney?"￥"+e.returnedMoney:"暂无"},handlProjectDiscount:function(e,t){return e.projectDiscount&&""!==e.projectDiscount?e.projectDiscount:"暂无"},handlProductDiscount:function(e,t){return e.productDiscount&&""!==e.productDiscount?e.productDiscount:"暂无"},handlIsTurned:function(e,t){return e.isTurned&&""!==e.isTurned?e.isTurned:"暂无"},handlTurnedReason:function(e,t){return e.turnedReason&&""!==e.turnedReason?e.turnedReason:"暂无"},handlTurnedMoney:function(e,t){return e.turnedMoney&&""!==e.turnedMoney?"￥"+e.turnedMoney:"暂无"}},beforeMount:function(){this.searchCustomerCardChangeRecord("search")}},Do={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerCardChangeRecord"},[o("el-form",{ref:"customerCardChangeRecordSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.customerCardChangeRecordSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchCustomerCardChangeRecord("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.customerCardChangeRecordSearch.content,callback:function(t){e.$set(e.customerCardChangeRecordSearch,"content","string"==typeof t?t.trim():t)},expression:"customerCardChangeRecordSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchCustomerCardChangeRecord("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"memberCardName",label:"卡名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remainingMoney",label:"余额",formatter:e.handleRemainMoney}}),e._v(" "),o("el-table-column",{attrs:{prop:"remainingTimes",label:"剩余次数",formatter:e.handleRemainTimes}}),e._v(" "),o("el-table-column",{attrs:{prop:"isValid",label:"是否有效"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isReturned",label:"是否退卡",formatter:e.handleIsReturned}}),e._v(" "),o("el-table-column",{attrs:{prop:"returnedReason",label:"退卡原因",formatter:e.handleReturnedReason}}),e._v(" "),o("el-table-column",{attrs:{prop:"returnedMoney",label:"退卡金额",formatter:e.handlReturnedMoney}}),e._v(" "),o("el-table-column",{attrs:{prop:"projectDiscount",label:"项目折扣",formatter:e.handlProjectDiscount}}),e._v(" "),o("el-table-column",{attrs:{prop:"productDiscount",label:"产品折扣",formatter:e.handlProductDiscount}}),e._v(" "),o("el-table-column",{attrs:{prop:"isTurned",label:"是否换卡",formatter:e.handlIsTurned}}),e._v(" "),o("el-table-column",{attrs:{prop:"turnedReason",label:"换卡原因",formatter:e.handlTurnedReason}}),e._v(" "),o("el-table-column",{attrs:{prop:"turnedMoney",label:"补/退金额",formatter:e.handlTurnedMoney}}),e._v(" "),o("el-table-column",{attrs:{prop:"uniqueIdentifier",label:"流水号"}})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var zo=o("X4nt")(Ro,Do,!1,function(e){o("tEi0")},"data-v-383f5c1c",null).exports,Eo={name:"CustomerActivity",data:function(){return{customerActivitySearch:{content:"",oldContent:"",pageNum:"1",pageSize:"10",type:""},loading:!1,activityContentDetail:[],activityContentVisible:!1}},computed:{pageNum:function(){return this.$store.state.customerActivity.pageNum},pageSize:function(){return this.$store.state.customerActivity.pageSize},totalCount:function(){return this.$store.state.customerActivity.totalCount},totalPages:function(){return this.$store.state.customerActivity.totalPages},tableData:function(){return this.$store.state.customerActivity.customerActivities}},methods:{searchCustomerActivity:function(e){var t=this;this.loading=!0,"search"===e&&(this.customerActivitySearch.oldContent=this.customerActivitySearch.content),this.customerActivitySearch.type=e,this.$store.dispatch("loadCustomerActivity",this.customerActivitySearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.customerActivitySearch.pageNum=e,this.searchCustomerActivity("page")},handleRemainMoney:function(e,t){return e.remainingMoney&&""!==e.remainingMoney?"￥"+e.remainingMoney:"暂无"},handleRemainTimes:function(e,t){return e.remainingTimes&&""!==e.remainingTimes?e.remainingTimes+"次":"暂无"},handleIsReturned:function(e,t){return e.isReturned&&""!==e.isReturned?e.isReturned:"否"},handleReturnedReason:function(e,t){return e.returnedReason&&""!==e.returnedReason?e.returnedReason:"暂无"},handlReturnedMoney:function(e,t){return e.returnedMoney&&""!==e.returnedMoney?"￥"+e.returnedMoney:"暂无"},handlProjectDiscount:function(e,t){return e.projectDiscount&&""!==e.projectDiscount?e.projectDiscount:"暂无"},handlProductDiscount:function(e,t){return e.productDiscount&&""!==e.productDiscount?e.productDiscount:"暂无"},handlIsTurned:function(e,t){return e.isTurned&&""!==e.isTurned?e.isTurned:"暂无"},handlTurnedReason:function(e,t){return e.turnedReason&&""!==e.turnedReason?e.turnedReason:"暂无"},handlTurnedMoney:function(e,t){return e.turnedMoney&&""!==e.turnedMoney?"￥"+e.turnedMoney:"暂无"},handleCharge:function(e,t){this.$router.push({path:"/customer-card-charge/"+t.id})},handleBuy:function(e,t){this.$router.push({path:"/customer-card-buy/"+t.id})},handleTurn:function(e,t){this.$router.push({path:"/customer-card-turn/"+t.id})},handleActivityContentDetail:function(e,t){var o=this.$store.getters.getCustomerActivityById(t.id),n=!0,r=!1,a=void 0;try{for(var i,s=k()(o.customerActivityContents);!(n=(i=s.next()).done);n=!0){var l=i.value,c=void 0;"项目"===l.type?c=l.relatedName:"会员卡"===l.type?c=l.relatedName:"产品"===l.type?c=l.relatedName:(4,c=l.content),this.activityContentDetail.push({type:l.type,name:c,number:l.number,remark:""!==l.remark&&l.remark?l.remark:"暂无备注"})}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}this.activityContentVisible=!0},onClose:function(e){this.activityContentVisible=!1,this.activityContentDetail=[]}},beforeMount:function(){this.searchCustomerActivity("search")}},Bo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CustomerActivity"},[o("el-form",{ref:"customerActivitySearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.customerActivitySearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchCustomerActivity("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.customerActivitySearch.content,callback:function(t){e.$set(e.customerActivitySearch,"content","string"==typeof t?t.trim():t)},expression:"customerActivitySearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchCustomerActivity("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"activityName",label:"活动名称"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleActivityContentDetail(t.$index,t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"活动内容详情",visible:e.activityContentVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.activityContentVisible=t}}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.activityContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"number",label:"个数"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注"}})],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onClose("")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Wo=o("X4nt")(Eo,Bo,!1,function(e){o("YcHe")},"data-v-1b5e840d",null).exports,qo={name:"Activity",data:function(){return{activitySearch:{content:"",oldContent:"",pageNum:1,pageSize:10,type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.activity.pageNum},pageSize:function(){return this.$store.state.activity.pageSize},totalCount:function(){return this.$store.state.activity.totalCount},totalPages:function(){return this.$store.state.activity.totalPages},tableData:function(){return this.$store.state.activity.activities}},methods:{searchActivity:function(e){var t=this;this.loading=!0,"search"===e&&(this.activitySearch.oldContent=this.activitySearch.content),this.activitySearch.type=e,this.$store.dispatch("loadActivity",this.activitySearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.activitySearch.pageNum=e,this.searchActivity("page")},handleDeadline:function(e,t){return this.toDatetimeDay(e.deadline)},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){this.$router.push({path:"/activity/"+t.id})},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadProductAll:function(){var e=this;this.$store.dispatch("loadProductAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadMemberCardAll:function(){var e=this;this.$store.dispatch("loadMemberCardAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){this.searchActivity("search"),this.loadProjectAll(),this.loadProductAll(),this.loadMemberCardAll()}},Oo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Activity"},[o("el-form",{ref:"activitySearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.activitySearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchActivity("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.activitySearch.content,callback:function(t){e.$set(e.activitySearch,"content","string"==typeof t?t.trim():t)},expression:"activitySearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchActivity("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/activity/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"price",label:"价格"}}),e._v(" "),o("el-table-column",{attrs:{prop:"code",label:"代码"}}),e._v(" "),o("el-table-column",{attrs:{prop:"deadline",label:"有效期至",formatter:e.handleDeadline}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"150px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var Vo=o("X4nt")(qo,Oo,!1,function(e){o("RbWr")},"data-v-cbe60ef4",null).exports,Lo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ActivityContent"},[o("el-dialog",{attrs:{title:"活动内容",visible:e.isVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:20}},[o("el-form",{ref:"activityContentForm",attrs:{model:e.activityContentForm,"label-width":"70px",rules:e.rules}},[o("el-form-item",{attrs:{label:"类型",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择类型"},on:{change:e.handleTypeChange},model:{value:e.activityContentForm.type,callback:function(t){e.$set(e.activityContentForm,"type",e._n(t))},expression:"activityContentForm.type"}},e._l(e.types,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),1===this.activityContentForm.type?o("el-form-item",{attrs:{label:"项目",prop:"relatedId"}},[o("el-select",{attrs:{placeholder:"请选择项目",filterable:""},model:{value:e.activityContentForm.relatedId,callback:function(t){e.$set(e.activityContentForm,"relatedId",e._n(t))},expression:"activityContentForm.relatedId"}},e._l(e.projects,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1):e._e(),e._v(" "),2===this.activityContentForm.type?o("el-form-item",{attrs:{label:"会员卡",prop:"relatedId"}},[o("el-select",{attrs:{placeholder:"请选择会员卡",filterable:""},model:{value:e.activityContentForm.relatedId,callback:function(t){e.$set(e.activityContentForm,"relatedId",e._n(t))},expression:"activityContentForm.relatedId"}},e._l(e.memberCards,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1):e._e(),e._v(" "),3===this.activityContentForm.type?o("el-form-item",{attrs:{label:"产品",prop:"relatedId"}},[o("el-select",{attrs:{placeholder:"请选择产品",filterable:""},model:{value:e.activityContentForm.relatedId,callback:function(t){e.$set(e.activityContentForm,"relatedId",e._n(t))},expression:"activityContentForm.relatedId"}},e._l(e.products,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1):e._e(),e._v(" "),4===this.activityContentForm.type?o("el-form-item",{attrs:{label:"金额"}},[o("el-input",{attrs:{placeholder:"请输入代金券金额"},model:{value:e.activityContentForm.content,callback:function(t){e.$set(e.activityContentForm,"content",e._n(t))},expression:"activityContentForm.content"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"个数",prop:"number"}},[o("el-input",{attrs:{placeholder:"请输入个数"},model:{value:e.activityContentForm.number,callback:function(t){e.$set(e.activityContentForm,"number",e._n(t))},expression:"activityContentForm.number"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.activityContentForm.remark,callback:function(t){e.$set(e.activityContentForm,"remark","string"==typeof t?t.trim():t)},expression:"activityContentForm.remark"}})],1)],1)],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("activityContentForm")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("activityContentForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Xo=o("X4nt")({name:"ActivityContent",props:["visible","options"],data:function(){return{activityContentForm:{type:"",relatedId:"",content:"",number:"",remark:""},rules:{type:[{required:!0,message:"类型不能为空",trigger:"blur"},{type:"number",message:"类型必须是数字",trigger:"blur"}],number:[{required:!0,message:"个数不能为空",trigger:"blur"},{type:"number",message:"个数必须是数字",trigger:"blur"}]},types:[{name:"项目",value:1},{name:"会员卡",value:2},{name:"产品",value:3},{name:"代金券",value:4}],relatedContent:[]}},computed:{isVisible:function(){return this.visible},projects:function(){return this.$store.state.project.projectsAll},products:function(){return this.$store.state.product.productsAll},memberCards:function(){return this.$store.state.memberCard.memberCardsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.$emit("addActivityContent",t.activityContentForm),t.$emit("closeDialog",!1),t.$refs[e].resetFields()})},onClose:function(e){this.$emit("closeDialog",!1),this.$refs[e].resetFields()},handleTypeChange:function(e){this.activityContentForm.relatedId=""}}},Lo,!1,function(e){o("nRXp")},"data-v-3818e51e",null).exports,Go={name:"ActivityNew",data:function(){return{newActivityForm:{name:"",code:"",price:"",deadline:"",remark:"",activityContentParams:[]},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],price:[{required:!0,message:"价格不能为空",trigger:"blur"},{type:"number",message:"价格必须是数字",trigger:"blur"}],deadline:[{required:!0,message:"有效期不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0,activityContentParamsDialog:!1,activityContents:[]}},computed:{},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addActivity",{name:t.newActivityForm.name,code:t.newActivityForm.code,price:t.newActivityForm.price,deadline:t.toTimeStamp(t.newActivityForm.deadline),remark:t.newActivityForm.remark,activityContentParams:t.newActivityForm.activityContentParams}).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/activity"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleAddActivityContent:function(e){var t=void 0,o=void 0;1===e.type?(t="项目",o=this.$store.getters.getProjectFromAllById(e.relatedId).name):2===e.type?(t="会员卡",o=this.$store.getters.getMemberCardFromAllById(e.relatedId).name):3===e.type?(t="产品",o=this.$store.getters.getProductFromAllById(e.relatedId).name):(t="代金券",o=e.content),this.activityContents.push({type:t,name:o,number:e.number,remark:""===e.remark?"暂无备注":e.remark}),this.newActivityForm.activityContentParams.push({type:e.type,relatedId:e.relatedId,content:e.content,number:e.number,remark:e.remark})},handleDelete:function(e,t){this.activityContents.splice(e,1),this.newActivityForm.activityContentParams.splice(e,1)}},beforeMount:function(){},components:{ActivityContent:Xo}},Uo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ActivityNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/activity"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建活动")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newActivityForm",staticClass:"new-form",attrs:{model:e.newActivityForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newActivityForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入名称",autofocus:!0},model:{value:e.newActivityForm.name,callback:function(t){e.$set(e.newActivityForm,"name","string"==typeof t?t.trim():t)},expression:"newActivityForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入代码"},model:{value:e.newActivityForm.code,callback:function(t){e.$set(e.newActivityForm,"code","string"==typeof t?t.trim():t)},expression:"newActivityForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"价格(￥)",prop:"price"}},[o("el-input",{attrs:{placeholder:"请输入价格"},model:{value:e.newActivityForm.price,callback:function(t){e.$set(e.newActivityForm,"price",e._n(t))},expression:"newActivityForm.price"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"有效期至",prop:"deadline"}},[o("el-date-picker",{attrs:{align:"center",type:"date",editable:!1,placeholder:"选择日期"},model:{value:e.newActivityForm.deadline,callback:function(t){e.$set(e.newActivityForm,"deadline",t)},expression:"newActivityForm.deadline"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newActivityForm.remark,callback:function(t){e.$set(e.newActivityForm,"remark","string"==typeof t?t.trim():t)},expression:"newActivityForm.remark"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"活动内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.activityContents,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"内容/金额"}}),e._v(" "),o("el-table-column",{attrs:{prop:"number",label:"个数"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.activityContentParamsDialog=!0}}},[e._v("添加活动内容")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newActivityForm")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("ActivityContent",{attrs:{visible:e.activityContentParamsDialog},on:{closeDialog:function(t){e.activityContentParamsDialog=!1},addActivityContent:e.handleAddActivityContent}})],1)},staticRenderFns:[]};var Ho=o("X4nt")(Go,Uo,!1,function(e){o("Nh1K")},"data-v-39516aa4",null).exports,Yo={name:"ActivityDetail",data:function(){return{modActivityForm:{id:"",name:"",code:"",price:"",deadline:"",remark:"",activityContentParams:[]},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"}],code:[{required:!0,message:"代码不能为空",trigger:"blur"}],price:[{required:!0,message:"价格不能为空",trigger:"blur"},{type:"number",message:"价格必须是数字",trigger:"blur"}],deadline:[{required:!0,message:"有效期不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0,activityContentParamsDialog:!1,activityContents:[]}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modActivity",{id:t.modActivityForm.id,name:t.modActivityForm.name,code:t.modActivityForm.code,price:t.modActivityForm.price,deadline:t.toTimeStamp(t.modActivityForm.deadline),remark:t.modActivityForm.remark,activityContentParams:t.modActivityForm.activityContentParams}).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/activity"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleAddActivityContent:function(e){var t=void 0,o=void 0;1===e.type?(t="项目",o=this.$store.getters.getProjectFromAllById(e.relatedId).name):2===e.type?(t="会员卡",o=this.$store.getters.getMemberCardFromAllById(e.relatedId).name):3===e.type?(t="产品",o=this.$store.getters.getProductFromAllById(e.relatedId).name):(t="代金券",o=e.content),this.activityContents.push({type:t,name:o,number:e.number,remark:""===e.remark?"暂无备注":e.remark}),this.modActivityForm.activityContentParams.push({type:e.type,relatedId:e.relatedId,content:e.content,number:e.number,remark:e.remark})},handleDelete:function(e,t){this.activityContents.splice(e,1),this.modActivityForm.activityContentParams.splice(e,1)},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadProductAll:function(){var e=this;this.$store.dispatch("loadProductAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadCustomerCardAll:function(){var e=this;this.$store.dispatch("loadCustomerCardAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.activity.activities.length)this.$router.push({path:"/activity"});else{var e=this.$store.getters.getActivityById(this.$route.params.id);this.modActivityForm.id=e.id,this.modActivityForm.name=e.name,this.modActivityForm.code=e.code,this.modActivityForm.price=Y()(e.price),this.modActivityForm.deadline=this.toDateObject(e.deadline),this.modActivityForm.remarks=e.remarks;var t=!0,o=!1,n=void 0;try{for(var r,a=k()(e.activityContentVos);!(t=(r=a.next()).done);t=!0){var i=r.value,s=void 0,l=void 0;"项目"===i.type?(s=1,l=this.$store.getters.getProjectFromAllById(i.relatedId).name):"会员卡"===i.type?(s=2,l=this.$store.getters.getMemberCardFromAllById(i.relatedId).name):"产品"===i.type?(s=3,l=this.$store.getters.getProductFromAllById(i.relatedId).name):(s=4,l=i.content),this.activityContents.push({type:i.type,name:l,number:i.number,remark:""===i.remark?"暂无备注":i.remark}),this.modActivityForm.activityContentParams.push({type:s,relatedId:i.relatedId,content:i.content,number:i.number,remark:i.remark})}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}},components:{ActivityContent:Xo}},Jo={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ActivityDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/activity"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("修改活动")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modActivityForm",staticClass:"new-form",attrs:{model:e.modActivityForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modActivityForm")}}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入名称",autofocus:!0},model:{value:e.modActivityForm.name,callback:function(t){e.$set(e.modActivityForm,"name","string"==typeof t?t.trim():t)},expression:"modActivityForm.name"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"代码",prop:"code"}},[o("el-input",{attrs:{placeholder:"请输入代码"},model:{value:e.modActivityForm.code,callback:function(t){e.$set(e.modActivityForm,"code","string"==typeof t?t.trim():t)},expression:"modActivityForm.code"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"价格(￥)",prop:"price"}},[o("el-input",{attrs:{placeholder:"请输入价格"},model:{value:e.modActivityForm.price,callback:function(t){e.$set(e.modActivityForm,"price",e._n(t))},expression:"modActivityForm.price"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"有效期至",prop:"deadline"}},[o("el-date-picker",{attrs:{align:"center",type:"date",editable:!1,placeholder:"选择日期"},model:{value:e.modActivityForm.deadline,callback:function(t){e.$set(e.modActivityForm,"deadline",t)},expression:"modActivityForm.deadline"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modActivityForm.remark,callback:function(t){e.$set(e.modActivityForm,"remark","string"==typeof t?t.trim():t)},expression:"modActivityForm.remark"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"活动内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.activityContents,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"内容/金额"}}),e._v(" "),o("el-table-column",{attrs:{prop:"number",label:"个数"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.activityContentParamsDialog=!0}}},[e._v("添加活动内容")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modActivityForm")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("ActivityContent",{attrs:{visible:e.activityContentParamsDialog},on:{closeDialog:function(t){e.activityContentParamsDialog=!1},addActivityContent:e.handleAddActivityContent}})],1)},staticRenderFns:[]};var Qo=o("X4nt")(Yo,Jo,!1,function(e){o("7hZr")},"data-v-20fdb9d9",null).exports,Zo={render:function(){var e=this.$createElement;return(this._self._c||e)("div",{staticClass:"Chart"},[this._v("   \n    图表\n")])},staticRenderFns:[]};var Ko=o("X4nt")({name:"Chart",data:function(){return{}},computed:{},methods:{}},Zo,!1,function(e){o("CYIG")},"data-v-ca782990",null).exports,en={name:"Appointment",data:function(){return{appointmentSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,type:""},loading:!1}},computed:{pageNum:function(){return this.$store.state.appointment.pageNum},pageSize:function(){return this.$store.state.appointment.pageSize},totalCount:function(){return this.$store.state.appointment.totalCount},totalPages:function(){return this.$store.state.appointment.totalPages},tableData:function(){return this.$store.state.appointment.appointments}},methods:{searchAppointment:function(e){var t=this;this.loading=!0,"search"===e&&(this.appointmentSearch.oldContent=this.appointmentSearch.content),this.appointmentSearch.type=e,this.$store.dispatch("loadAppointment",this.appointmentSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.appointmentSearch.pageNum=e,this.searchAppointment("page")},handleRemark:function(e,t){return e.remarks&&""!==e.remarks?e.remarks:"暂无备注"},handleBeginTime:function(e,t){var o="",n=!0,r=!1,a=void 0;try{for(var i,s=k()(e.appointmentProjects);!(n=(i=s.next()).done);n=!0){var l=i.value;o+=this.toDatetimeMin(l.beginTime)}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o},handleEndTime:function(e,t){var o="",n=!0,r=!1,a=void 0;try{for(var i,s=k()(e.appointmentProjects);!(n=(i=s.next()).done);n=!0){var l=i.value;o+=this.toDatetimeMin(l.endTime)}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o},handleFinish:function(e,t){this.$router.push({path:"/appointment-finish/"+t.id})},handleEdit:function(e,t){this.$router.push({path:"/appointment-detail/"+t.id})},handleDelete:function(e,t){var o=this,n=this.$createElement;this.$msgbox({title:"提示",message:n("p",null,[n("span",null,"此操作将会永久取消该预约！ ")]),showCancelButton:!0,confirmButtonText:"确认取消",cancelButtonText:"否",type:"warning",beforeClose:function(e,n,r){"confirm"===e?(n.confirmButtonLoading=!0,n.confirmButtonText="取消中...",o.$store.dispatch("cancelAppointment",{appointmentId:t.id}).then(function(e){r(),n.confirmButtonLoading=!1,o.searchAppointment("search")}).catch(function(e){r(),n.confirmButtonLoading=!1,console.log(e)})):r()}}).catch(function(){o.$message({type:"info",message:"取消操作"})})}},beforeMount:function(){this.searchAppointment("search")}},tn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Appointment"},[o("el-form",{ref:"appointmentSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.appointmentSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchAppointment("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.appointmentSearch.content,callback:function(t){e.$set(e.appointmentSearch,"content","string"==typeof t?t.trim():t)},expression:"appointmentSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchAppointment("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/appointment/new"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("新建")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerMobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerGender",label:"性别"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isLine",label:"点排"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remarks",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{prop:"projects",label:"项目"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.appointmentProjects,function(t){return o("div",[e._v("\n            "+e._s(t.projectName)+"\n          ")])})}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"employees",label:"员工"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.appointmentProjects,function(t){return o("div",[e._v("\n            "+e._s(t.employeeName)+"\n          ")])})}}])}),e._v(" "),o("el-table-column",{attrs:{prop:"beginTime",label:"开始时间",width:"125px;",formatter:e.handleBeginTime}}),e._v(" "),o("el-table-column",{attrs:{prop:"endTime",label:"结束时间",width:"125px;",formatter:e.handleEndTime}}),e._v(" "),o("el-table-column",{attrs:{prop:"status",label:"状态"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"220px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return"未完成"===t.row.status?[o("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(o){e.handleFinish(t.$index,t.row)}}},[e._v("完成")]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleEdit(t.$index,t.row)}}},[e._v("编辑")]),e._v(" "),o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("取消")])]:void 0}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var on=o("X4nt")(en,tn,!1,function(e){o("Fqnv")},"data-v-70916c49",null).exports,nn={name:"AppointmentProject",props:["visible","options"],data:function(){return{appointmentProject:{projectId:"",employeeId:"",appointmentTime:""},rules:{projectId:[{required:!0,message:"库存不能为空",trigger:"blur"},{type:"number",message:"库存必须是数字",trigger:"blur"}],employeeId:[{required:!0,message:"员工不能为空",trigger:"blur"},{type:"number",message:"员工必须是数字",trigger:"blur"}],appointmentTime:[{required:!0,message:"预约时间不能为空",trigger:"blur"}]},projectTemp:[],employeeSchedule:[]}},computed:{isVisible:function(){return this.visible},employees:function(){return this.$store.state.employee.employeesByTopType}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.$emit("addAppointmentProject",t.appointmentProject),t.$emit("closeDialog",!1),t.$refs[e].resetFields(),t.appointmentProject.projectId="",t.appointmentProject.appointmentTime=[],t.projectTemp=[]})},onClose:function(e){this.$emit("closeDialog",!1),console.log(this.$refs[e]),this.$refs[e].resetFields(),this.appointmentProject.projectId="",this.appointmentProject.appointmentTime=[],this.projectTemp=[]},handleChange:function(e){this.appointmentProject.projectId=e[2],this.$store.dispatch("loadEmployeeByTopType",e[0]).then(function(e){}).catch(function(e){console.log(e)})},handleProjectChange:function(e){this.$store.dispatch("loadEmployeeByTopType",e[0]).then(function(e){}).catch(function(e){console.log(e)})},handleDateChange:function(e){var t=this;""!==this.appointmentProject.employeeId&&this.appointmentProject.employeeId?this.$store.dispatch("getEmployeeTimeTable",{employeeId:this.appointmentProject.employeeId,date:this.toTimeStamp(e)}).then(function(e){if(0===e.code){t.employeeSchedule=[];var o=!0,n=!1,r=void 0;try{for(var a,i=k()(e.data);!(o=(a=i.next()).done);o=!0){var s=a.value;s.beginTime=t.toMin(s.beginTime),s.endTime=t.toMin(s.endTime),t.employeeSchedule.push(s)}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}}).catch(function(e){console.log(e)}):this.$message.error("请选择员工")}}},rn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"AppointmentProject"},[o("el-dialog",{attrs:{title:"项目",visible:e.isVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:20}},[o("el-form",{ref:"appointmentProject",attrs:{model:e.appointmentProject,rules:e.rules}},[o("el-form-item",{attrs:{label:"请选择美容项目",prop:"projectId"}},[o("el-cascader",{attrs:{options:e.options,filterable:""},on:{change:e.handleChange,"active-item-change":e.handleProjectChange},model:{value:e.projectTemp,callback:function(t){e.projectTemp=t},expression:"projectTemp"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"请选择时间",prop:"appointmentTime"}},[o("el-date-picker",{attrs:{type:"datetimerange",align:"center","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间"},model:{value:e.appointmentProject.appointmentTime,callback:function(t){e.$set(e.appointmentProject,"appointmentTime",t)},expression:"appointmentProject.appointmentTime"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"请选择员工",prop:"employeeId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入关键词"},model:{value:e.appointmentProject.employeeId,callback:function(t){e.$set(e.appointmentProject,"employeeId",e._n(t))},expression:"appointmentProject.employeeId"}},e._l(e.employees,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"请选择查询日期"}},[o("el-date-picker",{attrs:{type:"date",placeholder:"查询员工日程"},on:{change:e.handleDateChange},model:{value:e.employeeSchedule,callback:function(t){e.employeeSchedule=t},expression:"employeeSchedule"}}),e._v(" "),o("div",{staticClass:"schedule"},e._l(e.employeeSchedule,function(t){return o("div",{key:t.beginTime,staticClass:"schedule-item",class:1===t.isFree?"free":"occupy",style:{flex:"1 "+t.percent+"%"}},[o("div",{staticClass:"beginTime"},[e._v("\n                  "+e._s(t.beginTime)+"\n                ")]),e._v(" "),o("div",{staticClass:"line"},[e._v("-")]),e._v(" "),o("div",{staticClass:"endTime"},[e._v("\n                  "+e._s(t.endTime)+"\n                ")])])}))],1)],1)],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("appointmentProject")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("appointmentProject")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var an=o("X4nt")(nn,rn,!1,function(e){o("aMXp")},"data-v-b2bff692",null).exports,sn={name:"AppointmentNew",data:function(){return{newAppointmentForm:{customerName:"",customerMobile:"",customerGender:"",isLine:"",remarks:"",appointmentProjectParams:[]},rules:{customerName:[{required:!0,message:"姓名不能为空",trigger:"blur"}],customerMobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{type:"number",message:"手机号必须是数字",trigger:"blur"}],customerGender:[{required:!0,message:"性别不能为空",trigger:"blur"},{type:"number",message:"性别必须是数字",trigger:"blur"}],isLine:[{required:!0,message:"点排不能为空",trigger:"blur"},{type:"number",message:"点排 必须是数字",trigger:"blur"}]},genders:[{label:"男",value:1},{label:"女",value:0}],isLines:[{label:"是",value:1},{label:"否",value:0}],loading:!1,enterFlag:!0,appointmentProjectDialog:!1,appointmentProjectsCopy:[],options:[]}},computed:{projectTypes:function(){return this.$store.state.projectType.projectTypesAll},projects:function(){return this.$store.state.project.projectsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addAppointment",t.newAppointmentForm).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/appointment"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleBeginTime:function(e,t){return this.toDatetimeMin(e.beginTime)},handleEndTime:function(e,t){return this.toDatetimeMin(e.endTime)},handleOpenDialog:function(){this.options=[{value:1,label:"美容",children:[]},{value:2,label:"美甲",children:[]},{value:3,label:"美睫",children:[]}];var e=this.projectTypes.filter(function(e){return 1===e.topType}),t=this.projectTypes.filter(function(e){return 2===e.topType}),o=this.projectTypes.filter(function(e){return 3===e.topType});this.fillOption(e,0),this.fillOption(t,1),this.fillOption(o,2),this.appointmentProjectDialog=!0},fillOption:function(e,t){var o=this,n=function(e){var n=o.projects.filter(function(t){return t.projectTypeId===Y()(e.id)}),r=[],a=!0,i=!1,s=void 0;try{for(var l,c=k()(n);!(a=(l=c.next()).done);a=!0){var u=l.value;r.push({value:u.id,label:u.code+"-"+u.name})}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}o.options[t].children.push({value:e.id,label:e.name,children:r})},r=!0,a=!1,i=void 0;try{for(var s,l=k()(e);!(r=(s=l.next()).done);r=!0){n(s.value)}}catch(e){a=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(a)throw i}}},handleAddAppointmentProject:function(e){console.log(e);var t=this.$store.getters.getEmployeeFromAllById(e.employeeId),o=this.$store.getters.getProjectFromAllById(e.projectId),n=this.toTimeStamp(e.appointmentTime[0]),r=this.toDatetimeMin(n),a=this.toTimeStamp(e.appointmentTime[1]),i=this.toDatetimeMin(a);this.appointmentProjectsCopy.push({projectId:o.id,projectName:o.name,projectCode:o.code,employeeId:t.id,employeeName:t.name,beginTime:r,endTime:i}),this.newAppointmentForm.appointmentProjectParams.push({projectId:o.id,projectCode:o.code,employeeId:t.id,beginTime:n,endTime:a})},handleDelete:function(e,t){var o=this.appointmentProjectsCopy.findIndex(function(e,o,n){return e.id===t.id});this.appointmentProjectsCopy.splice(o,1),this.newAppointmentForm.appointmentProjectParams.splice(o,1)},loadProjectTypeAll:function(){var e=this;this.$store.dispatch("loadProjectTypeAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadProjectTypeAll(),this.loadProjectAll(),this.loadEmployeeAll()},components:{AppointmentProject:an}},ln={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"AppointmentNew"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/appointment"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("新建预约")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newAppointmentForm",staticClass:"new-form",attrs:{model:e.newAppointmentForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newAppointmentForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"customerName"}},[o("el-input",{attrs:{placeholder:"请输入姓名",autofocus:!0},model:{value:e.newAppointmentForm.customerName,callback:function(t){e.$set(e.newAppointmentForm,"customerName","string"==typeof t?t.trim():t)},expression:"newAppointmentForm.customerName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"customerMobile"}},[o("el-input",{attrs:{placeholder:"请输入手机"},model:{value:e.newAppointmentForm.customerMobile,callback:function(t){e.$set(e.newAppointmentForm,"customerMobile",e._n(t))},expression:"newAppointmentForm.customerMobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"customerGender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.newAppointmentForm.customerGender,callback:function(t){e.$set(e.newAppointmentForm,"customerGender",e._n(t))},expression:"newAppointmentForm.customerGender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"点排",prop:"isLine"}},[o("el-select",{attrs:{placeholder:"请选择点排"},model:{value:e.newAppointmentForm.isLine,callback:function(t){e.$set(e.newAppointmentForm,"isLine",e._n(t))},expression:"newAppointmentForm.isLine"}},e._l(e.isLines,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newAppointmentForm.remarks,callback:function(t){e.$set(e.newAppointmentForm,"remarks","string"==typeof t?t.trim():t)},expression:"newAppointmentForm.remarks"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"项目"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.appointmentProjectsCopy,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"projectName",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"projectCode",label:"代码"}}),e._v(" "),e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"employeeName",label:"员工姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"beginTime",label:"开始时间"}}),e._v(" "),o("el-table-column",{attrs:{prop:"endTime",label:"结束时间"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.handleOpenDialog}},[e._v("添加项目")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newAppointmentForm")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("AppointmentProject",{attrs:{visible:e.appointmentProjectDialog,options:e.options},on:{closeDialog:function(t){e.appointmentProjectDialog=!1},addAppointmentProject:e.handleAddAppointmentProject}})],1)},staticRenderFns:[]};var cn=o("X4nt")(sn,ln,!1,function(e){o("jJUH")},"data-v-5c463298",null).exports,un={name:"AppointmentDetail",data:function(){return{modAppointmentForm:{id:"",customerName:"",customerMobile:"",customerGender:"",isLine:"",remarks:"",appointmentProjectParams:[]},rules:{customerName:[{required:!0,message:"姓名不能为空",trigger:"blur"}],customerMobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{type:"number",message:"手机号必须是数字",trigger:"blur"}],customerGender:[{required:!0,message:"性别不能为空",trigger:"blur"},{type:"number",message:"性别必须是数字",trigger:"blur"}],isLine:[{required:!0,message:"点排不能为空",trigger:"blur"},{type:"number",message:"点排 必须是数字",trigger:"blur"}]},genders:[{label:"男",value:1},{label:"女",value:0}],isLines:[{label:"是",value:1},{label:"否",value:0}],loading:!1,enterFlag:!0,appointmentProjectDialog:!1,appointmentProjectsCopy:[],options:[]}},computed:{projectTypes:function(){return this.$store.state.projectType.projectTypesAll},projects:function(){return this.$store.state.project.projectsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modAppointment",t.modAppointmentForm).then(function(e){0===e.code&&(t.$message.success("修改成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/appointment"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleBeginTime:function(e,t){return this.toDatetimeMin(e.beginTime)},handleEndTime:function(e,t){return this.toDatetimeMin(e.endTime)},handleOpenDialog:function(){this.options=[{value:1,label:"美容",children:[]},{value:2,label:"美甲",children:[]},{value:3,label:"美睫",children:[]}];var e=this.projectTypes.filter(function(e){return 1===e.topType}),t=this.projectTypes.filter(function(e){return 2===e.topType}),o=this.projectTypes.filter(function(e){return 3===e.topType});this.fillOption(e,0),this.fillOption(t,1),this.fillOption(o,2),this.appointmentProjectDialog=!0},fillOption:function(e,t){var o=this,n=function(e){var n=o.projects.filter(function(t){return t.projectTypeId===Y()(e.id)}),r=[],a=!0,i=!1,s=void 0;try{for(var l,c=k()(n);!(a=(l=c.next()).done);a=!0){var u=l.value;r.push({value:u.id,label:u.code+"-"+u.name})}}catch(e){i=!0,s=e}finally{try{!a&&c.return&&c.return()}finally{if(i)throw s}}o.options[t].children.push({value:e.id,label:e.name,children:r})},r=!0,a=!1,i=void 0;try{for(var s,l=k()(e);!(r=(s=l.next()).done);r=!0){n(s.value)}}catch(e){a=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(a)throw i}}},handleAddAppointmentProject:function(e){var t=this.$store.getters.getEmployeeFromAllById(e.employeeId),o=this.$store.getters.getProjectFromAllById(e.projectId),n=this.toTimeStamp(e.appointmentTime[0]),r=this.toDatetimeMin(n),a=this.toTimeStamp(e.appointmentTime[1]),i=this.toDatetimeMin(a);this.appointmentProjectsCopy.push({projectId:o.id,projectName:o.name,projectCode:o.code,employeeId:t.id,employeeName:t.name,beginTime:r,endTime:i}),this.modAppointmentForm.appointmentProjectParams.push({projectId:o.id,projectCode:o.code,employeeId:t.id,beginTime:n,endTime:a})},handleDelete:function(e,t){var o=this.appointmentProjectsCopy.findIndex(function(e,o,n){return e.id===t.id});this.appointmentProjectsCopy.splice(o,1),this.modAppointmentForm.appointmentProjectParams.splice(o,1)},loadProjectTypeAll:function(){var e=this;this.$store.dispatch("loadProjectTypeAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){if(0===this.$store.state.appointment.appointments.length)this.$router.push({path:"/appointment"});else{this.loadProjectTypeAll(),this.loadProjectAll(),this.loadEmployeeAll();var e=this.$store.getters.getAppointmentById(this.$route.params.id);console.log(e),this.modAppointmentForm.id=e.id,this.modAppointmentForm.customerName=e.customerName,this.modAppointmentForm.customerMobile=Y()(e.customerMobile),this.modAppointmentForm.customerGender="男"===e.gender?1:0,this.modAppointmentForm.isLine="是"===e.isLine?1:0,this.modAppointmentForm.remarks=e.remarks;var t=!0,o=!1,n=void 0;try{for(var r,a=k()(e.appointmentProjects);!(t=(r=a.next()).done);t=!0){var i=r.value;this.modAppointmentForm.appointmentProjectParams.push({projectId:i.projectId,employeeId:i.employeeId,beginTime:i.beginTime,endTime:i.endTime}),this.appointmentProjectsCopy.push({projectId:i.projectId,projectName:i.projectName,employeeId:i.employeeId,employeeName:i.employeeName,beginTime:this.toDatetimeMin(i.beginTime),endTime:this.toDatetimeMin(i.endTime)})}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}},components:{AppointmentProject:an}},mn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"AppointmentDetail"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/appointment"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("修改预约")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"modAppointmentForm",staticClass:"new-form",attrs:{model:e.modAppointmentForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("modAppointmentForm")}}},[o("el-form-item",{attrs:{label:"姓名",prop:"customerName"}},[o("el-input",{attrs:{placeholder:"请输入姓名",autofocus:!0},model:{value:e.modAppointmentForm.customerName,callback:function(t){e.$set(e.modAppointmentForm,"customerName","string"==typeof t?t.trim():t)},expression:"modAppointmentForm.customerName"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"手机",prop:"customerMobile"}},[o("el-input",{attrs:{placeholder:"请输入手机"},model:{value:e.modAppointmentForm.customerMobile,callback:function(t){e.$set(e.modAppointmentForm,"customerMobile",e._n(t))},expression:"modAppointmentForm.customerMobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"性别",prop:"customerGender"}},[o("el-select",{attrs:{placeholder:"请选择性别"},model:{value:e.modAppointmentForm.customerGender,callback:function(t){e.$set(e.modAppointmentForm,"customerGender",e._n(t))},expression:"modAppointmentForm.customerGender"}},e._l(e.genders,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"点排",prop:"isLine"}},[o("el-select",{attrs:{placeholder:"请选择点排"},model:{value:e.modAppointmentForm.isLine,callback:function(t){e.$set(e.modAppointmentForm,"isLine",e._n(t))},expression:"modAppointmentForm.isLine"}},e._l(e.isLines,function(e){return o("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.modAppointmentForm.remarks,callback:function(t){e.$set(e.modAppointmentForm,"remarks","string"==typeof t?t.trim():t)},expression:"modAppointmentForm.remarks"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"项目"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.appointmentProjectsCopy,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"projectName",label:"名称"}}),e._v(" "),e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"employeeName",label:"员工姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"beginTime",label:"开始时间"}}),e._v(" "),o("el-table-column",{attrs:{prop:"endTime",label:"结束时间"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:e.handleOpenDialog}},[e._v("添加项目")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("modAppointmentForm")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("AppointmentProject",{attrs:{visible:e.appointmentProjectDialog,options:e.options},on:{closeDialog:function(t){e.appointmentProjectDialog=!1},addAppointmentProject:e.handleAddAppointmentProject}})],1)},staticRenderFns:[]};var dn=o("X4nt")(un,mn,!1,function(e){o("q5m7")},"data-v-6b35b758",null).exports,pn={name:"AProject",props:["visible"],data:function(){return{projectParams:{projectId:"",amount:"",operatorId:""},rules:{projectId:[{required:!0,message:"项目不能为空",trigger:"blur"},{type:"number",message:"项目必须是数字",trigger:"blur"}],amount:[{required:!0,message:"数量不能为空",trigger:"blur"},{type:"number",message:"数量必须是数字",trigger:"blur"}],operatorId:[{required:!0,message:"操作员不能为空",trigger:"blur"},{type:"number",message:"操作员必须是数字",trigger:"blur"}]}}},computed:{isVisible:function(){return this.visible},projects:function(){return this.$store.state.project.projectsAll},employees:function(){return this.$store.state.employee.employeesByTopType}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.$emit("addAProject",t.projectParams),t.$emit("closeDialog",!1),t.$refs[e].resetFields()})},handleProjectChange:function(e){var t=this.$store.getters.getProjectFromAllById(e).topTypeDesc;console.log(t)},onClose:function(e){this.$emit("closeDialog",!1),this.$refs[e].resetFields()}}},fn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"AProject"},[o("el-dialog",{attrs:{title:"项目",visible:e.isVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[o("el-form",{ref:"projectParams",attrs:{model:e.projectParams,rules:e.rules}},[o("el-form-item",{attrs:{prop:"projectId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入项目"},on:{change:e.handleProjectChange},model:{value:e.projectParams.projectId,callback:function(t){e.$set(e.projectParams,"projectId",e._n(t))},expression:"projectParams.projectId"}},e._l(e.projects,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{prop:"amount"}},[o("el-input",{attrs:{placeholder:"请输入数量"},model:{value:e.projectParams.amount,callback:function(t){e.$set(e.projectParams,"amount",e._n(t))},expression:"projectParams.amount"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"operatorId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入操作员"},model:{value:e.projectParams.operatorId,callback:function(t){e.$set(e.projectParams,"operatorId",e._n(t))},expression:"projectParams.operatorId"}},e._l(e.employees,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("projectParams")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("projectParams")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var hn={name:"AppointmentFinish",data:function(){return{newProject:{customerMobile:"",consumeType:3,consumeMoney:0,paymentWay:"",payWayId:"",payWayContentId:"",couponAmount:0,remark:"",consultantId:"",salesManId:"",projects:[]},rules:{customerMobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{type:"number",message:"手机号必须是数字",trigger:"blur"}],consumeMoney:[{required:!0,message:"消费金额不能为空",trigger:"blur"},{type:"number",message:"消费金额必须是数字",trigger:"blur"}],paymentWay:[{required:!0,message:"支付方式不能为空",trigger:"blur"},{type:"number",message:"支付方式必须是数字",trigger:"blur"}],consultantId:[{required:!0,message:"顾问不能为空",trigger:"blur"},{type:"number",message:"顾问必须是数字",trigger:"blur"}],salesManId:[{required:!0,message:"销售员为空",trigger:"blur"},{type:"number",message:"销售员必须是数字",trigger:"blur"}]},paymentWays:[{name:"会员卡",value:1},{name:"活动",value:2},{name:"现金",value:3},{name:"现金+会员卡代金券",value:31},{name:"现金+活动代金券",value:32},{name:"赠送",value:4}],loading:!1,enterFlag:!0,projectsDialog:!1,projectsCopy:[],cardContents:[],cardCoupons:[],cardContentDetail:[],cardCouponContentDetail:[],activityContents:[],activityCoupons:[],activityContentDetail:[],activityCouponContentDetail:[],maxAmount:1,card:{id:"",remainingMoney:"",projectDiscount:"",uniqueIdentifier:""},cardCoupon:{id:""},activity:{id:""},activityCoupon:{id:""}}},computed:{consultants:function(){return this.$store.state.employee.consultants},salesMans:function(){return this.$store.state.employee.salesMans}},watch:{projectsCopy:function(e,t){3===this.newProject.paymentWay&&(this.newProject.consumeMoney=this.getPriceByProjects(e)),31===this.newProject.paymentWay&&""!=cardCoupon.id&&cardCoupon.projectDiscount}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;0==t.newProject.projects.length?t.$message.error("请添加项目!"):(t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addConsumeRecord",t.handleData(t.newProject)).then(function(e){0===e.code&&t.$store.dispatch("finishAppointment",t.$route.params.id).then(function(e){0===e.code&&(t.$message.success("预约完成"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/appointment"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)}))})},handleAddAProject:function(e){var t=this.$store.getters.getProjectFromAllById(e.projectId),o=this.$store.getters.getEmployeeFromAllById(e.operatorId);this.projectsCopy.push({id:t.id,name:t.name,amount:e.amount,unitPrice:t.unitPrice,operatorName:o.name}),this.newProject.projects.push({projectId:e.projectId,amount:e.amount,operatorId:e.operatorId})},handleDelete:function(e,t){this.projectsCopy.splice(e,1),this.newProject.projects.splice(e,1)},handlePaymentWaySelect:function(e){var t=this;this.newProject.payWayId="",this.newProject.payWayContentId="",this.newProject.couponAmount=0,1===e?(this.activity.id="",this.cardCoupon.id="",this.activityCoupon.id="",""===this.newProject.customerMobile?(this.newProject.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerCardPay",{customerMobile:this.newProject.customerMobile,paymentWay:1}).then(function(e){t.cardContents=e.data}).catch(function(e){console.log(e)})):2===e?(this.newProject.consumeMoney=0,this.card.id="",this.cardCoupon.id="",this.activityCoupon.id="",""===this.newProject.customerMobile?(this.newProject.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerActivityPay",{customerMobile:this.newProject.customerMobile,paymentWay:2}).then(function(e){t.activityContents=e.data}).catch(function(e){console.log(e)})):3===e?(this.newProject.consumeMoney=0,this.card.id="",this.activity.id="",this.cardCoupon.id="",this.activityCoupon.id=""):31===e?(this.card.id="",this.activity.id="",this.activityCoupon.id="",""===this.newProject.customerMobile?(this.newProject.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerCardPay",{customerMobile:this.newProject.customerMobile,paymentWay:31}).then(function(e){t.cardCoupons=e.data}).catch(function(e){console.log(e)})):(this.card.id="",this.activity.id="",this.cardCoupon.id="",""===this.newProject.customerMobile?(this.newProject.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerActivityPay",{customerMobile:this.newProject.customerMobile,paymentWay:32}).then(function(e){t.activityCoupons=e.data}).catch(function(e){console.log(e)}))},handleCardContentSelect:function(e){var t=this.$store.getters.getCustomerCardPayById(e);this.card.id=t.id,this.card.remainingMoney=t.remainingMoney,this.card.projectDiscount=t.projectDiscount,this.card.uniqueIdentifier=t.uniqueIdentifier,this.cardContentDetail=t.customerMemberCardContent},handleCardCouponSelect:function(e){var t=this.$store.getters.getCustomerCardPayById(e);this.cardCoupon.id=t.id,this.cardCoupon.projectDiscount=t.projectDiscount,this.cardCoupon.uniqueIdentifier=t.uniqueIdentifier,this.cardCouponContentDetail=t.customerMemberCardContent,this.newProject.payWayContentId="",this.newProject.couponAmount=0},handleCardCouponDetailSelect:function(e){this.newProject.couponAmount=0},handleActivityContentSelect:function(e){var t=this.$store.getters.getCustomerActivityPayById(e);this.activity.id=t.id,this.activityContentDetail=t.customerActivityContents},handleActivityCouponSelect:function(e){var t=this.$store.getters.getCustomerActivityPayById(e);this.activityCoupon.id=t.id,this.activityCouponContentDetail=t.customerActivityContents,this.newProject.payWayContentId="",this.newProject.couponAmount=0},handleActivityCouponDetailSelect:function(e){this.newProject.couponAmount=0},handleData:function(e){var t={consumeRecordPo:{customerMobile:"",consumeType:"",consumeMoney:"",paymentWay:"",payWayId:"",payWayContentId:"",couponAmount:"",remark:""},consumeRecordDetails:[]};t.consumeRecordPo.customerMobile=e.customerMobile,t.consumeRecordPo.consumeType=e.consumeType,t.consumeRecordPo.consumeMoney=e.consumeMoney,t.consumeRecordPo.paymentWay=e.paymentWay,t.consumeRecordPo.payWayId=e.payWayId,t.consumeRecordPo.payWayContentId=e.payWayContentId,t.consumeRecordPo.couponAmount=e.couponAmount,t.consumeRecordPo.remark=e.remark;var o=!0,n=!1,r=void 0;try{for(var a,i=k()(e.projects);!(o=(a=i.next()).done);o=!0){var s=a.value;t.consumeRecordDetails.push({projectId:s.projectId,amount:s.amount,operatorId:s.operatorId,consultantId:e.consultantId,salesManId:e.salesManId})}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return t},getPriceByProjects:function(e){var t=0,o=!0,n=!1,r=void 0;try{for(var a,i=k()(e);!(o=(a=i.next()).done);o=!0){var s=a.value;t+=s.amount*s.unitPrice}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return t},loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){e.$store.dispatch("loadProjectAll").then(function(t){var o=e.$store.getters.getAppointmentById(e.$route.params.id);e.newProject.customerMobile=Y()(o.customerMobile);var n=!0,r=!1,a=void 0;try{for(var i,s=k()(o.appointmentProjects);!(n=(i=s.next()).done);n=!0){var l=i.value,c=e.$store.getters.getProjectFromAllById(l.projectId),u=e.$store.getters.getEmployeeFromAllById(l.employeeId);e.projectsCopy.push({id:c.id,name:c.name,amount:1,unitPrice:c.unitPrice,operatorName:u.name}),e.newProject.projects.push({projectId:c.id,amount:1,operatorId:u.id})}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}}).catch(function(e){console.log(e)})}).catch(function(e){console.log(e)})},loadConsultants:function(){var e=this;this.$store.dispatch("loadEmployeeByTopType",4).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadSalesMans:function(){var e=this;this.$store.dispatch("loadEmployeeByWorkType",3).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},calConsumeRecord:function(){var e=this;this.$refs.newProject.validate(function(t){if(!t)return!1;0==e.newProject.projects.length?e.$message.error("请添加项目!"):e.$store.dispatch("calConsumeRecord",e.handleData(e.newProject)).then(function(t){e.newProject.consumeMoney=t.data}).catch(function(e){console.log(e)})})}},beforeMount:function(){0===this.$store.state.appointment.appointments.length?this.$router.push({path:"/appointment"}):(this.loadEmployeeAll(),this.loadConsultants(),this.loadSalesMans())},components:{AProject:o("X4nt")(pn,fn,!1,function(e){o("c4cD")},"data-v-1cd7976e",null).exports}},gn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"AppointmentFinish"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/appointment"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("完成预约")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newProject",staticClass:"new-form",attrs:{model:e.newProject,"label-width":"120px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newProject")}}},[o("el-form-item",{attrs:{label:"手机",prop:"customerMobile"}},[o("el-input",{attrs:{placeholder:"请输入手机",autofocus:!0},model:{value:e.newProject.customerMobile,callback:function(t){e.$set(e.newProject,"customerMobile",e._n(t))},expression:"newProject.customerMobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"消费金额(￥)",prop:"consumeMoney"}},[o("el-input",{attrs:{placeholder:"请输入消费金额"},model:{value:e.newProject.consumeMoney,callback:function(t){e.$set(e.newProject,"consumeMoney",e._n(t))},expression:"newProject.consumeMoney"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"支付方式",prop:"paymentWay"}},[o("el-select",{attrs:{placeholder:"请选择支付方式"},on:{change:e.handlePaymentWaySelect},model:{value:e.newProject.paymentWay,callback:function(t){e.$set(e.newProject,"paymentWay",e._n(t))},expression:"newProject.paymentWay"}},e._l(e.paymentWays,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),1===e.newProject.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户会员卡"},on:{change:e.handleCardContentSelect},model:{value:e.newProject.payWayId,callback:function(t){e.$set(e.newProject,"payWayId",e._n(t))},expression:"newProject.payWayId"}},e._l(e.cardContents,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.memberCardName,value:e.id}})}))],1):e._e(),e._v(" "),2===e.newProject.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户活动"},on:{change:e.handleActivityContentSelect},model:{value:e.newProject.payWayId,callback:function(t){e.$set(e.newProject,"payWayId",e._n(t))},expression:"newProject.payWayId"}},e._l(e.activityContents,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.activityName,value:e.id}})}))],1):e._e(),e._v(" "),31===e.newProject.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户卡"},on:{change:e.handleCardCouponSelect},model:{value:e.newProject.payWayId,callback:function(t){e.$set(e.newProject,"payWayId",e._n(t))},expression:"newProject.payWayId"}},e._l(e.cardCoupons,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.memberCardName,value:e.id}})}))],1):e._e(),e._v(" "),32===e.newProject.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户活动"},on:{change:e.handleActivityCouponSelect},model:{value:e.newProject.payWayId,callback:function(t){e.$set(e.newProject,"payWayId",e._n(t))},expression:"newProject.payWayId"}},e._l(e.activityCoupons,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.activityName,value:e.id}})}))],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"会员卡内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.cardContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"relatedName",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"个数"}})],1)],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"储值(￥)"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.remainingMoney,callback:function(t){e.$set(e.card,"remainingMoney",t)},expression:"card.remainingMoney"}})],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"项目折扣(0-100)"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.projectDiscount,callback:function(t){e.$set(e.card,"projectDiscount",t)},expression:"card.projectDiscount"}})],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"卡流水号"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.uniqueIdentifier,callback:function(t){e.$set(e.card,"uniqueIdentifier",t)},expression:"card.uniqueIdentifier"}})],1):e._e(),e._v(" "),""!=e.cardCoupon.id?o("el-form-item",{attrs:{label:"会员卡优惠券"}},[o("el-select",{attrs:{placeholder:"请选择优惠券"},on:{change:e.handleCardCouponDetailSelect},model:{value:e.newProject.payWayContentId,callback:function(t){e.$set(e.newProject,"payWayContentId",e._n(t))},expression:"newProject.payWayContentId"}},e._l(e.cardCouponContentDetail,function(e){return o("el-option",{key:e.id,ref:"",refInFor:!0,attrs:{label:e.content+"-"+e.amount+"张",value:e.id}})}))],1):e._e(),e._v(" "),""!=e.cardCoupon.id?o("el-form-item",{attrs:{label:"数量"}},[o("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.newProject.couponAmount,callback:function(t){e.$set(e.newProject,"couponAmount",t)},expression:"newProject.couponAmount"}})],1):e._e(),e._v(" "),""!=e.activityCoupon.id?o("el-form-item",{attrs:{label:"活动优惠券"}},[o("el-select",{attrs:{placeholder:"请选择优惠券"},on:{change:e.handleActivityCouponDetailSelect},model:{value:e.newProject.payWayContentId,callback:function(t){e.$set(e.newProject,"payWayContentId",e._n(t))},expression:"newProject.payWayContentId"}},e._l(e.activityCouponContentDetail,function(e){return o("el-option",{key:e.id,attrs:{label:e.content+"-"+e.number+"张",value:e.id}})}))],1):e._e(),e._v(" "),""!=e.activityCoupon.id?o("el-form-item",{attrs:{label:"数量"}},[o("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.newProject.couponAmount,callback:function(t){e.$set(e.newProject,"couponAmount",t)},expression:"newProject.couponAmount"}})],1):e._e(),e._v(" "),""!=e.activity.id?o("el-form-item",{attrs:{label:"活动内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.activityContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"relatedName",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"number",label:"个数"}})],1)],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"顾问"}},[o("el-select",{attrs:{placeholder:"请输入顾问名称",filterable:""},model:{value:e.newProject.consultantId,callback:function(t){e.$set(e.newProject,"consultantId",e._n(t))},expression:"newProject.consultantId"}},e._l(e.consultants,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"销售员"}},[o("el-select",{attrs:{placeholder:"请输入销售员名称",filterable:""},model:{value:e.newProject.salesManId,callback:function(t){e.$set(e.newProject,"salesManId",e._n(t))},expression:"newProject.salesManId"}},e._l(e.salesMans,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"项目"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.projectsCopy,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitPrice",label:"价格"}}),e._v(" "),o("el-table-column",{attrs:{prop:"operatorName",label:"操作员"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newProject.remark,callback:function(t){e.$set(e.newProject,"remark","string"==typeof t?t.trim():t)},expression:"newProject.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{on:{click:function(t){e.projectsDialog=!0}}},[e._v("添加项目")]),e._v(" "),o("el-button",{on:{click:function(t){e.calConsumeRecord()}}},[e._v("结算")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newProject")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("AProject",{attrs:{visible:e.projectsDialog},on:{closeDialog:function(t){e.projectsDialog=!1},addAProject:e.handleAddAProject}})],1)},staticRenderFns:[]};var vn=o("X4nt")(hn,gn,!1,function(e){o("g3g/")},"data-v-6c1332fa",null).exports,yn={name:"ConsumeRecordCard",data:function(){return{consumeRecordCardSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,consumeType:1},loading:!1,cardGiftContentDetail:[],cardGiftContentVisible:!1}},computed:{pageNum:function(){return this.$store.state.consumeRecord.pageNum},pageSize:function(){return this.$store.state.consumeRecord.pageSize},totalCount:function(){return this.$store.state.consumeRecord.totalCount},totalPages:function(){return this.$store.state.consumeRecord.totalPages},tableData:function(){return this.$store.state.consumeRecord.consumeRecords}},methods:{searchConsumeCardRecord:function(e){var t=this;this.loading=!0,"search"===e&&(this.consumeRecordCardSearch.oldContent=this.consumeRecordCardSearch.content),this.consumeRecordCardSearch.type=e,this.$store.dispatch("loadConsumeRecord",this.consumeRecordCardSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.consumeRecordCardSearch.pageNum=e,this.searchConsumeCardRecord("page")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleModified:function(e,t){return 0===e.isModified?"否":"是"},handleEdit:function(e,t){},handlePrint:function(e,t){var o=this;this.$message({message:"打印数据加载中",iconClass:"el-icon-loading",duration:0}),this.$store.dispatch("printConsumeRecord",{consumeRecordId:t.id}).then(function(e){console.log(o.$store.state.consumeRecord.consumeRecordPrint),o.$message.closeAll(),o.$router.push({path:"/print-card-record"})}).catch(function(e){console.log(e)})},handleCardGiftDetail:function(e,t){this.cardGiftContentDetail=[];var o=this.$store.getters.getConsumeRecordById(t.id),n=!0,r=!1,a=void 0;try{for(var i,s=k()(o.consumeRecordGiftUnion);!(n=(i=s.next()).done);n=!0){var l=i.value;l.productId?this.cardGiftContentDetail.push({type:"产品",name:l.productName,amount:l.productAmount}):l.projectId?this.cardGiftContentDetail.push({type:"项目",name:l.projectName,amount:l.projectAmount}):this.cardGiftContentDetail.push({type:"代金券",name:l.couponMoney,amount:l.couponAmount})}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}this.cardGiftContentVisible=!0},onClose:function(e){this.cardGiftContentVisible=!1,this.cardGiftContentDetail=[]}},beforeMount:function(){this.searchConsumeCardRecord("search")}},bn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ConsumeRecordCard"},[o("el-form",{ref:"consumeRecordCardSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.consumeRecordCardSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchConsumeCardRecord("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.consumeRecordCardSearch.content,callback:function(t){e.$set(e.consumeRecordCardSearch,"content","string"==typeof t?t.trim():t)},expression:"consumeRecordCardSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchConsumeCardRecord("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/consume-record-card/new-card"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("办卡")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"tradeSerialNumber",label:"流水号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerMobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"consumeMoney",label:"消费金额"}}),e._v(" "),o("el-table-column",{attrs:{prop:"paymentWayName",label:"支付方式"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isModified",label:"是否修改",formatter:e.handleModified}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{prop:"cardName",label:"卡名"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n          "+e._s(t.row.consumeRecordDetailUnion[0].cardName)+"\n      ")]}}])}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"220px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleCardGiftDetail(t.$index,t.row)}}},[e._v("详情")]),e._v(" "),o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handlePrint(t.$index,t.row)}}},[e._v("打印")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"办卡赠品详情",visible:e.cardGiftContentVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.cardGiftContentVisible=t}}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.cardGiftContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"内容/金额"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"个数"}})],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onClose("")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Cn=o("X4nt")(yn,bn,!1,function(e){o("q+ug")},"data-v-b3db950a",null).exports,_n={name:"CardGift",props:["visible"],data:function(){return{cardGiftForm:{type:"",projectId:"",productId:"",couponMoney:"",amount:""},rules:{type:[{required:!0,message:"类型不能为空",trigger:"blur"},{type:"number",message:"类型必须是数字",trigger:"blur"}],amount:[{required:!0,message:"数量不能为空",trigger:"blur"},{type:"number",message:"数量必须是数字",trigger:"blur"}]},types:[{name:"项目",value:1},{name:"产品",value:2},{name:"代金券",value:3}]}},computed:{isVisible:function(){return this.visible},projects:function(){return this.$store.state.project.projectsAll},products:function(){return this.$store.state.product.productsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.$emit("addCardGift",t.cardGiftForm),t.$emit("closeDialog",!1),t.$refs[e].resetFields()})},onClose:function(e){this.$emit("closeDialog",!1),this.$refs[e].resetFields()},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadProductAll:function(){var e=this;this.$store.dispatch("loadProductAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadProjectAll(),this.loadProductAll()}},kn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CardGift"},[o("el-dialog",{attrs:{title:"赠品",visible:e.isVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[o("el-form",{ref:"cardGiftForm",attrs:{model:e.cardGiftForm,rules:e.rules}},[o("el-form-item",{attrs:{prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择类型"},model:{value:e.cardGiftForm.type,callback:function(t){e.$set(e.cardGiftForm,"type",e._n(t))},expression:"cardGiftForm.type"}},e._l(e.types,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),1===e.cardGiftForm.type?o("el-form-item",{attrs:{prop:"projectId"}},[o("el-select",{attrs:{placeholder:"请输入项目名",filterable:""},model:{value:e.cardGiftForm.projectId,callback:function(t){e.$set(e.cardGiftForm,"projectId",e._n(t))},expression:"cardGiftForm.projectId"}},e._l(e.projects,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1):e._e(),e._v(" "),2===e.cardGiftForm.type?o("el-form-item",{attrs:{prop:"productId"}},[o("el-select",{attrs:{placeholder:"请输入产品名",filterable:""},model:{value:e.cardGiftForm.productId,callback:function(t){e.$set(e.cardGiftForm,"productId",e._n(t))},expression:"cardGiftForm.productId"}},e._l(e.products,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1):e._e(),e._v(" "),3===e.cardGiftForm.type?o("el-form-item",{attrs:{prop:"couponMoney"}},[o("el-input",{attrs:{placeholder:"请输入代金券金额"},model:{value:e.cardGiftForm.couponMoney,callback:function(t){e.$set(e.cardGiftForm,"couponMoney",e._n(t))},expression:"cardGiftForm.couponMoney"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{prop:"amount"}},[o("el-input",{attrs:{placeholder:"请输入数量"},model:{value:e.cardGiftForm.amount,callback:function(t){e.$set(e.cardGiftForm,"amount",e._n(t))},expression:"cardGiftForm.amount"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("cardGiftForm")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("cardGiftForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var wn={name:"ConsumeRecordNewCard",data:function(){return{newCard:{customerMobile:"",consumeType:1,consumeMoney:"",paymentWay:3,remark:"",cardId:"",amount:1,consultantId:"",salesManId:"",id:"",type:"",projectId:"",times:"",cardAmount:"",projectDiscount:"",productDiscount:"",cardRemark:"",gifts:[]},rules:{customerMobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{type:"number",message:"手机号必须是数字",trigger:"blur"}],consumeMoney:[{required:!0,message:"消费金额不能为空",trigger:"blur"},{type:"number",message:"消费金额必须是数字",trigger:"blur"}],cardId:[{required:!0,message:"会员卡不能为空",trigger:"blur"},{type:"number",message:"会员卡必须是数字",trigger:"blur"}],consultantId:[{required:!0,message:"顾问不能为空",trigger:"blur"},{type:"number",message:"顾问必须是数字",trigger:"blur"}],salesManId:[{required:!0,message:"销售员为空",trigger:"blur"},{type:"number",message:"销售员必须是数字",trigger:"blur"}]},cardTypes:[{name:"次卡",value:1},{name:"储值卡",value:2},{name:"混合卡",value:3}],loading:!1,enterFlag:!0,cardGiftsDialog:!1,cardGiftsCopy:[]}},computed:{memberCards:function(){return this.$store.state.memberCard.memberCardsAll},consultants:function(){return this.$store.state.employee.consultants},salesMans:function(){return this.$store.state.employee.salesMans},projects:function(){return this.$store.state.project.projectsAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addConsumeRecord",t.handleData(t.newCard)).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/consume-record-card"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleAddCardGift:function(e){var t=void 0,o=void 0,n=e.amount;if(1===e.type){t="项目";var r=this.$store.getters.getProjectFromAllById(e.projectId);o=r.code+"-"+r.name,this.newCard.gifts.push({type:1,projectId:e.projectId,projectAmount:e.amount})}else if(2===e.type){t="产品";var a=this.$store.getters.getProductFromAllById(e.productId);o=a.code+"-"+a.name,this.newCard.gifts.push({type:2,productId:e.productId,productAmount:e.amount})}else t="代金券",o=e.couponMoney,this.newCard.gifts.push({type:3,couponMoney:e.couponMoney,couponAmount:e.amount});this.cardGiftsCopy.push({type:t,name:o,amount:n})},handleDelete:function(e,t){this.cardGiftsCopy.splice(e,1),this.newCard.gifts.splice(e,1)},handleCardSelect:function(e){this.newCard.id="",this.newCard.type="",this.newCard.projectId="",this.newCard.times="",this.newCard.cardAmount="",this.newCard.projectDiscount="",this.newCard.productDiscount="",this.newCard.cardRemark="";var t=this.$store.getters.getMemberCardFromAllById(e);this.newCard.consumeMoney=t.price,this.newCard.cardId=e,this.newCard.id=t.id,this.newCard.type=t.type,this.newCard.projectId=t.projectId,this.newCard.times=t.times,this.newCard.cardAmount=t.amount,this.newCard.projectDiscount=t.projectDiscount,this.newCard.productDiscount=t.productDiscount,this.newCard.cardRemark=t.remark},handleChangeType:function(e){1===e?this.newCard.cardAmount="":2===e&&(this.newCard.times="",this.newCard.projectId="")},handleData:function(e){var t={consumeRecordPo:{customerMobile:"",consumeType:"",consumeMoney:"",paymentWay:"",remark:""},consumeRecordDetails:[],memberCardPo:{id:"",type:"",projectId:"",times:"",amount:"",projectDiscount:"",productDiscount:"",remark:""},gifts:[]};return t.consumeRecordPo.customerMobile=e.customerMobile,t.consumeRecordPo.consumeType=e.consumeType,t.consumeRecordPo.consumeMoney=e.consumeMoney,t.consumeRecordPo.paymentWay=e.paymentWay,t.consumeRecordPo.remark=e.remark,t.consumeRecordDetails.push({cardId:e.cardId,amount:e.amount,consultantId:e.consultantId,salesManId:e.salesManId}),t.memberCardPo.id=e.id,t.memberCardPo.type=e.type,t.memberCardPo.projectId=e.projectId,t.memberCardPo.times=e.times,t.memberCardPo.amount=e.cardAmount,t.memberCardPo.projectDiscount=e.projectDiscount,t.memberCardPo.productDiscount=e.productDiscount,t.memberCardPo.remark=e.cardRemark,t.gifts=e.gifts,t},loadMemberCardAll:function(){var e=this;this.$store.dispatch("loadMemberCardAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadConsultants:function(){var e=this;this.$store.dispatch("loadEmployeeByTopType",4).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadSalesMans:function(){var e=this;this.$store.dispatch("loadEmployeeByWorkType",3).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadMemberCardAll(),this.loadEmployeeAll(),this.loadProjectAll(),this.loadConsultants(),this.loadSalesMans()},components:{CardGift:o("X4nt")(_n,kn,!1,function(e){o("Zs1h")},"data-v-256987a4",null).exports}},Pn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ConsumeRecordNewCard"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/consume-record-card"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("办卡")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newCard",staticClass:"new-form",attrs:{model:e.newCard,"label-width":"120px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newCard")}}},[o("el-form-item",{attrs:{label:"手机",prop:"customerMobile"}},[o("el-input",{attrs:{placeholder:"请输入手机",autofocus:!0},model:{value:e.newCard.customerMobile,callback:function(t){e.$set(e.newCard,"customerMobile",e._n(t))},expression:"newCard.customerMobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"会员卡"}},[o("el-select",{attrs:{placeholder:"请输入会员卡名",filterable:""},on:{change:e.handleCardSelect},model:{value:e.newCard.cardId,callback:function(t){e.$set(e.newCard,"cardId",e._n(t))},expression:"newCard.cardId"}},e._l(e.memberCards,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"消费金额(￥)",prop:"consumeMoney"}},[o("el-input",{attrs:{placeholder:"请输入消费金额"},model:{value:e.newCard.consumeMoney,callback:function(t){e.$set(e.newCard,"consumeMoney",e._n(t))},expression:"newCard.consumeMoney"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newCard.remark,callback:function(t){e.$set(e.newCard,"remark","string"==typeof t?t.trim():t)},expression:"newCard.remark"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"顾问"}},[o("el-select",{attrs:{placeholder:"请输入顾问名称",filterable:""},model:{value:e.newCard.consultantId,callback:function(t){e.$set(e.newCard,"consultantId",e._n(t))},expression:"newCard.consultantId"}},e._l(e.consultants,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"销售员"}},[o("el-select",{attrs:{placeholder:"请输入销售员名称",filterable:""},model:{value:e.newCard.salesManId,callback:function(t){e.$set(e.newCard,"salesManId",e._n(t))},expression:"newCard.salesManId"}},e._l(e.salesMans,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"类型",prop:"type"}},[o("el-select",{attrs:{placeholder:"请选择类型",disabled:!0},on:{change:e.handleChangeType},model:{value:e.newCard.type,callback:function(t){e.$set(e.newCard,"type",e._n(t))},expression:"newCard.type"}},e._l(e.cardTypes,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),1===e.newCard.type||3===e.newCard.type?o("el-form-item",{attrs:{label:"项目",prop:"projectId"}},[o("el-select",{attrs:{placeholder:"请选择项目",filterable:""},model:{value:e.newCard.projectId,callback:function(t){e.$set(e.newCard,"projectId",e._n(t))},expression:"newCard.projectId"}},e._l(e.projects,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1):e._e(),e._v(" "),1===e.newCard.type||3===e.newCard.type?o("el-form-item",{attrs:{label:"次数",prop:"times"}},[o("el-input",{attrs:{placeholder:"请输入次数"},model:{value:e.newCard.times,callback:function(t){e.$set(e.newCard,"times",e._n(t))},expression:"newCard.times"}})],1):e._e(),e._v(" "),2===e.newCard.type||3===e.newCard.type?o("el-form-item",{attrs:{label:"储值卡总额",prop:"cardAmount"}},[o("el-input",{attrs:{placeholder:"请输入总额"},model:{value:e.newCard.cardAmount,callback:function(t){e.$set(e.newCard,"cardAmount",e._n(t))},expression:"newCard.cardAmount"}})],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"项目折扣(0-100)",prop:"projectDiscount"}},[o("el-input",{attrs:{placeholder:"请输入项目折扣"},model:{value:e.newCard.projectDiscount,callback:function(t){e.$set(e.newCard,"projectDiscount",e._n(t))},expression:"newCard.projectDiscount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"产品折扣(0-100)",prop:"productDiscount"}},[o("el-input",{attrs:{placeholder:"请输入产品折扣"},model:{value:e.newCard.productDiscount,callback:function(t){e.$set(e.newCard,"productDiscount",e._n(t))},expression:"newCard.productDiscount"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newCard.cardRemark,callback:function(t){e.$set(e.newCard,"cardRemark","string"==typeof t?t.trim():t)},expression:"newCard.cardRemark"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"赠品"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.cardGiftsCopy,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称/金额"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",[o("el-button",{on:{click:function(t){e.cardGiftsDialog=!0}}},[e._v("添加赠品")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newCard")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("CardGift",{attrs:{visible:e.cardGiftsDialog},on:{closeDialog:function(t){e.cardGiftsDialog=!1},addCardGift:e.handleAddCardGift}})],1)},staticRenderFns:[]};var Fn=o("X4nt")(wn,Pn,!1,function(e){o("/5+l")},"data-v-22e59efd",null).exports,Sn={name:"ConsumeRecordProduct",data:function(){return{consumeRecordProductSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,consumeType:2},loading:!1,productContentDetail:[],productContentVisible:!1}},computed:{pageNum:function(){return this.$store.state.consumeRecord.pageNum},pageSize:function(){return this.$store.state.consumeRecord.pageSize},totalCount:function(){return this.$store.state.consumeRecord.totalCount},totalPages:function(){return this.$store.state.consumeRecord.totalPages},tableData:function(){return this.$store.state.consumeRecord.consumeRecords}},methods:{searchConsumeProductRecord:function(e){var t=this;this.loading=!0,"search"===e&&(this.consumeRecordProductSearch.oldContent=this.consumeRecordProductSearch.content),this.consumeRecordProductSearch.type=e,this.$store.dispatch("loadConsumeRecord",this.consumeRecordProductSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.consumeRecordProductSearch.pageNum=e,this.searchConsumeProductRecord("page")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleModified:function(e,t){return 0===e.isModified?"否":"是"},handleEdit:function(e,t){},handleProductDetail:function(e,t){this.productContentDetail=[];var o=this.$store.getters.getConsumeRecordById(t.id),n=!0,r=!1,a=void 0;try{for(var i,s=k()(o.consumeRecordDetailUnion);!(n=(i=s.next()).done);n=!0){var l=i.value;this.productContentDetail.push({productName:l.productName,amount:l.amount})}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}this.productContentVisible=!0},onClose:function(e){this.productContentVisible=!1,this.productContentDetail=[]}},beforeMount:function(){this.searchConsumeProductRecord("search")}},$n={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ConsumeRecordProduct"},[o("el-form",{ref:"consumeRecordProductSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.consumeRecordProductSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchConsumeProductRecord("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.consumeRecordProductSearch.content,callback:function(t){e.$set(e.consumeRecordProductSearch,"content","string"==typeof t?t.trim():t)},expression:"consumeRecordProductSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchConsumeProductRecord("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/consume-record-product/new-product"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("买产品")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"tradeSerialNumber",label:"流水号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerMobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"consumeMoney",label:"消费金额"}}),e._v(" "),o("el-table-column",{attrs:{prop:"paymentWayName",label:"支付方式"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isModified",label:"是否修改",formatter:e.handleModified}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"220px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleProductDetail(t.$index,t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"产品详情",visible:e.productContentVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.productContentVisible=t}}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.productContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"productName",label:"产品名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"个数"}})],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onClose("")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var xn=o("X4nt")(Sn,$n,!1,function(e){o("/b+I")},"data-v-79457ea6",null).exports,jn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CRProduct"},[o("el-dialog",{attrs:{title:"产品",visible:e.isVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[o("el-form",{ref:"productParams",attrs:{model:e.productParams,rules:e.rules}},[o("el-form-item",{attrs:{prop:"productId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入关键词"},model:{value:e.productParams.productId,callback:function(t){e.$set(e.productParams,"productId",e._n(t))},expression:"productParams.productId"}},e._l(e.products,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name+"("+e.unitName+")",value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{prop:"amount"}},[o("el-input",{attrs:{placeholder:"请输入数量"},model:{value:e.productParams.amount,callback:function(t){e.$set(e.productParams,"amount",e._n(t))},expression:"productParams.amount"}})],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("productParams")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("productParams")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var An={name:"ConsumeRecordNewProduct",data:function(){return{newProduct:{customerMobile:"",consumeType:2,consumeMoney:0,paymentWay:"",payWayId:"",payWayContentId:"",couponAmount:0,remark:"",consultantId:"",salesManId:"",products:[]},rules:{customerMobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{type:"number",message:"手机号必须是数字",trigger:"blur"}],consumeMoney:[{required:!0,message:"消费金额不能为空",trigger:"blur"},{type:"number",message:"消费金额必须是数字",trigger:"blur"}],paymentWay:[{required:!0,message:"支付方式不能为空",trigger:"blur"},{type:"number",message:"支付方式必须是数字",trigger:"blur"}],consultantId:[{required:!0,message:"顾问不能为空",trigger:"blur"},{type:"number",message:"顾问必须是数字",trigger:"blur"}],salesManId:[{required:!0,message:"销售员为空",trigger:"blur"},{type:"number",message:"销售员必须是数字",trigger:"blur"}]},paymentWays:[{name:"会员卡",value:1},{name:"活动",value:2},{name:"现金",value:3},{name:"现金+会员卡代金券",value:31},{name:"现金+活动代金券",value:32},{name:"赠送",value:4}],loading:!1,enterFlag:!0,prductsDialog:!1,productsCopy:[],cardContents:[],cardCoupons:[],cardContentDetail:[],cardCouponContentDetail:[],activityContents:[],activityCoupons:[],activityContentDetail:[],activityCouponContentDetail:[],maxAmount:1,card:{id:"",remainingMoney:"",productDiscount:"",uniqueIdentifier:""},cardCoupon:{id:""},activity:{id:""},activityCoupon:{id:""}}},computed:{consultants:function(){return this.$store.state.employee.consultants},salesMans:function(){return this.$store.state.employee.salesMans}},watch:{productsCopy:function(e,t){3===this.newProduct.paymentWay&&(this.newProduct.consumeMoney=this.getPriceByProducts(e)),31===this.newProduct.paymentWay&&""!=cardCoupon.id&&cardCoupon.productDiscount}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;0==t.newProduct.products.length?t.$message.error("请添加产品!"):(t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addConsumeRecord",t.handleData(t.newProduct)).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/consume-record"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)}))})},handleAddCRProduct:function(e){var t=this.$store.getters.getProductFromStoreAllById(e.productId);this.productsCopy.push({id:t.id,name:t.name,amount:e.amount,unitName:t.unitName,unitPrice:t.unitPrice}),this.newProduct.products.push({productId:e.productId,amount:e.amount})},handleDelete:function(e,t){this.productsCopy.splice(e,1),this.newProduct.products.splice(e,1)},handlePaymentWaySelect:function(e){var t=this;this.newProduct.payWayId="",this.newProduct.payWayContentId="",this.newProduct.couponAmount=0,1===e?(this.activity.id="",this.cardCoupon.id="",this.activityCoupon.id="",""===this.newProduct.customerMobile?(this.newProduct.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerCardPay",{customerMobile:this.newProduct.customerMobile,paymentWay:1}).then(function(e){t.cardContents=e.data}).catch(function(e){console.log(e)})):2===e?(this.newProduct.consumeMoney=0,this.card.id="",this.cardCoupon.id="",this.activityCoupon.id="",""===this.newProduct.customerMobile?(this.newProduct.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerActivityPay",{customerMobile:this.newProduct.customerMobile,paymentWay:2}).then(function(e){t.activityContents=e.data}).catch(function(e){console.log(e)})):3===e?(this.newProduct.consumeMoney=0,this.card.id="",this.activity.id="",this.cardCoupon.id="",this.activityCoupon.id=""):31===e?(this.card.id="",this.activity.id="",this.activityCoupon.id="",""===this.newProduct.customerMobile?(this.newProduct.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerCardPay",{customerMobile:this.newProduct.customerMobile,paymentWay:31}).then(function(e){t.cardCoupons=e.data}).catch(function(e){console.log(e)})):(this.card.id="",this.activity.id="",this.cardCoupon.id="",""===this.newProduct.customerMobile?(this.newProduct.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerActivityPay",{customerMobile:this.newProduct.customerMobile,paymentWay:32}).then(function(e){t.activityCoupons=e.data}).catch(function(e){console.log(e)}))},handleCardContentSelect:function(e){var t=this.$store.getters.getCustomerCardPayById(e);this.card.id=t.id,this.card.remainingMoney=t.remainingMoney,this.card.productDiscount=t.productDiscount,this.card.uniqueIdentifier=t.uniqueIdentifier,this.cardContentDetail=t.customerMemberCardContent},handleCardCouponSelect:function(e){var t=this.$store.getters.getCustomerCardPayById(e);this.cardCoupon.id=t.id,this.cardCoupon.productDiscount=t.productDiscount,this.cardCoupon.uniqueIdentifier=t.uniqueIdentifier,this.cardCouponContentDetail=t.customerMemberCardContent,this.newProduct.payWayContentId="",this.newProduct.couponAmount=0},handleCardCouponDetailSelect:function(e){this.newProduct.couponAmount=0},handleActivityContentSelect:function(e){var t=this.$store.getters.getCustomerActivityPayById(e);this.activity.id=t.id,this.activityContentDetail=t.customerActivityContents},handleActivityCouponSelect:function(e){var t=this.$store.getters.getCustomerActivityPayById(e);this.activityCoupon.id=t.id,this.activityCouponContentDetail=t.customerActivityContents,this.newProduct.payWayContentId="",this.newProduct.couponAmount=0},handleActivityCouponDetailSelect:function(e){this.newProduct.couponAmount=0},handleData:function(e){var t={consumeRecordPo:{customerMobile:"",consumeType:"",consumeMoney:"",paymentWay:"",payWayId:"",payWayContentId:"",couponAmount:"",remark:""},consumeRecordDetails:[]};t.consumeRecordPo.customerMobile=e.customerMobile,t.consumeRecordPo.consumeType=e.consumeType,t.consumeRecordPo.consumeMoney=e.consumeMoney,t.consumeRecordPo.paymentWay=e.paymentWay,t.consumeRecordPo.payWayId=e.payWayId,t.consumeRecordPo.payWayContentId=e.payWayContentId,t.consumeRecordPo.couponAmount=e.couponAmount,t.consumeRecordPo.remark=e.remark;var o=!0,n=!1,r=void 0;try{for(var a,i=k()(e.products);!(o=(a=i.next()).done);o=!0){var s=a.value;t.consumeRecordDetails.push({productId:s.productId,amount:s.amount,consultantId:e.consultantId,salesManId:e.salesManId})}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return console.log(t),t},getPriceByProducts:function(e){var t=0,o=!0,n=!1,r=void 0;try{for(var a,i=k()(e);!(o=(a=i.next()).done);o=!0){var s=a.value;t+=s.amount*s.unitPrice}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return t},loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadConsultants:function(){var e=this;this.$store.dispatch("loadEmployeeByTopType",4).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadSalesMans:function(){var e=this;this.$store.dispatch("loadEmployeeByWorkType",3).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadProductStoreAll:function(){var e=this;this.$store.dispatch("loadProductStoreAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},calConsumeRecord:function(){var e=this;this.$refs.newProduct.validate(function(t){if(!t)return!1;0==e.newProduct.products.length?e.$message.error("请添加产品!"):e.$store.dispatch("calConsumeRecord",e.handleData(e.newProduct)).then(function(t){e.newProduct.consumeMoney=t.data}).catch(function(e){console.log(e)})})}},beforeMount:function(){this.loadEmployeeAll(),this.loadConsultants(),this.loadSalesMans(),this.loadProductStoreAll()},components:{CRProduct:o("X4nt")({name:"CRProduct",props:["visible"],data:function(){return{productParams:{productId:"",amount:""},rules:{productId:[{required:!0,message:"产品不能为空",trigger:"blur"},{type:"number",message:"产品必须是数字",trigger:"blur"}],amount:[{required:!0,message:"数量不能为空",trigger:"blur"},{type:"number",message:"数量必须是数字",trigger:"blur"}]}}},computed:{isVisible:function(){return this.visible},products:function(){return this.$store.state.product.productsStoreAll}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.$emit("addCRProduct",t.productParams),t.$emit("closeDialog",!1),t.$refs[e].resetFields()})},onClose:function(e){this.$emit("closeDialog",!1),this.$refs[e].resetFields()}}},jn,!1,function(e){o("cU89")},"data-v-6ae115c4",null).exports}},Tn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ConsumeRecordNewProduct"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/consume-record-product"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("买产品")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newProduct",staticClass:"new-form",attrs:{model:e.newProduct,"label-width":"120px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newProduct")}}},[o("el-form-item",{attrs:{label:"手机",prop:"customerMobile"}},[o("el-input",{attrs:{placeholder:"请输入手机",autofocus:!0},model:{value:e.newProduct.customerMobile,callback:function(t){e.$set(e.newProduct,"customerMobile",e._n(t))},expression:"newProduct.customerMobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"消费金额(￥)",prop:"consumeMoney"}},[o("el-input",{attrs:{placeholder:"请输入消费金额"},model:{value:e.newProduct.consumeMoney,callback:function(t){e.$set(e.newProduct,"consumeMoney",e._n(t))},expression:"newProduct.consumeMoney"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"支付方式",prop:"paymentWay"}},[o("el-select",{attrs:{placeholder:"请选择支付方式"},on:{change:e.handlePaymentWaySelect},model:{value:e.newProduct.paymentWay,callback:function(t){e.$set(e.newProduct,"paymentWay",e._n(t))},expression:"newProduct.paymentWay"}},e._l(e.paymentWays,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),1===e.newProduct.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户会员卡"},on:{change:e.handleCardContentSelect},model:{value:e.newProduct.payWayId,callback:function(t){e.$set(e.newProduct,"payWayId",e._n(t))},expression:"newProduct.payWayId"}},e._l(e.cardContents,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.memberCardName,value:e.id}})}))],1):e._e(),e._v(" "),2===e.newProduct.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户活动"},on:{change:e.handleActivityContentSelect},model:{value:e.newProduct.payWayId,callback:function(t){e.$set(e.newProduct,"payWayId",e._n(t))},expression:"newProduct.payWayId"}},e._l(e.activityContents,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.activityName,value:e.id}})}))],1):e._e(),e._v(" "),31===e.newProduct.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户卡"},on:{change:e.handleCardCouponSelect},model:{value:e.newProduct.payWayId,callback:function(t){e.$set(e.newProduct,"payWayId",e._n(t))},expression:"newProduct.payWayId"}},e._l(e.cardCoupons,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.memberCardName,value:e.id}})}))],1):e._e(),e._v(" "),32===e.newProduct.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户活动"},on:{change:e.handleActivityCouponSelect},model:{value:e.newProduct.payWayId,callback:function(t){e.$set(e.newProduct,"payWayId",e._n(t))},expression:"newProduct.payWayId"}},e._l(e.activityCoupons,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.activityName,value:e.id}})}))],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"会员卡内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.cardContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"relatedName",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"个数"}})],1)],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"储值(￥)"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.remainingMoney,callback:function(t){e.$set(e.card,"remainingMoney",t)},expression:"card.remainingMoney"}})],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"产品折扣(0-100)"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.productDiscount,callback:function(t){e.$set(e.card,"productDiscount",t)},expression:"card.productDiscount"}})],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"卡流水号"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.uniqueIdentifier,callback:function(t){e.$set(e.card,"uniqueIdentifier",t)},expression:"card.uniqueIdentifier"}})],1):e._e(),e._v(" "),""!=e.cardCoupon.id?o("el-form-item",{attrs:{label:"会员卡优惠券"}},[o("el-select",{attrs:{placeholder:"请选择优惠券"},on:{change:e.handleCardCouponDetailSelect},model:{value:e.newProduct.payWayContentId,callback:function(t){e.$set(e.newProduct,"payWayContentId",e._n(t))},expression:"newProduct.payWayContentId"}},e._l(e.cardCouponContentDetail,function(e){return o("el-option",{key:e.id,ref:"",refInFor:!0,attrs:{label:e.content+"-"+e.amount+"张",value:e.id}})}))],1):e._e(),e._v(" "),""!=e.cardCoupon.id?o("el-form-item",{attrs:{label:"数量"}},[o("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.newProduct.couponAmount,callback:function(t){e.$set(e.newProduct,"couponAmount",t)},expression:"newProduct.couponAmount"}})],1):e._e(),e._v(" "),""!=e.activityCoupon.id?o("el-form-item",{attrs:{label:"活动优惠券"}},[o("el-select",{attrs:{placeholder:"请选择优惠券"},on:{change:e.handleActivityCouponDetailSelect},model:{value:e.newProduct.payWayContentId,callback:function(t){e.$set(e.newProduct,"payWayContentId",e._n(t))},expression:"newProduct.payWayContentId"}},e._l(e.activityCouponContentDetail,function(e){return o("el-option",{key:e.id,attrs:{label:e.content+"-"+e.number+"张",value:e.id}})}))],1):e._e(),e._v(" "),""!=e.activityCoupon.id?o("el-form-item",{attrs:{label:"数量"}},[o("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.newProduct.couponAmount,callback:function(t){e.$set(e.newProduct,"couponAmount",t)},expression:"newProduct.couponAmount"}})],1):e._e(),e._v(" "),""!=e.activity.id?o("el-form-item",{attrs:{label:"活动内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.activityContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"relatedName",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"number",label:"个数"}})],1)],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"顾问"}},[o("el-select",{attrs:{placeholder:"请输入顾问名称",filterable:""},model:{value:e.newProduct.consultantId,callback:function(t){e.$set(e.newProduct,"consultantId",e._n(t))},expression:"newProduct.consultantId"}},e._l(e.consultants,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"销售员"}},[o("el-select",{attrs:{placeholder:"请输入销售员名称",filterable:""},model:{value:e.newProduct.salesManId,callback:function(t){e.$set(e.newProduct,"salesManId",e._n(t))},expression:"newProduct.salesManId"}},e._l(e.salesMans,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"产品"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.productsCopy,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitName",label:"单位"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitPrice",label:"价格"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newProduct.remark,callback:function(t){e.$set(e.newProduct,"remark","string"==typeof t?t.trim():t)},expression:"newProduct.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{on:{click:function(t){e.prductsDialog=!0}}},[e._v("添加产品")]),e._v(" "),o("el-button",{on:{click:function(t){e.calConsumeRecord()}}},[e._v("结算")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newProduct")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("CRProduct",{attrs:{visible:e.prductsDialog},on:{closeDialog:function(t){e.prductsDialog=!1},addCRProduct:e.handleAddCRProduct}})],1)},staticRenderFns:[]};var In=o("X4nt")(An,Tn,!1,function(e){o("mKf9")},"data-v-eb9fa95a",null).exports,Mn={name:"ConsumeRecordProject",data:function(){return{consumeRecordProjectSearch:{content:"",oldContent:"",pageNum:1,pageSize:10,consumeType:3},loading:!1,projectContentDetail:[],projectContentVisible:!1}},computed:{pageNum:function(){return this.$store.state.consumeRecord.pageNum},pageSize:function(){return this.$store.state.consumeRecord.pageSize},totalCount:function(){return this.$store.state.consumeRecord.totalCount},totalPages:function(){return this.$store.state.consumeRecord.totalPages},tableData:function(){return this.$store.state.consumeRecord.consumeRecords}},methods:{searchConsumeProjectRecord:function(e){var t=this;this.loading=!0,"search"===e&&(this.consumeRecordProjectSearch.oldContent=this.consumeRecordProjectSearch.content),this.consumeRecordProjectSearch.type=e,this.$store.dispatch("loadConsumeRecord",this.consumeRecordProjectSearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.consumeRecordProjectSearch.pageNum=e,this.searchConsumeProjectRecord("page")},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleModified:function(e,t){return 0===e.isModified?"否":"是"},handleEdit:function(e,t){},handleProjectDetail:function(e,t){this.projectContentDetail=[];var o=this.$store.getters.getConsumeRecordById(t.id),n=!0,r=!1,a=void 0;try{for(var i,s=k()(o.consumeRecordDetailUnion);!(n=(i=s.next()).done);n=!0){var l=i.value;this.projectContentDetail.push({projectName:l.projectName,amount:l.amount})}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}this.projectContentVisible=!0},onClose:function(e){this.projectContentVisible=!1,this.projectContentDetail=[]}},beforeMount:function(){this.searchConsumeProjectRecord("search")}},Nn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ConsumeRecordProject"},[o("el-form",{ref:"consumeRecordProjectSearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.consumeRecordProjectSearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchConsumeProjectRecord("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.consumeRecordProjectSearch.content,callback:function(t){e.$set(e.consumeRecordProjectSearch,"content","string"==typeof t?t.trim():t)},expression:"consumeRecordProjectSearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchConsumeProjectRecord("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/consume-record-project/new-project"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("做项目")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"tradeSerialNumber",label:"流水号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerMobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"consumeMoney",label:"消费金额"}}),e._v(" "),o("el-table-column",{attrs:{prop:"paymentWayName",label:"支付方式"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isModified",label:"是否修改",formatter:e.handleModified}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"220px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini"},on:{click:function(o){e.handleProjectDetail(t.$index,t.row)}}},[e._v("详情")])]}}])})],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}}),e._v(" "),o("el-dialog",{attrs:{title:"项目详情",visible:e.projectContentVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.projectContentVisible=t}}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.projectContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"projectName",label:"项目名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"个数"}})],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onClose("")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var Rn=o("X4nt")(Mn,Nn,!1,function(e){o("8iex")},"data-v-285462d0",null).exports,Dn={name:"CRProject",props:["visible"],data:function(){return{projectParams:{projectId:"",amount:"",operatorId:""},rules:{projectId:[{required:!0,message:"项目不能为空",trigger:"blur"},{type:"number",message:"项目必须是数字",trigger:"blur"}],amount:[{required:!0,message:"数量不能为空",trigger:"blur"},{type:"number",message:"数量必须是数字",trigger:"blur"}],operatorId:[{required:!0,message:"操作员不能为空",trigger:"blur"},{type:"number",message:"操作员必须是数字",trigger:"blur"}]}}},computed:{isVisible:function(){return this.visible},projects:function(){return this.$store.state.project.projectsAll},employees:function(){return this.$store.state.employee.employeesByTopType}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(o){if(!o)return!1;t.$emit("addCRProject",t.projectParams),t.$emit("closeDialog",!1),t.$refs[e].resetFields()})},handleProjectChange:function(e){var t=this.$store.getters.getProjectFromAllById(e).topTypeDesc;console.log(t)},onClose:function(e){this.$emit("closeDialog",!1),this.$refs[e].resetFields()}}},zn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"CRProject"},[o("el-dialog",{attrs:{title:"项目",visible:e.isVisible,"show-close":!1,"close-on-click-modal":!1,"close-on-press-escape":!1},on:{"update:visible":function(t){e.isVisible=t}}},[o("el-form",{ref:"projectParams",attrs:{model:e.projectParams,rules:e.rules}},[o("el-form-item",{attrs:{prop:"projectId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入项目"},on:{change:e.handleProjectChange},model:{value:e.projectParams.projectId,callback:function(t){e.$set(e.projectParams,"projectId",e._n(t))},expression:"projectParams.projectId"}},e._l(e.projects,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{prop:"amount"}},[o("el-input",{attrs:{placeholder:"请输入数量"},model:{value:e.projectParams.amount,callback:function(t){e.$set(e.projectParams,"amount",e._n(t))},expression:"projectParams.amount"}})],1),e._v(" "),o("el-form-item",{attrs:{prop:"operatorId"}},[o("el-select",{attrs:{filterable:"",placeholder:"请输入操作员"},model:{value:e.projectParams.operatorId,callback:function(t){e.$set(e.projectParams,"operatorId",e._n(t))},expression:"projectParams.operatorId"}},e._l(e.employees,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.onClose("projectParams")}}},[e._v("取 消")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("projectParams")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var En={name:"ConsumeRecordNewProject",data:function(){return{newProject:{customerMobile:"",consumeType:3,consumeMoney:0,paymentWay:"",payWayId:"",payWayContentId:"",couponAmount:0,remark:"",consultantId:"",salesManId:"",projects:[]},rules:{customerMobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{type:"number",message:"手机号必须是数字",trigger:"blur"}],consumeMoney:[{required:!0,message:"消费金额不能为空",trigger:"blur"},{type:"number",message:"消费金额必须是数字",trigger:"blur"}],paymentWay:[{required:!0,message:"支付方式不能为空",trigger:"blur"},{type:"number",message:"支付方式必须是数字",trigger:"blur"}],consultantId:[{required:!0,message:"顾问不能为空",trigger:"blur"},{type:"number",message:"顾问必须是数字",trigger:"blur"}],salesManId:[{required:!0,message:"销售员为空",trigger:"blur"},{type:"number",message:"销售员必须是数字",trigger:"blur"}]},paymentWays:[{name:"会员卡",value:1},{name:"活动",value:2},{name:"现金",value:3},{name:"现金+会员卡代金券",value:31},{name:"现金+活动代金券",value:32},{name:"赠送",value:4}],loading:!1,enterFlag:!0,projectsDialog:!1,projectsCopy:[],cardContents:[],cardCoupons:[],cardContentDetail:[],cardCouponContentDetail:[],activityContents:[],activityCoupons:[],activityContentDetail:[],activityCouponContentDetail:[],maxAmount:1,card:{id:"",remainingMoney:"",projectDiscount:"",uniqueIdentifier:""},cardCoupon:{id:""},activity:{id:""},activityCoupon:{id:""}}},computed:{consultants:function(){return this.$store.state.employee.consultants},salesMans:function(){return this.$store.state.employee.salesMans}},watch:{projectsCopy:function(e,t){3===this.newProject.paymentWay&&(this.newProject.consumeMoney=this.getPriceByProjects(e)),31===this.newProject.paymentWay&&""!=cardCoupon.id&&cardCoupon.projectDiscount}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;0==t.newProject.projects.length?t.$message.error("请添加项目!"):(t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addConsumeRecord",t.handleData(t.newProject)).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/consume-record-project"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)}))})},handleAddCRProject:function(e){var t=this.$store.getters.getProjectFromAllById(e.projectId),o=this.$store.getters.getEmployeeFromAllById(e.operatorId);this.projectsCopy.push({id:t.id,name:t.name,amount:e.amount,unitPrice:t.unitPrice,operatorName:o.name}),this.newProject.projects.push({projectId:e.projectId,amount:e.amount,operatorId:e.operatorId})},handleDelete:function(e,t){this.projectsCopy.splice(e,1),this.newProject.projects.splice(e,1)},handlePaymentWaySelect:function(e){var t=this;this.newProject.payWayId="",this.newProject.payWayContentId="",this.newProject.couponAmount=0,1===e?(this.activity.id="",this.cardCoupon.id="",this.activityCoupon.id="",""===this.newProject.customerMobile?(this.newProject.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerCardPay",{customerMobile:this.newProject.customerMobile,paymentWay:1}).then(function(e){t.cardContents=e.data}).catch(function(e){console.log(e)})):2===e?(this.newProject.consumeMoney=0,this.card.id="",this.cardCoupon.id="",this.activityCoupon.id="",""===this.newProject.customerMobile?(this.newProject.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerActivityPay",{customerMobile:this.newProject.customerMobile,paymentWay:2}).then(function(e){t.activityContents=e.data}).catch(function(e){console.log(e)})):3===e?(this.newProject.consumeMoney=0,this.card.id="",this.activity.id="",this.cardCoupon.id="",this.activityCoupon.id=""):31===e?(this.card.id="",this.activity.id="",this.activityCoupon.id="",""===this.newProject.customerMobile?(this.newProject.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerCardPay",{customerMobile:this.newProject.customerMobile,paymentWay:31}).then(function(e){t.cardCoupons=e.data}).catch(function(e){console.log(e)})):(this.card.id="",this.activity.id="",this.cardCoupon.id="",""===this.newProject.customerMobile?(this.newProject.paymentWay="",this.$message.error("请先输入手机号")):this.$store.dispatch("loadCustomerActivityPay",{customerMobile:this.newProject.customerMobile,paymentWay:32}).then(function(e){t.activityCoupons=e.data}).catch(function(e){console.log(e)}))},handleCardContentSelect:function(e){var t=this.$store.getters.getCustomerCardPayById(e);this.card.id=t.id,this.card.remainingMoney=t.remainingMoney,this.card.projectDiscount=t.projectDiscount,this.card.uniqueIdentifier=t.uniqueIdentifier,this.cardContentDetail=t.customerMemberCardContent},handleCardCouponSelect:function(e){var t=this.$store.getters.getCustomerCardPayById(e);this.cardCoupon.id=t.id,this.cardCoupon.projectDiscount=t.projectDiscount,this.cardCoupon.uniqueIdentifier=t.uniqueIdentifier,this.cardCouponContentDetail=t.customerMemberCardContent,this.newProject.payWayContentId="",this.newProject.couponAmount=0},handleCardCouponDetailSelect:function(e){this.newProject.couponAmount=0},handleActivityContentSelect:function(e){var t=this.$store.getters.getCustomerActivityPayById(e);this.activity.id=t.id,this.activityContentDetail=t.customerActivityContents},handleActivityCouponSelect:function(e){var t=this.$store.getters.getCustomerActivityPayById(e);this.activityCoupon.id=t.id,this.activityCouponContentDetail=t.customerActivityContents,this.newProject.payWayContentId="",this.newProject.couponAmount=0},handleActivityCouponDetailSelect:function(e){this.newProject.couponAmount=0},handleData:function(e){var t={consumeRecordPo:{customerMobile:"",consumeType:"",consumeMoney:"",paymentWay:"",payWayId:"",payWayContentId:"",couponAmount:"",remark:""},consumeRecordDetails:[]};t.consumeRecordPo.customerMobile=e.customerMobile,t.consumeRecordPo.consumeType=e.consumeType,t.consumeRecordPo.consumeMoney=e.consumeMoney,t.consumeRecordPo.paymentWay=e.paymentWay,t.consumeRecordPo.payWayId=e.payWayId,t.consumeRecordPo.payWayContentId=e.payWayContentId,t.consumeRecordPo.couponAmount=e.couponAmount,t.consumeRecordPo.remark=e.remark;var o=!0,n=!1,r=void 0;try{for(var a,i=k()(e.projects);!(o=(a=i.next()).done);o=!0){var s=a.value;t.consumeRecordDetails.push({projectId:s.projectId,amount:s.amount,operatorId:s.operatorId,consultantId:e.consultantId,salesManId:e.salesManId})}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return console.log(t),t},getPriceByProjects:function(e){var t=0,o=!0,n=!1,r=void 0;try{for(var a,i=k()(e);!(o=(a=i.next()).done);o=!0){var s=a.value;t+=s.amount*s.unitPrice}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}return t},loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadConsultants:function(){var e=this;this.$store.dispatch("loadEmployeeByTopType",4).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadSalesMans:function(){var e=this;this.$store.dispatch("loadEmployeeByWorkType",3).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadProjectAll:function(){var e=this;this.$store.dispatch("loadProjectAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},calConsumeRecord:function(){var e=this;this.$refs.newProject.validate(function(t){if(!t)return!1;0==e.newProject.projects.length?e.$message.error("请添加项目!"):e.$store.dispatch("calConsumeRecord",e.handleData(e.newProject)).then(function(t){e.newProject.consumeMoney=t.data}).catch(function(e){console.log(e)})})}},beforeMount:function(){this.loadEmployeeAll(),this.loadConsultants(),this.loadSalesMans(),this.loadProjectAll()},components:{CRProject:o("X4nt")(Dn,zn,!1,function(e){o("PQqG")},"data-v-5c157693",null).exports}},Bn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ConsumeRecordNewProject"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/consume-record-project"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("做项目")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newProject",staticClass:"new-form",attrs:{model:e.newProject,"label-width":"120px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newProject")}}},[o("el-form-item",{attrs:{label:"手机",prop:"customerMobile"}},[o("el-input",{attrs:{placeholder:"请输入手机",autofocus:!0},model:{value:e.newProject.customerMobile,callback:function(t){e.$set(e.newProject,"customerMobile",e._n(t))},expression:"newProject.customerMobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"消费金额(￥)",prop:"consumeMoney"}},[o("el-input",{attrs:{placeholder:"请输入消费金额"},model:{value:e.newProject.consumeMoney,callback:function(t){e.$set(e.newProject,"consumeMoney",e._n(t))},expression:"newProject.consumeMoney"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"支付方式",prop:"paymentWay"}},[o("el-select",{attrs:{placeholder:"请选择支付方式"},on:{change:e.handlePaymentWaySelect},model:{value:e.newProject.paymentWay,callback:function(t){e.$set(e.newProject,"paymentWay",e._n(t))},expression:"newProject.paymentWay"}},e._l(e.paymentWays,function(e){return o("el-option",{key:e.value,attrs:{label:e.name,value:e.value}})}))],1),e._v(" "),1===e.newProject.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户会员卡"},on:{change:e.handleCardContentSelect},model:{value:e.newProject.payWayId,callback:function(t){e.$set(e.newProject,"payWayId",e._n(t))},expression:"newProject.payWayId"}},e._l(e.cardContents,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.memberCardName,value:e.id}})}))],1):e._e(),e._v(" "),2===e.newProject.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户活动"},on:{change:e.handleActivityContentSelect},model:{value:e.newProject.payWayId,callback:function(t){e.$set(e.newProject,"payWayId",e._n(t))},expression:"newProject.payWayId"}},e._l(e.activityContents,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.activityName,value:e.id}})}))],1):e._e(),e._v(" "),31===e.newProject.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户卡"},on:{change:e.handleCardCouponSelect},model:{value:e.newProject.payWayId,callback:function(t){e.$set(e.newProject,"payWayId",e._n(t))},expression:"newProject.payWayId"}},e._l(e.cardCoupons,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.memberCardName,value:e.id}})}))],1):e._e(),e._v(" "),32===e.newProject.paymentWay?o("el-form-item",{attrs:{label:"内容"}},[o("el-select",{attrs:{placeholder:"请选择客户活动"},on:{change:e.handleActivityCouponSelect},model:{value:e.newProject.payWayId,callback:function(t){e.$set(e.newProject,"payWayId",e._n(t))},expression:"newProject.payWayId"}},e._l(e.activityCoupons,function(e){return o("el-option",{key:e.id,attrs:{label:e.customerName+"-"+e.activityName,value:e.id}})}))],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"会员卡内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.cardContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"relatedName",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"个数"}})],1)],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"储值(￥)"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.remainingMoney,callback:function(t){e.$set(e.card,"remainingMoney",t)},expression:"card.remainingMoney"}})],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"项目折扣(0-100)"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.projectDiscount,callback:function(t){e.$set(e.card,"projectDiscount",t)},expression:"card.projectDiscount"}})],1):e._e(),e._v(" "),""!=e.card.id?o("el-form-item",{attrs:{label:"卡流水号"}},[o("el-input",{attrs:{disabled:!0},model:{value:e.card.uniqueIdentifier,callback:function(t){e.$set(e.card,"uniqueIdentifier",t)},expression:"card.uniqueIdentifier"}})],1):e._e(),e._v(" "),""!=e.cardCoupon.id?o("el-form-item",{attrs:{label:"会员卡优惠券"}},[o("el-select",{attrs:{placeholder:"请选择优惠券"},on:{change:e.handleCardCouponDetailSelect},model:{value:e.newProject.payWayContentId,callback:function(t){e.$set(e.newProject,"payWayContentId",e._n(t))},expression:"newProject.payWayContentId"}},e._l(e.cardCouponContentDetail,function(e){return o("el-option",{key:e.id,ref:"",refInFor:!0,attrs:{label:e.content+"-"+e.amount+"张",value:e.id}})}))],1):e._e(),e._v(" "),""!=e.cardCoupon.id?o("el-form-item",{attrs:{label:"数量"}},[o("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.newProject.couponAmount,callback:function(t){e.$set(e.newProject,"couponAmount",t)},expression:"newProject.couponAmount"}})],1):e._e(),e._v(" "),""!=e.activityCoupon.id?o("el-form-item",{attrs:{label:"活动优惠券"}},[o("el-select",{attrs:{placeholder:"请选择优惠券"},on:{change:e.handleActivityCouponDetailSelect},model:{value:e.newProject.payWayContentId,callback:function(t){e.$set(e.newProject,"payWayContentId",e._n(t))},expression:"newProject.payWayContentId"}},e._l(e.activityCouponContentDetail,function(e){return o("el-option",{key:e.id,attrs:{label:e.content+"-"+e.number+"张",value:e.id}})}))],1):e._e(),e._v(" "),""!=e.activityCoupon.id?o("el-form-item",{attrs:{label:"数量"}},[o("el-input-number",{attrs:{"controls-position":"right",min:0},model:{value:e.newProject.couponAmount,callback:function(t){e.$set(e.newProject,"couponAmount",t)},expression:"newProject.couponAmount"}})],1):e._e(),e._v(" "),""!=e.activity.id?o("el-form-item",{attrs:{label:"活动内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.activityContentDetail,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"relatedName",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"number",label:"个数"}})],1)],1):e._e(),e._v(" "),o("el-form-item",{attrs:{label:"顾问"}},[o("el-select",{attrs:{placeholder:"请输入顾问名称",filterable:""},model:{value:e.newProject.consultantId,callback:function(t){e.$set(e.newProject,"consultantId",e._n(t))},expression:"newProject.consultantId"}},e._l(e.consultants,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"销售员"}},[o("el-select",{attrs:{placeholder:"请输入销售员名称",filterable:""},model:{value:e.newProject.salesManId,callback:function(t){e.$set(e.newProject,"salesManId",e._n(t))},expression:"newProject.salesManId"}},e._l(e.salesMans,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"项目"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.projectsCopy,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"数量"}}),e._v(" "),o("el-table-column",{attrs:{prop:"unitPrice",label:"价格"}}),e._v(" "),o("el-table-column",{attrs:{prop:"operatorName",label:"操作员"}}),e._v(" "),o("el-table-column",{attrs:{label:"操作",width:"50px;",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(o){e.handleDelete(t.$index,t.row)}}},[e._v("x")])]}}])})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newProject.remark,callback:function(t){e.$set(e.newProject,"remark","string"==typeof t?t.trim():t)},expression:"newProject.remark"}})],1),e._v(" "),o("el-form-item",[o("el-button",{on:{click:function(t){e.projectsDialog=!0}}},[e._v("添加项目")]),e._v(" "),o("el-button",{on:{click:function(t){e.calConsumeRecord()}}},[e._v("结算")]),e._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newProject")}}},[e._v("提交")])],1)],1)],1)],1),e._v(" "),o("CRProject",{attrs:{visible:e.projectsDialog},on:{closeDialog:function(t){e.projectsDialog=!1},addCRProject:e.handleAddCRProject}})],1)},staticRenderFns:[]};var Wn=o("X4nt")(En,Bn,!1,function(e){o("Oc/h")},"data-v-edc8ad7e",null).exports,qn={name:"ConsumeRecordCard",data:function(){return{consumeRecordActivitySearch:{content:"",oldContent:"",pageNum:1,pageSize:10,consumeType:4},loading:!1}},computed:{pageNum:function(){return this.$store.state.consumeRecord.pageNum},pageSize:function(){return this.$store.state.consumeRecord.pageSize},totalCount:function(){return this.$store.state.consumeRecord.totalCount},totalPages:function(){return this.$store.state.consumeRecord.totalPages},tableData:function(){return this.$store.state.consumeRecord.consumeRecords}},methods:{searchConsumeActivityRecord:function(e){var t=this;this.loading=!0,"search"===e&&(this.consumeRecordActivitySearch.oldContent=this.consumeRecordActivitySearch.content),this.consumeRecordActivitySearch.type=e,this.$store.dispatch("loadConsumeRecord",this.consumeRecordActivitySearch).then(function(e){t.loading=!1,t.$message.success("查询成功")}).catch(function(e){console.log(e)})},chagePage:function(e){this.consumeRecordActivitySearch.pageNum=e,this.searchConsumeActivityRecord("page")},handleModified:function(e,t){return 0===e.isModified?"否":"是"},handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleEdit:function(e,t){},onClose:function(e){this.cardGiftContentVisible=!1,this.cardGiftContentDetail=[]}},beforeMount:function(){this.searchConsumeActivityRecord("search")}},On={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ConsumeRecordCard"},[o("el-form",{ref:"consumeRecordActivitySearch",staticClass:"demo-form-inline search-form",attrs:{inline:!0,model:e.consumeRecordActivitySearch},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.searchConsumeActivityRecord("search")}}},[o("el-form-item",[o("el-input",{staticStyle:{display:"none"}}),e._v(" "),o("el-input",{attrs:{placeholder:""},model:{value:e.consumeRecordActivitySearch.content,callback:function(t){e.$set(e.consumeRecordActivitySearch,"content","string"==typeof t?t.trim():t)},expression:"consumeRecordActivitySearch.content"}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticClass:"search-btn",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){e.searchConsumeActivityRecord("search")}}},[e._v("查询")])],1)],1),e._v(" "),o("div",{staticClass:"operate-box"},[o("router-link",{attrs:{to:"/consume-record-activity/new-activity"}},[o("el-button",{attrs:{type:"primary",icon:"el-icon-plus"}},[e._v("参加活动")])],1)],1),e._v(" "),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"mini"}},[e._e(),e._v(" "),o("el-table-column",{attrs:{prop:"tradeSerialNumber",label:"流水号"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerName",label:"姓名"}}),e._v(" "),o("el-table-column",{attrs:{prop:"customerMobile",label:"手机"}}),e._v(" "),o("el-table-column",{attrs:{prop:"consumeMoney",label:"消费金额"}}),e._v(" "),o("el-table-column",{attrs:{prop:"activityName",label:"活动名称"}}),e._v(" "),o("el-table-column",{attrs:{prop:"paymentWayName",label:"支付方式"}}),e._v(" "),o("el-table-column",{attrs:{prop:"isModified",label:"是否修改",formatter:e.handleModified}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注",formatter:e.handleRemark}}),e._v("=\n    ")],1),e._v(" "),o("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pageSize,total:e.totalCount},on:{"current-change":e.chagePage}})],1)},staticRenderFns:[]};var Vn=o("X4nt")(qn,On,!1,function(e){o("Rfqw")},"data-v-30d560bc",null).exports,Ln={name:"ConsumeRecordNewActivity",data:function(){return{newActivity:{customerMobile:"",consumeType:4,consumeMoney:0,paymentWay:3,activityId:"",remark:"",consultantId:"",salesManId:""},rules:{customerMobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{type:"number",message:"手机号必须是数字",trigger:"blur"}],consumeMoney:[{required:!0,message:"消费金额不能为空",trigger:"blur"},{type:"number",message:"消费金额必须是数字",trigger:"blur"}],activityId:[{required:!0,message:"活动不能为空",trigger:"blur"},{type:"number",message:"活动必须是数字",trigger:"blur"}]},loading:!1,enterFlag:!0,activityContents:[]}},computed:{activities:function(){return this.$store.state.activity.activitiesAll},consultants:function(){return this.$store.state.employee.consultants},salesMans:function(){return this.$store.state.employee.salesMans}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("addConsumeRecord",t.handleData(t.newActivity)).then(function(e){0===e.code&&(t.$message.success("添加成功"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/consume-record-activity"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})},handleActivitySelect:function(e){var t=this.$store.getters.getActivityFromAllById(e);this.newActivity.consumeMoney=t.price,this.activityContents=[];var o=!0,n=!1,r=void 0;try{for(var a,i=k()(t.activityContentVos);!(o=(a=i.next()).done);o=!0){var s=a.value,l=void 0;"项目"===s.type?l=s.relatedName:"会员卡"===s.type?l=s.relatedName:"产品"===s.type?l=s.relatedName:(4,l=s.content),this.activityContents.push({type:s.type,name:l,number:s.number,remark:""!==s.remark&&s.remark?s.remark:"暂无备注"})}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}},handleData:function(e){var t={consumeRecordPo:{customerMobile:"",consumeType:"",consumeMoney:"",activityId:"",paymentWay:"",remark:""}};return t.consumeRecordPo.customerMobile=e.customerMobile,t.consumeRecordPo.consumeType=e.consumeType,t.consumeRecordPo.consumeMoney=e.consumeMoney,t.consumeRecordPo.activityId=e.activityId,t.consumeRecordPo.paymentWay=e.paymentWay,t.consumeRecordPo.remark=e.remark,t},loadActivityAll:function(){var e=this;this.$store.dispatch("loadActivityAll").then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadConsultants:function(){var e=this;this.$store.dispatch("loadEmployeeByTopType",4).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})},loadSalesMans:function(){var e=this;this.$store.dispatch("loadEmployeeByWorkType",3).then(function(t){e.loading=!1}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadActivityAll(),this.loadConsultants(),this.loadSalesMans()}},Xn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ConsumeRecordNewActivity"},[o("el-row",{staticClass:"page-title-row"},[o("router-link",{staticClass:"page-title-back",attrs:{to:"/consume-record-activity"}},[o("i",{staticClass:"el-icon-back"}),e._v(" 返回")]),e._v(" "),o("span",{staticClass:"page-title"},[e._v("参加活动")])],1),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:18,md:12}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"newActivity",staticClass:"new-form",attrs:{model:e.newActivity,"label-width":"120px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("newActivity")}}},[o("el-form-item",{attrs:{label:"手机",prop:"customerMobile"}},[o("el-input",{attrs:{placeholder:"请输入手机",autofocus:!0},model:{value:e.newActivity.customerMobile,callback:function(t){e.$set(e.newActivity,"customerMobile",e._n(t))},expression:"newActivity.customerMobile"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"消费金额(￥)",prop:"consumeMoney"}},[o("el-input",{attrs:{placeholder:"请输入消费金额"},model:{value:e.newActivity.consumeMoney,callback:function(t){e.$set(e.newActivity,"consumeMoney",e._n(t))},expression:"newActivity.consumeMoney"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"活动",prop:"activityId"}},[o("el-select",{attrs:{placeholder:"请选择活动"},on:{change:e.handleActivitySelect},model:{value:e.newActivity.activityId,callback:function(t){e.$set(e.newActivity,"activityId",e._n(t))},expression:"newActivity.activityId"}},e._l(e.activities,function(e){return o("el-option",{key:e.id,attrs:{label:e.code+"-"+e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"活动内容"}},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.activityContents,size:"mini"}},[o("el-table-column",{attrs:{prop:"type",label:"类型"}}),e._v(" "),o("el-table-column",{attrs:{prop:"name",label:"内容"}}),e._v(" "),o("el-table-column",{attrs:{prop:"number",label:"个数"}}),e._v(" "),o("el-table-column",{attrs:{prop:"remark",label:"备注"}})],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"备注"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:e.newActivity.remark,callback:function(t){e.$set(e.newActivity,"remark","string"==typeof t?t.trim():t)},expression:"newActivity.remark"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"顾问"}},[o("el-select",{attrs:{placeholder:"请输入顾问名称",filterable:""},model:{value:e.newActivity.consultantId,callback:function(t){e.$set(e.newActivity,"consultantId",e._n(t))},expression:"newActivity.consultantId"}},e._l(e.consultants,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",{attrs:{label:"销售员"}},[o("el-select",{attrs:{placeholder:"请输入销售员名称",filterable:""},model:{value:e.newActivity.salesManId,callback:function(t){e.$set(e.newActivity,"salesManId",e._n(t))},expression:"newActivity.salesManId"}},e._l(e.salesMans,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("newActivity")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var Gn=o("X4nt")(Ln,Xn,!1,function(e){o("usOl")},"data-v-0115918e",null).exports,Un={name:"Schedule",data:function(){return{operatorForm:{operatorId:""},employees:[{id:"",name:"查询所有"}],loading:!1,appointmentData:[]}},methods:{handleRemark:function(e,t){return e.remark&&""!==e.remark?e.remark:"暂无备注"},handleBeginTime:function(e,t){var o="",n=!0,r=!1,a=void 0;try{for(var i,s=k()(e.appointmentProjects);!(n=(i=s.next()).done);n=!0){var l=i.value;o+=this.toDatetimeMin(l.beginTime)}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o},handleEndTime:function(e,t){var o="",n=!0,r=!1,a=void 0;try{for(var i,s=k()(e.appointmentProjects);!(n=(i=s.next()).done);n=!0){var l=i.value;o+=this.toDatetimeMin(l.endTime)}}catch(e){r=!0,a=e}finally{try{!n&&s.return&&s.return()}finally{if(r)throw a}}return o},loadAppointment:function(){var e=this;this.appointmentData=[],this.$store.dispatch("loadAppointmentOperator",this.operatorForm).then(function(t){var o=!0,n=!1,r=void 0;try{for(var a,i=k()(t.data);!(o=(a=i.next()).done);o=!0){var s=a.value;e.appointmentData.push({operatorName:s.operatorName,projectName:s.projectName,beginTime:e.toDatetimeMin(s.beginTime),endTime:e.toDatetimeMin(s.endTime)})}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}).catch(function(e){console.log(e)})},loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){var o=!0,n=!1,r=void 0;try{for(var a,i=k()(t.data);!(o=(a=i.next()).done);o=!0){var s=a.value;e.employees.push(s)}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}).catch(function(e){console.log(e)})}},beforeMount:function(){this.loadEmployeeAll(),this.loadAppointment()},components:{HomeHeader:F}},Hn={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"Schedule"},[o("el-container",[o("el-header",[o("home-header")],1),e._v(" "),o("el-container",{staticClass:"home-container"},[o("el-container",[o("el-main",[o("el-form",{ref:"operatorForm",attrs:{model:e.operatorForm}},[o("el-form-item",[o("el-select",{attrs:{placeholder:"请查询操作员",filterable:""},on:{change:e.loadAppointment},model:{value:e.operatorForm.operatorId,callback:function(t){e.$set(e.operatorForm,"operatorId",e._n(t))},expression:"operatorForm.operatorId"}},e._l(e.employees,function(e){return o("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],1)],1),e._v(" "),e._l(e.appointmentData,function(t,n){return o("el-card",{key:n,staticClass:"box-card appointment-box"},[o("div",{staticClass:"box"},[o("div",{staticClass:"column"},[o("span",{staticClass:"item"},[e._v(e._s(t.operatorName))]),e._v(" "),o("span",{staticClass:"item"},[o("el-tag",[e._v(e._s(t.projectName))])],1)]),e._v(" "),o("div",{staticClass:"column"},[o("span",{staticClass:"item"},[o("i",{staticClass:"el-icon-time time-icon"}),e._v(e._s(t.beginTime))]),e._v(" "),o("span",{staticClass:"item"},[o("i",{staticClass:"el-icon-time time-icon"}),e._v(e._s(t.endTime))])])])])})],2)],1)],1)],1)],1)},staticRenderFns:[]};var Yn=o("X4nt")(Un,Hn,!1,function(e){o("8u5E")},"data-v-39baf9b5",null).exports,Jn={name:"PrintCardRecord",data:function(){return{customer:"",store:"",tableData:"",giftData:[]}},methods:{loadData:function(e){this.customer={name:"消费者姓名："+e.consumeRecordVo.customerName,mobile:"消费者手机号："+e.consumeRecordVo.customerMobile,time:"打印时间："+this.toDatetimeMin(Date.parse(new Date))},this.store={name:"店名："+e.storeVo.name,address:"地址："+e.storeVo.address,phone:"电话："+e.storeVo.phone},this.tableData={id:e.consumeRecordVo.id,tradeSerialNumber:e.consumeRecordVo.tradeSerialNumber,consumeMoney:e.consumeRecordVo.consumeMoney,paymentWayName:e.consumeRecordVo.paymentWayName,isModified:0===e.consumeRecordVo.isModified?"否":"是",remark:e.consumeRecordVo.remark?e.consumeRecordVo.remark:"暂无备注",cardName:e.consumeRecordVo.consumeRecordDetailUnion[0].cardName};var t=!0,o=!1,n=void 0;try{for(var r,a=k()(e.consumeRecordVo.consumeRecordGiftUnion);!(t=(r=a.next()).done);t=!0){var i=r.value;i.productId?this.giftData.push({type:"产品",name:i.productName,amount:i.productAmount}):i.projectId?this.giftData.push({type:"项目",name:i.projectName,amount:i.projectAmount}):this.giftData.push({type:"代金券",name:i.couponMoney,amount:i.couponAmount})}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}},beforeMount:function(){var e=this,t=this.$store.state.consumeRecord.consumeRecordPrint;t?this.loadData(t):(this.$message.error("请先查询消费记录！"),setTimeout(function(){e.$router.push({path:"/consume-record-card"})},2e3))},mounted:function(){setTimeout(function(){window.print()},1e3)}},Qn={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"PrintCardRecord"},[n("el-container",[n("el-container",{staticClass:"home-container"},[n("el-container",[n("el-main",[n("div",[n("img",{staticClass:"print-img",attrs:{src:"css/images/logo-print.png",alt:""}})]),e._v(" "),n("div",{staticClass:"print-store-name"},[e._v(e._s(e.store.name))]),e._v(" "),n("div",{staticClass:"print-address"},[e._v(e._s(e.store.address))]),e._v(" "),n("div",{staticClass:"print-phone"},[e._v(e._s(e.store.phone))]),e._v(" "),n("div",{staticClass:"print-time"},[e._v(e._s(e.customer.time))]),e._v(" "),n("div",{staticClass:"print-type"},[e._v("消费类型：办卡")]),e._v(" "),n("div",{staticClass:"print-mobile"},[e._v(e._s(e.customer.mobile))]),e._v(" "),n("div",{staticClass:"print-name"},[e._v(e._s(e.customer.name))]),e._v(" "),n("div",{staticClass:"record-data"},[n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("流水号")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.tradeSerialNumber))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("消费金额")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.consumeMoney))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("支付方式")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.paymentWayName))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("是否修改")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.isModified))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("备注")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.remark))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("卡名")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.cardName))])])]),e._v(" "),n("div",[e._v("赠品")]),e._v(" "),n("div",{staticClass:"record-data"},[n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("类型")]),e._v(" "),e._l(e.giftData,function(t,o){return n("div",{key:o,staticClass:"record-data-item"},[e._v(e._s(t.type))])})],2),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("内容/金额")]),e._v(" "),e._l(e.giftData,function(t,o){return n("div",{key:o,staticClass:"record-data-item"},[e._v(e._s(t.name))])})],2),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("数量")]),e._v(" "),e._l(e.giftData,function(t,o){return n("div",{key:o,staticClass:"record-data-item"},[e._v(e._s(t.amount))])})],2)]),e._v(" "),n("div",[n("span",{staticClass:"print-wechat"},[n("img",{staticClass:"print-wechat-img",attrs:{src:o("bzqt"),alt:""}})]),e._v(" "),n("span",{staticClass:"print-wechat-2"},[n("span",{staticClass:"t1"},[e._v("Welcome to BRAND NEW")]),e._v(" "),n("span",{staticClass:"t2"},[e._v("BRAND NEW LIFE")]),e._v(" "),n("span",{staticClass:"t3"},[e._v("科技 美丽人生")]),e._v(" "),n("span",{staticClass:"b"},[e._v("www.brandnew-gmh.com")])])]),e._v(" "),n("div",{staticClass:"print-text"},[e._v("特别提示：＊请凭此消费凭证于当月内开具发票。＊产品售出，已开封不退不换，未开封可换货，请凭此消费凭证或发票(如已开具)办理换货。＊所有优惠卡及优惠活动，一经售出，不退不换 ＊成员卡一个月内可进行卡项升级＊最终解释权归本公司所有。")]),e._v(" "),n("div",{staticClass:"print-text-en"},[e._v("Special tips: *Please get you invoice by this receipt within the same month. *Products sold, if the package has been opened, do not refund.If the packaging is complete, the product can be exchanged, please use this receipt or invoice (if issued) for replacement. *All discount cards and promotions,no refund, no change.*The final explanation is owned by the company.")])])],1)],1)],1)],1)},staticRenderFns:[]};var Zn=o("X4nt")(Jn,Qn,!1,function(e){o("vKCj")},"data-v-165b0f6d",null).exports,Kn={name:"PrintProductRecord",data:function(){return{customer:"",store:"",tableData:"",giftData:[]}},methods:{loadData:function(e){this.customer={name:"消费者姓名："+e.consumeRecordVo.customerName,mobile:"消费者手机号："+e.consumeRecordVo.customerMobile,time:"打印时间："+this.toDatetimeMin(Date.parse(new Date))},this.store={name:"店名："+e.storeVo.name,address:"地址："+e.storeVo.address,phone:"电话："+e.storeVo.phone},this.tableData={id:e.consumeRecordVo.id,tradeSerialNumber:e.consumeRecordVo.tradeSerialNumber,consumeMoney:e.consumeRecordVo.consumeMoney,paymentWayName:e.consumeRecordVo.paymentWayName,isModified:0===e.consumeRecordVo.isModified?"否":"是",remark:e.consumeRecordVo.remark?e.consumeRecordVo.remark:"暂无备注",cardName:e.consumeRecordVo.consumeRecordDetailUnion[0].cardName};var t=!0,o=!1,n=void 0;try{for(var r,a=k()(e.consumeRecordVo.consumeRecordGiftUnion);!(t=(r=a.next()).done);t=!0){var i=r.value;i.productId?this.giftData.push({type:"产品",name:i.productName,amount:i.productAmount}):i.projectId?this.giftData.push({type:"项目",name:i.projectName,amount:i.projectAmount}):this.giftData.push({type:"代金券",name:i.couponMoney,amount:i.couponAmount})}}catch(e){o=!0,n=e}finally{try{!t&&a.return&&a.return()}finally{if(o)throw n}}}},beforeMount:function(){var e=this,t=this.$store.state.consumeRecord.consumeRecordPrint;t?(this.loadData(t),window.print()):(this.$message.error("请先查询消费记录！"),setTimeout(function(){e.$router.push({path:"/consume-record-card"})},2e3))}},er={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"PrintProductRecord"},[n("el-container",[n("el-container",{staticClass:"home-container"},[n("el-container",[n("el-main",[n("div",[n("img",{staticClass:"print-img",attrs:{src:"css/images/logo-print.png",alt:""}})]),e._v(" "),n("div",{staticClass:"print-store-name"},[e._v(e._s(e.store.name))]),e._v(" "),n("div",{staticClass:"print-address"},[e._v(e._s(e.store.address))]),e._v(" "),n("div",{staticClass:"print-phone"},[e._v(e._s(e.store.phone))]),e._v(" "),n("div",{staticClass:"print-time"},[e._v(e._s(e.customer.time))]),e._v(" "),n("div",{staticClass:"print-type"},[e._v("消费类型：买产品")]),e._v(" "),n("div",{staticClass:"print-mobile"},[e._v(e._s(e.customer.mobile))]),e._v(" "),n("div",{staticClass:"print-name"},[e._v(e._s(e.customer.name))]),e._v(" "),n("div",{staticClass:"record-data"},[n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("流水号")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.tradeSerialNumber))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("消费金额")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.consumeMoney))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("支付方式")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.paymentWayName))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("是否修改")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.isModified))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("备注")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.remark))])]),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("卡名")]),e._v(" "),n("div",{staticClass:"record-data-item"},[e._v(e._s(e.tableData.cardName))])])]),e._v(" "),n("div"),e._v(" "),n("div",{staticClass:"record-data"},[n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("类型")]),e._v(" "),e._l(e.giftData,function(t,o){return n("div",{key:o,staticClass:"record-data-item"},[e._v(e._s(t.type))])})],2),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("内容/金额")]),e._v(" "),e._l(e.giftData,function(t,o){return n("div",{key:o,staticClass:"record-data-item"},[e._v(e._s(t.name))])})],2),e._v(" "),n("div",{staticClass:"column"},[n("div",{staticClass:"record-data-item"},[e._v("数量")]),e._v(" "),e._l(e.giftData,function(t,o){return n("div",{key:o,staticClass:"record-data-item"},[e._v(e._s(t.amount))])})],2)]),e._v(" "),n("div",[n("span",{staticClass:"print-wechat"},[n("img",{staticClass:"print-wechat-img",attrs:{src:o("bzqt"),alt:""}})]),e._v(" "),n("span",{staticClass:"print-wechat-2"},[n("span",{staticClass:"t1"},[e._v("Welcome to BRAND NEW")]),e._v(" "),n("span",{staticClass:"t2"},[e._v("BRAND NEW LIFE")]),e._v(" "),n("span",{staticClass:"t3"},[e._v("科技 美丽人生")]),e._v(" "),n("span",{staticClass:"b"},[e._v("www.brandnew-gmh.com")])])]),e._v(" "),n("div",{staticClass:"print-text"},[e._v("特别提示：＊请凭此消费凭证于当月内开具发票。＊产品售出，已开封不退不换，未开封可换货，请凭此消费凭证或发票(如已开具)办理换货。＊所有优惠卡及优惠活动，一经售出，不退不换 ＊成员卡一个月内可进行卡项升级＊最终解释权归本公司所有。")]),e._v(" "),n("div",{staticClass:"print-text-en"},[e._v("Special tips: *Please get you invoice by this receipt within the same month. *Products sold, if the package has been opened, do not refund.If the packaging is complete, the product can be exchanged, please use this receipt or invoice (if issued) for replacement. *All discount cards and promotions,no refund, no change.*The final explanation is owned by the company.")])])],1)],1)],1)],1)},staticRenderFns:[]};var tr=o("X4nt")(Kn,er,!1,function(e){o("DIhC")},"data-v-4b432ecc",null).exports,or={name:"PrintCardRecord",data:function(){return{recordData:""}},methods:{loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){var o=!0,n=!1,r=void 0;try{for(var a,i=k()(t.data);!(o=(a=i.next()).done);o=!0){var s=a.value;e.employees.push(s)}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}).catch(function(e){console.log(e)})}},beforeMount:function(){this.recordData=this.$store.state.consumeRecord.consumeRecordPrint}},nr={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"PrintCardRecord"},[t("el-container",[t("el-container",{staticClass:"home-container"},[t("el-container",[t("el-main")],1)],1)],1)],1)},staticRenderFns:[]};var rr=o("X4nt")(or,nr,!1,function(e){o("486q")},"data-v-e71b7ef2",null).exports,ar={name:"PrintCardRecord",data:function(){return{recordData:""}},methods:{loadEmployeeAll:function(){var e=this;this.$store.dispatch("loadEmployeeAll").then(function(t){var o=!0,n=!1,r=void 0;try{for(var a,i=k()(t.data);!(o=(a=i.next()).done);o=!0){var s=a.value;e.employees.push(s)}}catch(e){n=!0,r=e}finally{try{!o&&i.return&&i.return()}finally{if(n)throw r}}}).catch(function(e){console.log(e)})}},beforeMount:function(){this.recordData=this.$store.state.consumeRecord.consumeRecordPrint}},ir={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"PrintCardRecord"},[t("el-container",[t("el-container",{staticClass:"home-container"},[t("el-container",[t("el-main")],1)],1)],1)],1)},staticRenderFns:[]};var sr=o("X4nt")(ar,ir,!1,function(e){o("HGPJ")},"data-v-14692c72",null).exports,lr={name:"ResetPWD",data:function(){return{resetPWDForm:{originalPassword:"",newPassword:""},rules:{originalPassword:[{required:!0,message:"旧密码不能为空",trigger:"blur"}],newPassword:[{required:!0,message:"新密码不能为空",trigger:"blur"}]},loading:!1,enterFlag:!0}},methods:{onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.loading=!0,t.enterFlag=!1,t.$store.dispatch("modPWD",t.resetPWDForm).then(function(e){0===e.code&&(t.$message.success("修改成功,请重新登录"),setTimeout(function(){t.loading=!1,t.$router.push({path:"/signin"})},1e3))}).catch(function(e){t.loading=!1,t.enterFlag=!0,console.log(e)})})}}},cr={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"ResetPWD"},[o("el-row",{staticClass:"page-title-row"},[o("span",{staticClass:"page-title"},[e._v("修改密码")])]),e._v(" "),o("el-row",{attrs:{type:"flex",justify:"start"}},[o("el-col",{attrs:{xs:24,sm:12,md:8}},[o("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"resetPWDForm",staticClass:"new-form",attrs:{model:e.resetPWDForm,"label-width":"110px",rules:e.rules},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key))return null;e.enterFlag&&e.onSubmit("resetPWDForm")}}},[o("el-form-item",{attrs:{label:"旧密码",prop:"originalPassword"}},[o("el-input",{attrs:{autofocus:!0},model:{value:e.resetPWDForm.originalPassword,callback:function(t){e.$set(e.resetPWDForm,"originalPassword","string"==typeof t?t.trim():t)},expression:"resetPWDForm.originalPassword"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"新密码",prop:"newPassword"}},[o("el-input",{model:{value:e.resetPWDForm.newPassword,callback:function(t){e.$set(e.resetPWDForm,"newPassword","string"==typeof t?t.trim():t)},expression:"resetPWDForm.newPassword"}})],1),e._v(" "),o("el-form-item",[o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.onSubmit("resetPWDForm")}}},[e._v("提交")])],1)],1)],1)],1)],1)},staticRenderFns:[]};var ur=o("X4nt")(lr,cr,!1,function(e){o("jq9M")},"data-v-a081df12",null).exports;o("phcV");r.default.use(u.a);var mr=new u.a({mode:"history",routes:[{path:"/",name:"Home",component:j,children:[{path:"chart",component:Ko},{path:"store",component:R},{path:"store/new",component:E},{path:"store/:id",component:q},{path:"principal",component:L},{path:"principal/new",component:U},{path:"principal/:id",component:Z},{path:"reception",component:te},{path:"reception/new",component:re},{path:"reception/:id",component:se},{path:"operator",component:ue},{path:"operator/new",component:pe},{path:"operator/:id",component:ge},{path:"stock-type",component:be},{path:"stock-type/new",component:ke},{path:"stock-type/:id",component:Fe},{path:"stock",component:xe},{path:"stock/new",component:Te},{path:"stock/:id",component:Ne},{path:"stock/new-amount/:id",component:ze},{path:"stock-amount",component:We},{path:"stock-amount-supply/:id",component:Ve},{path:"stock-amount-detail/:id",component:Ge},{path:"product-type",component:Ye},{path:"product-type/new",component:Ze},{path:"product-type/:id",component:tt},{path:"product",component:rt},{path:"product/new",component:st},{path:"product/:id",component:ut},{path:"product/new-amount/:id",component:pt},{path:"product-amount",component:gt},{path:"product-amount-supply/:id",component:bt},{path:"product-amount-detail/:id",component:kt},{path:"customer",component:Ft},{path:"customer/new",component:xt},{path:"customer/:id",component:Tt},{path:"employee",component:Nt},{path:"employee/new",component:zt},{path:"employee/:id",component:Wt},{path:"project-type",component:Vt},{path:"project-type/new",component:Gt},{path:"project-type/:id",component:Yt},{path:"project",component:Zt},{path:"project/new",component:no},{path:"project/:id",component:io},{path:"member-card",component:co},{path:"member-card/new",component:po},{path:"member-card/:id",component:go},{path:"customer-card",component:bo},{path:"customer-card-charge/:id",component:ko},{path:"customer-card-buy/:id",component:Fo},{path:"customer-card-return/:id",component:xo},{path:"customer-card-turn/:id",component:To},{path:"customer-card-change-store/:id",component:No},{path:"customer-activity",component:Wo},{path:"activity",component:Vo},{path:"activity/new",component:Ho},{path:"activity/:id",component:Qo},{path:"customer-card-change-record",component:zo},{path:"appointment",component:on},{path:"appointment/new",component:cn},{path:"appointment-detail/:id",component:dn},{path:"appointment-finish/:id",component:vn},{path:"consume-record-card",component:Cn},{path:"consume-record-card/new-card",component:Fn},{path:"consume-record-product",component:xn},{path:"consume-record-product/new-product",component:In},{path:"consume-record-project",component:Rn},{path:"consume-record-project/new-project",component:Wn},{path:"consume-record-activity",component:Vn},{path:"consume-record-activity/new-activity",component:Gn},{path:"modpwd",component:ur}],meta:{requiresSignin:!0}},{path:"/signin",name:"Signin",component:C},{path:"/resetpwd",name:"ResetPWD",component:I},{path:"/schedule",name:"Schedule",component:Yn,meta:{requiresSignin:!0}},{path:"/print-card-record",component:Zn},{path:"/print-product-record",component:tr},{path:"/print-project-record",component:rr},{path:"/print-activity-record",component:sr}]}),dr={state:{account:"",name:"",token:"",status:status},getters:{},actions:{signin:function(e,t){var o=e.commit;console.log(t),o("signin",{account:"893074711@qq.com",name:"章琦",token:"12345678",status:!0}),t.$router.push({path:"/home"})},delete:function(e,t){e.commit,e.state;console.log(t),f()({method:"delete",url:"/user/delete/"+t.id})}},mutations:{signin:function(e,t){e.account=t.account,e.name=t.name,e.token=t.token,e.status=t.status}}},pr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,users:[]},getters:{getUserById:function(e){return function(t){return e.users.find(function(e){return e.id===Y()(t)})}}},actions:{loadUser:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/users",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize,role:t.role}).then(function(t){o("loadUser",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,users:t.data.data}),e(t)}).catch(function(e){n(e)})})},addUser:function(e,t){e.commit;return new d.a(function(e,o){v.post("/users",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modUser:function(e,t){e.commit;return new d.a(function(e,o){v.put("/users/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},modPWD:function(e,t){e.commit;return new d.a(function(e,o){v.patch("/users/changePassword",t).then(function(t){e(t)}).catch(function(e){o(e)})})},delUser:function(e,t){e.commit;return new d.a(function(e,o){v.del("/users/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadUser:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.users=t.users}}},fr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,stores:[],storesAll:[]},getters:{getStoreById:function(e){return function(t){return e.stores.find(function(e){return e.id===Y()(t)})}}},actions:{loadStore:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/stores",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadStore",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,stores:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadStoreAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/stores/all").then(function(t){o("loadStoreAll",{storesAll:t.data}),e(t)}).catch(function(e){t(e)})})},addStore:function(e,t){e.commit;return new d.a(function(e,o){v.post("/stores",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modStore:function(e,t){e.commit;return new d.a(function(e,o){v.put("/stores/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delStore:function(e,t){e.commit;return new d.a(function(e,o){v.del("/stores/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadStore:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.stores=t.stores},loadStoreAll:function(e,t){e.storesAll=t.storesAll}}},hr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,stockTypes:[],stockTypesAll:[]},getters:{getStockTypeById:function(e){return function(t){return e.stockTypes.find(function(e){return e.id===Y()(t)})}}},actions:{loadStockType:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/stocks/types",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadStockType",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,stockTypes:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadStockTypeAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/stocks/types/all").then(function(t){o("loadStockTypeAll",{stockTypesAll:t.data}),e(t)}).catch(function(e){t(e)})})},addStockType:function(e,t){e.commit;return new d.a(function(e,o){v.post("/stocks/types",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modStockType:function(e,t){e.commit;return new d.a(function(e,o){v.put("/stocks/types/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delStockType:function(e,t){e.commit;return new d.a(function(e,o){v.del("/stocks/types/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadStockType:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.stockTypes=t.stockTypes},loadStockTypeAll:function(e,t){e.stockTypesAll=t.stockTypesAll}}},gr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,stocks:[],stocksAll:[]},getters:{getStockById:function(e){return function(t){return e.stocks.find(function(e){return e.id===Y()(t)})}},getStockAllById:function(e){return function(t){return e.stocksAll.find(function(e){return e.id===Y()(t)})}},getStockByName:function(e){return function(t){return e.stocksAll.filter(function(e){return e.name.toLowerCase().indexOf(t.toLowerCase())>-1})}}},actions:{loadStock:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/stocks",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadStock",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,stocks:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadStockAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/stocks/all").then(function(t){o("loadStockAll",{stocksAll:t.data}),e(t)}).catch(function(e){t(e)})})},addStock:function(e,t){e.commit;return new d.a(function(e,o){v.post("/stocks",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modStock:function(e,t){e.commit;return new d.a(function(e,o){v.put("/stocks/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delStock:function(e,t){e.commit;return new d.a(function(e,o){v.del("/stocks/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})},addStockAmount:function(e,t){e.commit;return new d.a(function(e,o){v.post("/stocks/amount",t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadStock:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.stocks=t.stocks},loadStockAll:function(e,t){e.stocksAll=t.stocksAll}}},vr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,stockAmounts:[]},getters:{getStockAmountById:function(e){return function(t){return e.stockAmounts.find(function(e){return e.id===Y()(t)})}},getStockAmountBySAId:function(e){return function(t){return e.stockAmounts.find(function(e){return e.stockAmountId===Y()(t)})}}},actions:{loadStockAmount:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/stocks/amount",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadStock",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,stockAmounts:t.data.data}),e(t)}).catch(function(e){n(e)})})},supplyStockAmount:function(e,t){e.commit;return new d.a(function(e,o){v.patch("/stocks/amount/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},modStockAmount:function(e,t){e.commit;return new d.a(function(e,o){v.put("/stocks/amount/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadStock:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.stockAmounts=t.stockAmounts}}},yr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,productTypes:[],productTypesAll:[]},getters:{getProductTypeById:function(e){return function(t){return e.productTypes.find(function(e){return e.id===Y()(t)})}}},actions:{loadProductType:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/products/types",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadProductType",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,productTypes:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadProductTypeAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/products/types/all").then(function(t){o("loadProductTypeAll",{productTypesAll:t.data}),e(t)}).catch(function(e){t(e)})})},addProductType:function(e,t){e.commit;return new d.a(function(e,o){v.post("/products/types",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modProductType:function(e,t){e.commit;return new d.a(function(e,o){v.put("/products/types/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delProductType:function(e,t){e.commit;return new d.a(function(e,o){v.del("/products/types/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadProductType:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.productTypes=t.productTypes},loadProductTypeAll:function(e,t){e.productTypesAll=t.productTypesAll}}},br={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,products:[],productsAll:[],productsStoreAll:[]},getters:{getProductById:function(e){return function(t){return e.products.find(function(e){return e.id===Y()(t)})}},getProductFromAllById:function(e){return function(t){return e.productsAll.find(function(e){return e.id===Y()(t)})}},getProductFromStoreAllById:function(e){return function(t){return e.productsStoreAll.find(function(e){return e.id===Y()(t)})}}},actions:{loadProduct:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/products",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadProduct",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,products:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadProductAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/products/all").then(function(t){o("loadProductAll",{productsAll:t.data}),e(t)}).catch(function(e){t(e)})})},loadProductStoreAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/products/store/all").then(function(t){o("loadProductStoreAll",{productsStoreAll:t.data}),e(t)}).catch(function(e){t(e)})})},addProduct:function(e,t){e.commit;return new d.a(function(e,o){v.post("/products",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modProduct:function(e,t){e.commit;return new d.a(function(e,o){v.put("/products/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delProduct:function(e,t){e.commit;return new d.a(function(e,o){v.del("/products/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})},addProductAmount:function(e,t){e.commit;return new d.a(function(e,o){v.post("/products/amount",t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadProduct:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.products=t.products},loadProductAll:function(e,t){e.productsAll=t.productsAll},loadProductStoreAll:function(e,t){e.productsStoreAll=t.productsStoreAll}}},Cr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,productAmounts:[]},getters:{getProductAmountById:function(e){return function(t){return e.productAmounts.find(function(e){return e.id===Y()(t)})}},getProductAmountByPAId:function(e){return function(t){return e.productAmounts.find(function(e){return e.productAmountId===Y()(t)})}}},actions:{loadProductAmount:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/products/amount",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadProductAmount",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,productAmounts:t.data.data}),e(t)}).catch(function(e){n(e)})})},supplyProductAmount:function(e,t){e.commit;return new d.a(function(e,o){v.patch("/products/amount/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},modProductAmount:function(e,t){e.commit;return new d.a(function(e,o){v.put("/products/amount/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadProductAmount:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.productAmounts=t.productAmounts}}},_r={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,customers:[]},getters:{getCustomerById:function(e){return function(t){return e.customers.find(function(e){return e.id===Y()(t)})}}},actions:{loadCustomer:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/customer/list",{keyWords:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadCustomer",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,customers:t.data.data}),e(t)}).catch(function(e){n(e)})})},addCustomer:function(e,t){e.commit;return new d.a(function(e,o){v.put("/customer/create",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modCustomer:function(e,t){e.commit;return new d.a(function(e,o){v.put("/customer/modify",t).then(function(t){e(t)}).catch(function(e){o(e)})})},delCustomer:function(e,t){e.commit;return new d.a(function(e,o){v.del("/customer/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadCustomer:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.customers=t.customers}}},kr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,employees:[],employeesByTopType:[],consultants:[],salesMans:[],employeesAll:[]},getters:{getEmployeeById:function(e){return function(t){return e.employees.find(function(e){return e.id===Y()(t)})}},getEmployeeFromAllById:function(e){return function(t){return e.employeesAll.find(function(e){return e.id===Y()(t)})}}},actions:{loadEmployee:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/employees/search",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadEmployee",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,employees:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadEmployeeByTopType:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/employees/topType",{topType:t}).then(function(n){o("loadEmployeeByTopType",{topType:t,employeesByTopType:n.data}),e(n)}).catch(function(e){n(e)})})},loadEmployeeByWorkType:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/employees/workType",{workType:t}).then(function(n){o("loadEmployeeByWorkType",{workType:t,employeeByWorkType:n.data}),e(n)}).catch(function(e){n(e)})})},loadEmployeeAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/employees/workType").then(function(t){o("loadEmployeeAll",{employeesAll:t.data}),e(t)}).catch(function(e){t(e)})})},addEmployee:function(e,t){e.commit;return new d.a(function(e,o){v.post("/employees",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modEmployee:function(e,t){e.commit;return new d.a(function(e,o){v.put("/employees/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delEmployee:function(e,t){e.commit;return new d.a(function(e,o){v.del("/employees/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadEmployee:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.employees=t.employees},loadEmployeeByTopType:function(e,t){4===t.topType&&(e.salesMans=t.employeesByTopType),e.employeesByTopType=t.employeesByTopType},loadEmployeeByWorkType:function(e,t){3===t.workType&&(e.consultants=t.employeeByWorkType),e.employeesByWorkType=t.employeesByWrokType},loadEmployeeAll:function(e,t){e.employeesAll=t.employeesAll}}},wr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,projectTypes:[],projectTypesAll:[]},getters:{getProjectTypeById:function(e){return function(t){return e.projectTypes.find(function(e){return e.id===Y()(t)})}}},actions:{loadProjectType:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/projects/types",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadProjectType",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,projectTypes:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadProjectTypeAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/projects/types/all").then(function(t){o("loadProjectTypeAll",{projectTypesAll:t.data}),e(t)}).catch(function(e){t(e)})})},addProjectType:function(e,t){e.commit;return new d.a(function(e,o){v.post("/projects/types",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modProjectType:function(e,t){e.commit;return new d.a(function(e,o){v.put("/projects/types/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delProjectType:function(e,t){e.commit;return new d.a(function(e,o){v.del("/projects/types/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadProjectType:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.projectTypes=t.projectTypes},loadProjectTypeAll:function(e,t){e.projectTypesAll=t.projectTypesAll}}},Pr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,projects:[],projectsAll:[]},getters:{getProjectById:function(e){return function(t){return e.projects.find(function(e){return e.id===Y()(t)})}},getProjectFromAllById:function(e){return function(t){return e.projectsAll.find(function(e){return e.id===Y()(t)})}}},actions:{loadProject:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/projects",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadProject",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,projects:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadProjectAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/projects/all").then(function(t){o("loadProjectAll",{projectsAll:t.data}),e(t)}).catch(function(e){t(e)})})},addProject:function(e,t){e.commit;return new d.a(function(e,o){v.post("/projects",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modProject:function(e,t){e.commit;return new d.a(function(e,o){v.put("/projects/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delProject:function(e,t){e.commit;return new d.a(function(e,o){v.del("/projects/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadProject:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.projects=t.projects},loadProjectAll:function(e,t){e.projectsAll=t.projectsAll}}},Fr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,memberCards:[],memberCardsAll:[]},getters:{getMemberCardById:function(e){return function(t){return e.memberCards.find(function(e){return e.id===Y()(t)})}},getMemberCardFromAllById:function(e){return function(t){return e.memberCardsAll.find(function(e){return e.id===Y()(t)})}}},actions:{loadMemberCard:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/member/cards",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadMemberCard",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,memberCards:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadMemberCardAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/member/cards/all").then(function(t){o("loadMemberCardAll",{memberCardsAll:t.data}),e(t)}).catch(function(e){t(e)})})},addMemberCard:function(e,t){e.commit;return new d.a(function(e,o){v.post("/member/cards",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modMemberCard:function(e,t){e.commit;return new d.a(function(e,o){v.put("/member/cards/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})},delMemberCard:function(e,t){e.commit;return new d.a(function(e,o){v.del("/member/cards/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadMemberCard:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.memberCards=t.memberCards},loadMemberCardAll:function(e,t){e.memberCardsAll=t.memberCardsAll}}},Sr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,customerCards:[],customerCardsAll:[],customerCardPay:[],customerCardChanges:[]},getters:{getCustomerCardById:function(e){return function(t){return e.customerCards.find(function(e){return e.id===Y()(t)})}},getCustomerCardFromAllById:function(e){return function(t){return e.customerCardsAll.find(function(e){return e.id===Y()(t)})}},getCustomerCardPayById:function(e){return function(t){return e.customerCardPay.find(function(e){return e.id===Y()(t)})}}},actions:{loadCustomerCard:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/customerMemberCard/list",{keyWords:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadCustomerCard",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,customerCards:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadCustomerCardAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/customerMemberCard/all").then(function(t){o("loadCustomerCardAll",{customerCardsAll:t.data}),e(t)}).catch(function(e){t(e)})})},loadCustomerCardPay:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/customerMemberCard/getCardPay",{customerMobile:t.customerMobile,paymentWay:t.paymentWay}).then(function(t){o("loadCustomerCardPay",{customerCardPay:t.data}),e(t)}).catch(function(e){n(e)})})},loadCustomerCardChangeList:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/customerMemberCard/changedList",{keyWords:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadCustomerCardChangeList",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,customerCardChanges:t.data.data}),e(t)}).catch(function(e){n(e)})})},chargeCustomerCard:function(e,t){e.commit;return new d.a(function(e,o){v.put("/customerMemberCard/recharge",t).then(function(t){e(t)}).catch(function(e){o(e)})})},buyCustomerCard:function(e,t){e.commit;return new d.a(function(e,o){v.put("/customerMemberCard/buyProject",t).then(function(t){e(t)}).catch(function(e){o(e)})})},returnCustomerCard:function(e,t){e.commit;return new d.a(function(e,o){v.put("/customerMemberCard/return",t).then(function(t){e(t)}).catch(function(e){o(e)})})},turnCustomerCard:function(e,t){e.commit;return new d.a(function(e,o){v.put("/customerMemberCard/turn",t).then(function(t){e(t)}).catch(function(e){o(e)})})},changeStoreCustomerCard:function(e,t){e.commit;return new d.a(function(e,o){v.put("/customerMemberCard/changeStore",t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadCustomerCard:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.customerCards=t.customerCards},loadCustomerCardAll:function(e,t){e.customerCardsAll=t.customerCardsAll},loadCustomerCardPay:function(e,t){e.customerCardPay=t.customerCardPay},loadCustomerCardChangeList:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.customerCardChanges=t.customerCardChanges}}},$r={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,appointments:[],appointmentsOperator:[]},getters:{getAppointmentById:function(e){return function(t){return e.appointments.find(function(e){return e.id===Y()(t)})}}},actions:{loadAppointment:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/appointment/list",{appointmentKeyWords:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadAppointment",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,appointments:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadAppointmentOperator:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/appointment/operatorTimeTableList",{operatorId:t.operatorId}).then(function(t){o("loadAppointmentOperator",{appointmentsOperator:t.data}),e(t)}).catch(function(e){n(e)})})},addAppointment:function(e,t){e.commit;return new d.a(function(e,o){v.put("/appointment/create",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modAppointment:function(e,t){e.commit;return new d.a(function(e,o){v.put("/appointment/modify",t).then(function(t){e(t)}).catch(function(e){o(e)})})},finishAppointment:function(e,t){e.commit;return new d.a(function(e,o){v.put("/appointment/finish/"+t,t).then(function(t){e(t)}).catch(function(e){o(e)})})},cancelAppointment:function(e,t){e.commit;return new d.a(function(e,o){v.put("/appointment/cancel/"+t.appointmentId,t).then(function(t){e(t)}).catch(function(e){o(e)})})},getEmployeeTimeTable:function(e,t){e.commit;return new d.a(function(e,o){v.post("/appointment/queryEmployeeTimeTable",t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadAppointment:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.appointments=t.appointments},loadAppointmentOperator:function(e,t){e.appointmentsOperator=t.appointmentsOperator}}},xr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,activities:[],activitiesAll:[]},getters:{getActivityById:function(e){return function(t){return e.activities.find(function(e){return e.id===Y()(t)})}},getActivityFromAllById:function(e){return function(t){return e.activitiesAll.find(function(e){return e.id===Y()(t)})}}},actions:{loadActivity:function(e,t){var o=e.commit;return new d.a(function(e,n){v.get("/activities",{search:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadActivity",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,activities:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadActivityAll:function(e,t){var o=e.commit;return new d.a(function(e,t){v.get("/activities/all").then(function(t){o("loadActivityAll",{activitiesAll:t.data}),e(t)}).catch(function(e){t(e)})})},addActivity:function(e,t){e.commit;return new d.a(function(e,o){v.post("/activities",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modActivity:function(e,t){e.commit;return new d.a(function(e,o){v.put("/activities/"+t.id,t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadActivity:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.activities=t.activities},loadActivityAll:function(e,t){e.activitiesAll=t.activitiesAll}}},jr={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,customerActivities:[],customerActivitiesAll:[],customerActivityPay:[]},getters:{getCustomerActivityById:function(e){return function(t){return e.customerActivities.find(function(e){return e.id===Y()(t)})}},getCustomerActivityFromAllById:function(e){return function(t){return e.customerActivitiesAll.find(function(e){return e.id===Y()(t)})}},getCustomerActivityPayById:function(e){return function(t){return e.customerActivityPay.find(function(e){return e.id===Y()(t)})}}},actions:{loadCustomerActivity:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/customerActivity/list",{keyWord:"search"===t.type?t.content:t.oldContent,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadCustomerActivity",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,customerActivities:t.data.data}),e(t)}).catch(function(e){n(e)})})},loadCustomerActivityPay:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/customerActivity/getActivityPay",{customerMobile:t.customerMobile,paymentWay:t.paymentWay}).then(function(t){o("loadCustomerActivityPay",{customerActivityPay:t.data}),e(t)}).catch(function(e){n(e)})})}},mutations:{loadCustomerActivity:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.customerActivities=t.customerActivities},loadCustomerActivityPay:function(e,t){e.customerActivityPay=t.customerActivityPay}}},Ar={state:{pageNum:0,pageSize:0,totalCount:0,totalPages:0,consumeRecords:[],consumeRecordPrint:""},getters:{getConsumeRecordById:function(e){return function(t){return e.consumeRecords.find(function(e){return e.id===Y()(t)})}}},actions:{loadConsumeRecord:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/consume/list",{keyWords:"search"===t.type?t.content:t.oldContent,consumeType:t.consumeType,pageNum:t.pageNum,pageSize:t.pageSize}).then(function(t){o("loadConsumeRecord",{pageNum:t.data.pageNum,pageSize:t.data.pageSize,totalCount:t.data.totalCount,totalPages:t.data.totalPages,consumeRecords:t.data.data}),e(t)}).catch(function(e){n(e)})})},printConsumeRecord:function(e,t){var o=e.commit;return new d.a(function(e,n){v.put("/consume/print",t).then(function(t){o("printConsumeRecord",{consumeRecordPrint:t.data}),e(t)}).catch(function(e){n(e)})})},addConsumeRecord:function(e,t){e.commit;return new d.a(function(e,o){v.put("/consume/createConsume",t).then(function(t){e(t)}).catch(function(e){o(e)})})},modConsumeRecord:function(e,t){e.commit;return new d.a(function(e,o){v.put("/consume/modifyConsume",t).then(function(t){e(t)}).catch(function(e){o(e)})})},calConsumeRecord:function(e,t){e.commit;return new d.a(function(e,o){v.put("/consume/calMoney",t).then(function(t){e(t)}).catch(function(e){o(e)})})}},mutations:{loadConsumeRecord:function(e,t){e.pageNum=t.pageNum,e.pageSize=t.pageSize,e.totalCount=t.totalCount,e.totalPages=t.totalPages,e.consumeRecords=t.consumeRecords},printConsumeRecord:function(e,t){e.consumeRecordPrint=t.consumeRecordPrint}}},Tr=function(e,t){e.commit;console.log(t),f()({method:"post",url:"/user/login",data:{account:t.account,password:t.password}})},Ir=function(e,t){e.commit;console.log(t),f()({method:"post",url:"/user/login",data:{account:t.account,password:t.password}})},Mr=o("ukYY"),Nr=o.n(Mr);f.a.defaults.headers.post["Content-Type"]="application/json",f.a.defaults.baseURL="http://localhost:8080",r.default.use(a.a);var Rr=new a.a.Store({actions:n,mutations:Nr.a,modules:{account:dr,store:fr,user:pr,stockType:hr,stock:gr,stockAmount:vr,productType:yr,product:br,productAmount:Cr,customer:_r,employee:kr,projectType:wr,project:Pr,memberCard:Fr,customerCard:Sr,appointment:$r,activity:xr,customerActivity:jr,consumeRecord:Ar}}),Dr={install:function(e,t){e.myGlobalMethod=function(){},e.directive("my-directive",{bind:function(e,t,o,n){}}),e.mixin({created:function(){}}),e.prototype.setAccountSession=function(e,t,o,n){sessionStorage.setItem("role",e),sessionStorage.setItem("account",t),sessionStorage.setItem("name",o),sessionStorage.setItem("token",n)},e.prototype.getRoleSession=function(){return sessionStorage.getItem("role")},e.prototype.getAccountSession=function(){return sessionStorage.getItem("account")},e.prototype.getNameSession=function(){return sessionStorage.getItem("name")},e.prototype.getTokenSession=function(){return sessionStorage.getItem("token")},e.prototype.clearAccountSession=function(){sessionStorage.removeItem("role"),sessionStorage.removeItem("account"),sessionStorage.removeItem("name"),sessionStorage.removeItem("token")},e.prototype.toDateObject=function(e){return new Date(parseInt(e))},e.prototype.toDatetimeDay=function(e){var t=new Date(parseInt(e)),o=t.getFullYear(),n=t.getMonth()+1,r=t.getDate();t.getHours(),t.getMinutes(),t.getSeconds();return o+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)},e.prototype.toDatetimeMin=function(e){var t=new Date(parseInt(e)),o=t.getFullYear(),n=t.getMonth()+1,r=t.getDate(),a=t.getHours(),i=t.getMinutes();t.getSeconds();return o+"-"+(n<10?"0"+n:n)+"-"+(r<10?"0"+r:r)+" "+(a<10?"0"+a:a)+":"+(i<10?"0"+i:i)},e.prototype.toMin=function(e){var t=new Date(parseInt(e)),o=t.getHours(),n=t.getMinutes();t.getSeconds();return(o<10?"0"+o:o)+":"+(n<10?"0"+n:n)},e.prototype.toTimeStamp=function(e){return e.getTime()}}};r.default.use(a.a),r.default.use(s.a),r.default.use(Dr),r.default.config.productionTip=!1,mr.beforeEach(function(e,t,o){(0===e.matched.length?(alert("没有匹配到路由!"),t.name?o({name:t.name}):o("/")):o(),e.matched.some(function(e){return e.meta.requiresSignin}))?sessionStorage.getItem("token")?o():o({path:"/signin"}):("/signin"===e.path&&(sessionStorage.removeItem("account"),sessionStorage.removeItem("name"),sessionStorage.removeItem("token")),o())}),new r.default({el:"#app",router:mr,store:Rr,components:{App:c},template:"<App/>"})},Nh1K:function(e,t){},Nl4F:function(e,t){},"Oc/h":function(e,t){},P7hf:function(e,t){},PQqG:function(e,t){},Q8hY:function(e,t){},RPQI:function(e,t){},RbWr:function(e,t){},Rfqw:function(e,t){},SRnk:function(e,t){},SShA:function(e,t){},"Sj/F":function(e,t){},"U+2q":function(e,t){},VpBA:function(e,t){},WtgE:function(e,t){},X1Pg:function(e,t){},XVYw:function(e,t){},XvSI:function(e,t){},YcHe:function(e,t){},ZPcQ:function(e,t){},Zs1h:function(e,t){},aMXp:function(e,t){},aPjV:function(e,t){},bkxU:function(e,t){},bzqt:function(e,t,o){e.exports=o.p+"static/img/wechat.75f7a65.jpg"},c4cD:function(e,t){},cU5d:function(e,t){},cU89:function(e,t){},dy3f:function(e,t){},fAog:function(e,t){},"g3g/":function(e,t){},guIJ:function(e,t){},hz6S:function(e,t){},"i/TY":function(e,t){},iCq4:function(e,t){},jJUH:function(e,t){},jq9M:function(e,t){},kZIt:function(e,t){},lH8B:function(e,t){},lN1t:function(e,t,o){e.exports=o.p+"static/img/logo-blue-2.4a24919.png"},mKf9:function(e,t){},nRXp:function(e,t){},"q+ug":function(e,t){},q5m7:function(e,t){},sFlp:function(e,t){},tEi0:function(e,t){},tNjB:function(e,t){},tc4L:function(e,t){},u778:function(e,t){},ukYY:function(e,t){},usOl:function(e,t){},vKCj:function(e,t){},vsEv:function(e,t){},wGCe:function(e,t){},wfoI:function(e,t){},x3HZ:function(e,t){},yTgw:function(e,t){},ydHB:function(e,t){},yfFj:function(e,t){}},["NHnr"]);